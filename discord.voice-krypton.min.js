!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Discord=t():e.Discord=t()}(window,function(){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=187)}([function(e,t,s){const i=t.Package=s(81),{Error:n,RangeError:r}=s(5),a=t.browser="undefined"!=typeof window;t.DefaultOptions={apiRequestMethod:"sequential",shardId:0,shardCount:0,internalSharding:!1,messageCacheMaxSize:200,messageCacheLifetime:0,messageSweepInterval:0,fetchAllMembers:!1,disableEveryone:!1,sync:!1,restWsBridgeTimeout:5e3,disabledEvents:[],restTimeOffset:500,presence:{},ws:{large_threshold:250,compress:!1,properties:{$os:a?"browser":process.platform,$browser:"discord.js",$device:"discord.js"},version:6},http:{version:7,api:"https://discordapp.com/api",cdn:"https://cdn.discordapp.com",invite:"https://discord.gg"}},t.UserAgent=a?null:`DiscordBot (${i.homepage.split("#")[0]}, ${i.version}) Node.js/${process.version}`,t.WSCodes={1000:"Connection gracefully closed",4004:"Tried to identify with an invalid token",4010:"Sharding data provided was invalid",4011:"Shard would be on too many guilds if connected"};const o=["webp","png","jpg","gif"],l=Array.from({length:8},(e,t)=>2**(t+4));function h(e,{format:t="webp",size:s}={}){if(t&&!o.includes(t))throw new n("IMAGE_FORMAT",t);if(s&&!l.includes(s))throw new r("IMAGE_SIZE",s);return`${e}.${t}${s?`?size=${s}`:""}`}t.Endpoints={CDN:e=>({Emoji:(t,s="png")=>`${e}/emojis/${t}.${s}`,Asset:t=>`${e}/assets/${t}`,DefaultAvatar:t=>`${e}/embed/avatars/${t}.png`,Avatar:(t,s,i="default",n)=>"1"===t?s:("default"===i&&(i=s.startsWith("a_")?"gif":"webp"),h(`${e}/avatars/${t}/${s}`,{format:i,size:n})),Icon:(t,s,i="webp",n)=>h(`${e}/icons/${t}/${s}`,{format:i,size:n}),AppIcon:(t,s,{format:i="webp",size:n}={})=>h(`${e}/app-icons/${t}/${s}`,{size:n,format:i}),AppAsset:(t,s,{format:i="webp",size:n}={})=>h(`${e}/app-assets/${t}/${s}`,{size:n,format:i}),GDMIcon:(t,s,i="webp",n)=>h(`${e}/channel-icons/${t}/${s}`,{size:n,format:i}),Splash:(t,s,i="webp",n)=>h(`${e}/splashes/${t}/${s}`,{size:n,format:i})}),invite:(e,t)=>`${e}/${t}`,botGateway:"/gateway/bot"},t.Status={READY:0,CONNECTING:1,RECONNECTING:2,IDLE:3,NEARLY:4,DISCONNECTED:5},t.VoiceStatus={CONNECTED:0,CONNECTING:1,AUTHENTICATING:2,RECONNECTING:3,DISCONNECTED:4},t.OPCodes={DISPATCH:0,HEARTBEAT:1,IDENTIFY:2,STATUS_UPDATE:3,VOICE_STATE_UPDATE:4,VOICE_GUILD_PING:5,RESUME:6,RECONNECT:7,REQUEST_GUILD_MEMBERS:8,INVALID_SESSION:9,HELLO:10,HEARTBEAT_ACK:11},t.VoiceOPCodes={IDENTIFY:0,SELECT_PROTOCOL:1,READY:2,HEARTBEAT:3,SESSION_DESCRIPTION:4,SPEAKING:5},t.Events={RATE_LIMIT:"rateLimit",READY:"ready",RESUMED:"resumed",GUILD_CREATE:"guildCreate",GUILD_DELETE:"guildDelete",GUILD_UPDATE:"guildUpdate",GUILD_UNAVAILABLE:"guildUnavailable",GUILD_AVAILABLE:"guildAvailable",GUILD_MEMBER_ADD:"guildMemberAdd",GUILD_MEMBER_REMOVE:"guildMemberRemove",GUILD_MEMBER_UPDATE:"guildMemberUpdate",GUILD_MEMBER_AVAILABLE:"guildMemberAvailable",GUILD_MEMBER_SPEAKING:"guildMemberSpeaking",GUILD_MEMBERS_CHUNK:"guildMembersChunk",GUILD_ROLE_CREATE:"roleCreate",GUILD_ROLE_DELETE:"roleDelete",GUILD_ROLE_UPDATE:"roleUpdate",GUILD_EMOJI_CREATE:"emojiCreate",GUILD_EMOJI_DELETE:"emojiDelete",GUILD_EMOJI_UPDATE:"emojiUpdate",GUILD_BAN_ADD:"guildBanAdd",GUILD_BAN_REMOVE:"guildBanRemove",CHANNEL_CREATE:"channelCreate",CHANNEL_DELETE:"channelDelete",CHANNEL_UPDATE:"channelUpdate",CHANNEL_PINS_UPDATE:"channelPinsUpdate",MESSAGE_CREATE:"message",MESSAGE_DELETE:"messageDelete",MESSAGE_UPDATE:"messageUpdate",MESSAGE_BULK_DELETE:"messageDeleteBulk",MESSAGE_REACTION_ADD:"messageReactionAdd",MESSAGE_REACTION_REMOVE:"messageReactionRemove",MESSAGE_REACTION_REMOVE_ALL:"messageReactionRemoveAll",USER_UPDATE:"userUpdate",USER_NOTE_UPDATE:"userNoteUpdate",USER_SETTINGS_UPDATE:"clientUserSettingsUpdate",USER_GUILD_SETTINGS_UPDATE:"clientUserGuildSettingsUpdate",PRESENCE_UPDATE:"presenceUpdate",VOICE_STATE_UPDATE:"voiceStateUpdate",VOICE_BROADCAST_SUBSCRIBE:"subscribe",VOICE_BROADCAST_UNSUBSCRIBE:"unsubscribe",TYPING_START:"typingStart",TYPING_STOP:"typingStop",DISCONNECT:"disconnect",RECONNECTING:"reconnecting",ERROR:"error",WARN:"warn",DEBUG:"debug"},t.WSEvents=function(e){let t=Object.create(null);for(const e of["READY","RESUMED","GUILD_SYNC","GUILD_CREATE","GUILD_DELETE","GUILD_UPDATE","GUILD_MEMBER_ADD","GUILD_MEMBER_REMOVE","GUILD_MEMBER_UPDATE","GUILD_MEMBERS_CHUNK","GUILD_ROLE_CREATE","GUILD_ROLE_DELETE","GUILD_ROLE_UPDATE","GUILD_BAN_ADD","GUILD_BAN_REMOVE","GUILD_EMOJIS_UPDATE","CHANNEL_CREATE","CHANNEL_DELETE","CHANNEL_UPDATE","CHANNEL_PINS_UPDATE","MESSAGE_CREATE","MESSAGE_DELETE","MESSAGE_UPDATE","MESSAGE_DELETE_BULK","MESSAGE_REACTION_ADD","MESSAGE_REACTION_REMOVE","MESSAGE_REACTION_REMOVE_ALL","USER_UPDATE","USER_NOTE_UPDATE","USER_SETTINGS_UPDATE","USER_GUILD_SETTINGS_UPDATE","PRESENCE_UPDATE","VOICE_STATE_UPDATE","TYPING_START","VOICE_SERVER_UPDATE","RELATIONSHIP_ADD","RELATIONSHIP_REMOVE"])t[e]=e;return t}(),t.MessageTypes=["DEFAULT","RECIPIENT_ADD","RECIPIENT_REMOVE","CALL","CHANNEL_NAME_CHANGE","CHANNEL_ICON_CHANGE","PINS_ADD","GUILD_MEMBER_JOIN"],t.ActivityTypes=["PLAYING","STREAMING","LISTENING","WATCHING"],t.ActivityFlags={INSTANCE:1,JOIN:2,SPECTATE:4,JOIN_REQUEST:8,SYNC:16,PLAY:32},t.ExplicitContentFilterTypes=["DISABLED","NON_FRIENDS","FRIENDS_AND_NON_FRIENDS"],t.MessageNotificationTypes=["EVERYTHING","MENTIONS","NOTHING","INHERIT"],t.UserSettingsMap={convert_emoticons:"convertEmoticons",default_guilds_restricted:"defaultGuildsRestricted",detect_platform_accounts:"detectPlatformAccounts",developer_mode:"developerMode",enable_tts_command:"enableTTSCommand",theme:"theme",status:"status",show_current_game:"showCurrentGame",inline_attachment_media:"inlineAttachmentMedia",inline_embed_media:"inlineEmbedMedia",locale:"locale",message_display_compact:"messageDisplayCompact",render_reactions:"renderReactions",guild_positions:"guildPositions",restricted_guilds:"restrictedGuilds",explicit_content_filter:function(e){return t.ExplicitContentFilterTypes[e]},friend_source_flags:function(e){return{all:e.all||!1,mutualGuilds:!!e.all||e.mutual_guilds||!1,mutualFriends:!!e.all||e.mutualFriends||!1}}},t.UserGuildSettingsMap={message_notifications:function(e){return t.MessageNotificationTypes[e]},mobile_push:"mobilePush",muted:"muted",suppress_everyone:"suppressEveryone",channel_overrides:"channelOverrides"},t.UserChannelOverrideMap={message_notifications:function(e){return t.MessageNotificationTypes[e]},muted:"muted"},t.UserFlags={STAFF:1,PARTNER:2,HYPESQUAD:4},t.ChannelTypes={TEXT:0,DM:1,VOICE:2,GROUP:3,CATEGORY:4},t.ClientApplicationAssetTypes={SMALL:1,BIG:2},t.Colors={DEFAULT:0,AQUA:1752220,GREEN:3066993,BLUE:3447003,PURPLE:10181046,LUMINOUS_VIVID_PINK:15277667,GOLD:15844367,ORANGE:15105570,RED:15158332,GREY:9807270,NAVY:3426654,DARK_AQUA:1146986,DARK_GREEN:2067276,DARK_BLUE:2123412,DARK_PURPLE:7419530,DARK_VIVID_PINK:11342935,DARK_GOLD:12745742,DARK_ORANGE:11027200,DARK_RED:10038562,DARK_GREY:9936031,DARKER_GREY:8359053,LIGHT_GREY:12370112,DARK_NAVY:2899536,BLURPLE:7506394,GREYPLE:10070709,DARK_BUT_NOT_BLACK:2895667,NOT_QUITE_BLACK:2303786},t.APIErrors={UNKNOWN_ACCOUNT:10001,UNKNOWN_APPLICATION:10002,UNKNOWN_CHANNEL:10003,UNKNOWN_GUILD:10004,UNKNOWN_INTEGRATION:10005,UNKNOWN_INVITE:10006,UNKNOWN_MEMBER:10007,UNKNOWN_MESSAGE:10008,UNKNOWN_OVERWRITE:10009,UNKNOWN_PROVIDER:10010,UNKNOWN_ROLE:10011,UNKNOWN_TOKEN:10012,UNKNOWN_USER:10013,UNKNOWN_EMOJI:10014,BOT_PROHIBITED_ENDPOINT:20001,BOT_ONLY_ENDPOINT:20002,MAXIMUM_GUILDS:30001,MAXIMUM_FRIENDS:30002,MAXIMUM_PINS:30003,MAXIMUM_ROLES:30005,MAXIMUM_REACTIONS:30010,UNAUTHORIZED:40001,MISSING_ACCESS:50001,INVALID_ACCOUNT_TYPE:50002,CANNOT_EXECUTE_ON_DM:50003,EMBED_DISABLED:50004,CANNOT_EDIT_MESSAGE_BY_OTHER:50005,CANNOT_SEND_EMPTY_MESSAGE:50006,CANNOT_MESSAGE_USER:50007,CANNOT_SEND_MESSAGES_IN_VOICE_CHANNEL:50008,CHANNEL_VERIFICATION_LEVEL_TOO_HIGH:50009,OAUTH2_APPLICATION_BOT_ABSENT:50010,MAXIMUM_OAUTH2_APPLICATIONS:50011,INVALID_OAUTH_STATE:50012,MISSING_PERMISSIONS:50013,INVALID_AUTHENTICATION_TOKEN:50014,NOTE_TOO_LONG:50015,INVALID_BULK_DELETE_QUANTITY:50016,CANNOT_PIN_MESSAGE_IN_OTHER_CHANNEL:50019,CANNOT_EXECUTE_ON_SYSTEM_MESSAGE:50021,BULK_DELETE_MESSAGE_TOO_OLD:50034,INVITE_ACCEPTED_TO_GUILD_NOT_CONTAINING_BOT:50036,REACTION_BLOCKED:90001}},function(e,t){e.exports=class{constructor(e){this.packetManager=e}handle(e){return e}}},function(e,t,s){e.exports=s(186)},function(e,t,s){const i=s(6);class n extends Map{constructor(e){super(e),Object.defineProperty(this,"_array",{value:null,writable:!0,configurable:!0}),Object.defineProperty(this,"_keyArray",{value:null,writable:!0,configurable:!0})}set(e,t){return this._array=null,this._keyArray=null,super.set(e,t)}delete(e){return this._array=null,this._keyArray=null,super.delete(e)}array(){return this._array&&this._array.length===this.size||(this._array=[...this.values()]),this._array}keyArray(){return this._keyArray&&this._keyArray.length===this.size||(this._keyArray=[...this.keys()]),this._keyArray}first(e){if(void 0===e)return this.values().next().value;if(e<0)return this.last(-1*e);e=Math.min(this.size,e);const t=new Array(e),s=this.values();for(let i=0;i<e;i++)t[i]=s.next().value;return t}firstKey(e){if(void 0===e)return this.keys().next().value;if(e<0)return this.lastKey(-1*e);e=Math.min(this.size,e);const t=new Array(e),s=this.keys();for(let i=0;i<e;i++)t[i]=s.next().value;return t}last(e){const t=this.array();return void 0===e?t[t.length-1]:e<0?this.first(-1*e):e?t.slice(-e):[]}lastKey(e){const t=this.keyArray();return void 0===e?t[t.length-1]:e<0?this.firstKey(-1*e):e?t.slice(-e):[]}random(e){let t=this.array();if(void 0===e)return t[Math.floor(Math.random()*t.length)];if(0===t.length||!e)return[];const s=new Array(e);t=t.slice();for(let i=0;i<e;i++)s[i]=t.splice(Math.floor(Math.random()*t.length),1)[0];return s}randomKey(e){let t=this.keyArray();if(void 0===e)return t[Math.floor(Math.random()*t.length)];if(0===t.length||!e)return[];const s=new Array(e);t=t.slice();for(let i=0;i<e;i++)s[i]=t.splice(Math.floor(Math.random()*t.length),1)[0];return s}findAll(e,t){if("string"!=typeof e)throw new TypeError("Key must be a string.");if(void 0===t)throw new Error("Value must be specified.");const s=[];for(const i of this.values())i[e]===t&&s.push(i);return s}find(e,t){if("string"!=typeof e){if("function"!=typeof e)throw new Error("First argument must be a property string or a function.");for(const[t,s]of this)if(e(s,t,this))return s}else{if(void 0===t)throw new Error("Value must be specified.");for(const s of this.values())if(s[e]===t)return s}}findKey(e,t){if("string"!=typeof e){if("function"!=typeof e)throw new Error("First argument must be a property string or a function.");for(const[t,s]of this)if(e(s,t,this))return t}else{if(void 0===t)throw new Error("Value must be specified.");for(const[s,i]of this)if(i[e]===t)return s}}exists(e,t){return Boolean(this.find(e,t))}filter(e,t){t&&(e=e.bind(t));const s=new n;for(const[t,i]of this)e(i,t,this)&&s.set(t,i);return s}filterArray(e,t){t&&(e=e.bind(t));const s=[];for(const[t,i]of this)e(i,t,this)&&s.push(i);return s}map(e,t){t&&(e=e.bind(t));const s=new Array(this.size);let i=0;for(const[t,n]of this)s[i++]=e(n,t,this);return s}some(e,t){t&&(e=e.bind(t));for(const[t,s]of this)if(e(s,t,this))return!0;return!1}every(e,t){t&&(e=e.bind(t));for(const[t,s]of this)if(!e(s,t,this))return!1;return!0}reduce(e,t){let s;if(void 0!==t){s=t;for(const[t,i]of this)s=e(s,i,t,this)}else{let t=!0;for(const[i,n]of this)t?(s=n,t=!1):s=e(s,n,i,this)}return s}clone(){return new this.constructor(this)}concat(...e){const t=this.clone();for(const s of e)for(const[e,i]of s)t.set(e,i);return t}deleteAll(){const e=[];for(const t of this.values())t.delete&&e.push(t.delete());return e}equals(e){return!!e&&(this===e||this.size===e.size&&!this.find((t,s)=>{const i=e.get(s);return i!==t||void 0===i&&!e.has(s)}))}sort(e=((e,t)=>+(e>t)||+(e===t)-1)){return new n([...this.entries()].sort((t,s)=>e(t[1],s[1],t[0],s[0])))}toJSON(){return this.map(e=>"function"==typeof e.toJSON?e.toJSON():i.flatten(e))}}e.exports=n},function(e,t){e.exports=class{constructor(e){this.client=e}handle(e){return e}}},function(e,t,s){e.exports=s(80),e.exports.Messages=s(181)},function(e,t,s){const i=s(43),{Colors:n,DefaultOptions:r,Endpoints:a}=s(0),{Error:o,RangeError:l,TypeError:h}=s(5),c=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^/]+?|)(\.[^./]*|))(?:[/]*)$/;class u{constructor(){throw new Error(`The ${this.constructor.name} class may not be instantiated.`)}static flatten(e,...t){const i=e=>"object"==typeof e&&null!==e;if(!i(e))return e;t=Object.assign(...Object.keys(e).filter(e=>!e.startsWith("_")).map(e=>({[e]:!0})),...t);const n={};for(let[r,a]of Object.entries(t)){if(!a)continue;a=!0===a?r:a;const t=e[r],o=i(t),l=o&&"function"==typeof t.valueOf?t.valueOf():null;t instanceof s(3)?n[a]=Array.from(t.keys()):Array.isArray(t)?n[a]=t.map(e=>u.flatten(e)):l&&!i(l)?n[a]=l:o||(n[a]=t)}return n}static splitMessage(e,{maxLength:t=2e3,char:s="\n",prepend:i="",append:n=""}={}){if(e.length<=t)return e;const r=e.split(s);if(1===r.length)throw new l("SPLIT_MAX_LEN");const a=[];let o="";for(const e of r)o&&(o+s+e+n).length>t&&(a.push(o+n),o=i),o+=(o&&o!==i?s:"")+e;return a.concat(o).filter(e=>e)}static escapeMarkdown(e,t=!1,s=!1){return t?e.replace(/```/g,"`â€‹``"):s?e.replace(/\\(`|\\)/g,"$1").replace(/(`|\\)/g,"\\$1"):e.replace(/\\(\*|_|`|~|\\)/g,"$1").replace(/(\*|_|`|~|\\)/g,"\\$1")}static fetchRecommendedShards(e,t=1e3){return new Promise((s,n)=>{if(!e)throw new o("TOKEN_MISSING");i.get(`${r.http.api}/v${r.http.version}${a.botGateway}`).set("Authorization",`Bot ${e.replace(/^Bot\s*/i,"")}`).end((e,i)=>{e&&n(e),s(i.body.shards*(1e3/t))})})}static parseEmoji(e){if(e.includes("%")&&(e=decodeURIComponent(e)),!e.includes(":"))return{animated:!1,name:e,id:null};const t=e.match(/<?(a)?:?(\w{2,32}):(\d{17,19})>?/);return t?{animated:Boolean(t[1]),name:t[2],id:t[3]}:null}static arraysEqual(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(const s of e){const e=t.indexOf(s);-1!==e&&t.splice(e,1)}return 0===t.length}static cloneObject(e){return Object.assign(Object.create(e),e)}static mergeDefault(e,t){if(!t)return e;for(const s in e)c(t,s)&&void 0!==t[s]?t[s]===Object(t[s])&&(t[s]=u.mergeDefault(e[s],t[s])):t[s]=e[s];return t}static convertToBuffer(e){return"string"==typeof e&&(e=u.str2ab(e)),Buffer.from(e)}static str2ab(e){const t=new ArrayBuffer(2*e.length),s=new Uint16Array(t);for(var i=0,n=e.length;i<n;i++)s[i]=e.charCodeAt(i);return t}static makeError(e){const t=new Error(e.message);return t.name=e.name,t.stack=e.stack,t}static makePlainError(e){return{name:e.name,message:e.message,stack:e.stack}}static moveElementInArray(e,t,s,i=!1){const n=e.indexOf(t);if((s=(i?n:0)+s)>-1&&s<e.length){const t=e.splice(n,1)[0];e.splice(s,0,t)}return e.indexOf(t)}static resolveString(e){return"string"==typeof e?e:e instanceof Array?e.join("\n"):String(e)}static resolveColor(e){if("string"==typeof e){if("RANDOM"===e)return Math.floor(16777216*Math.random());if("DEFAULT"===e)return 0;e=n[e]||parseInt(e.replace("#",""),16)}else e instanceof Array&&(e=(e[0]<<16)+(e[1]<<8)+e[2]);if(e<0||e>16777215)throw new l("COLOR_RANGE");if(e&&isNaN(e))throw new h("COLOR_CONVERT");return e}static discordSort(e){return e.sort((e,t)=>e.rawPosition-t.rawPosition||parseInt(t.id.slice(0,-10))-parseInt(e.id.slice(0,-10))||parseInt(t.id.slice(10))-parseInt(e.id.slice(10)))}static setPosition(e,t,s,i,n,r){let a=i.array();return u.moveElementInArray(a,e,t,s),a=a.map((e,t)=>({id:e.id,position:t})),n.patch({data:a,reason:r}).then(()=>a)}static basename(e,t){let s=d.exec(e)[3];return t&&s.endsWith(t)&&(s=s.slice(0,-t.length)),s}static idToBinary(e){let t="",s=parseInt(e.slice(0,-10))||0,i=parseInt(e.slice(-10));for(;i>0||s>0;)t=String(1&i)+t,i=Math.floor(i/2),s>0&&(i+=s%2*5e9,s=Math.floor(s/2));return t}static binaryToID(e){let t="";for(;e.length>50;){const s=parseInt(e.slice(0,-32),2),i=parseInt((s%10).toString(2)+e.slice(-32),2);t=(i%10).toString()+t,e=Math.floor(s/10).toString(2)+Math.floor(i/10).toString(2).padStart(32,"0")}for(e=parseInt(e,2);e>0;)t=(e%10).toString()+t,e=Math.floor(e/10);return t}static delayFor(e){return new Promise(t=>{setTimeout(t,e)})}}e.exports=u},function(e,t,s){const i=s(3);let n;e.exports=class extends i{constructor(e,t,i){if(super(),n||(n=s(29)),Object.defineProperty(this,"client",{value:e}),Object.defineProperty(this,"holds",{value:n.get(i.name)||i}),t)for(const e of t)this.add(e)}add(e,t=!0,{id:s,extras:i=[]}={}){const n=this.get(s||e.id);if(n)return n;const r=this.holds?new this.holds(this.client,e,...i):e;return t&&this.set(s||r.id,r),r}remove(e){return this.delete(e)}resolve(e){return e instanceof this.holds?e:"string"==typeof e&&this.get(e)||null}resolveID(e){return e instanceof this.holds?e.id:"string"==typeof e?e:null}}},function(e,t,s){const i=s(73),n=s(73),r=s(43),a=s(6),{Error:o,TypeError:l}=s(5),{browser:h}=s(0);class c{constructor(){throw new Error(`The ${this.constructor.name} class may not be instantiated.`)}static resolveInviteCode(e){const t=/discord(?:app\.com\/invite|\.gg)\/([\w-]{2,255})/i.exec(e);return t&&t[1]?t[1]:e}static async resolveImage(e){if(!e)return null;if("string"==typeof e&&e.startsWith("data:"))return e;const t=await this.resolveFile(e);return c.resolveBase64(t)}static resolveBase64(e){return e instanceof Buffer?`data:image/jpg;base64,${e.toString("base64")}`:e}static resolveFile(e){return e instanceof Buffer?Promise.resolve(e):h&&e instanceof ArrayBuffer?Promise.resolve(a.convertToBuffer(e)):"string"==typeof e?/^https?:\/\//.test(e)?r.get(e).then(e=>e.body instanceof Buffer?e.body:Buffer.from(e.text)):new Promise((t,s)=>{const r=h?e:i.resolve(e);n.stat(r,(e,i)=>e?s(e):i&&i.isFile()?(n.readFile(r,(e,i)=>{e?s(e):t(i)}),null):s(new o("FILE_NOT_FOUND",r)))}):e.pipe&&"function"==typeof e.pipe?new Promise((t,s)=>{const i=[];e.once("error",s),e.on("data",e=>i.push(e)),e.once("end",()=>t(Buffer.concat(i)))}):Promise.reject(new l("REQ_RESOURCE_TYPE"))}}e.exports=c},function(e,t,s){const i=s(6);e.exports=class{constructor(e){Object.defineProperty(this,"client",{value:e})}_clone(){return Object.assign(Object.create(this),this)}_patch(e){return e}_update(e){const t=this._clone();return this._patch(e),t}toJSON(...e){return i.flatten(this,...e)}valueOf(){return this.id}}},function(e,t,s){const i=s(6),n=14200704e5;let r=0;e.exports=class{constructor(){throw new Error(`The ${this.constructor.name} class may not be instantiated.`)}static generate(){r>=4095&&(r=0);const e=`${(Date.now()-n).toString(2).padStart(42,"0")}0000100000${(r++).toString(2).padStart(12,"0")}`;return i.binaryToID(e)}static deconstruct(e){const t=i.idToBinary(e).toString(2).padStart(64,"0"),s={timestamp:parseInt(t.substring(0,42),2)+n,workerID:parseInt(t.substring(42,47),2),processID:parseInt(t.substring(47,52),2),increment:parseInt(t.substring(52,64),2),binary:t};return Object.defineProperty(s,"date",{get:function(){return new Date(this.timestamp)},enumerable:!0}),s}}},function(e,t,s){const{RangeError:i}=s(5);class n{constructor(e){this.bitfield=this.constructor.resolve(e)}has(e,t=!0){return e instanceof Array?e.every(e=>this.has(e,t)):(e=this.constructor.resolve(e),!!(t&&(this.bitfield&this.constructor.FLAGS.ADMINISTRATOR)>0)||(this.bitfield&e)===e)}missing(e,t=!0){return e instanceof Array||(e=new this.constructor(e).toArray(!1)),e.filter(e=>!this.has(e,t))}freeze(){return Object.freeze(this)}add(...e){let t=0;for(let s=e.length-1;s>=0;s--)t|=this.constructor.resolve(e[s]);return Object.isFrozen(this)?new this.constructor(this.bitfield|t):(this.bitfield|=t,this)}remove(...e){let t=0;for(let s=e.length-1;s>=0;s--)t|=this.constructor.resolve(e[s]);return Object.isFrozen(this)?new this.constructor(this.bitfield&~t):(this.bitfield&=~t,this)}serialize(e=!0){const t={};for(const s in this.constructor.FLAGS)t[s]=this.has(s,e);return t}toArray(e=!0){return Object.keys(this.constructor.FLAGS).filter(t=>this.has(t,e))}toJSON(){return this.bitfield}valueOf(){return this.bitfield}*[Symbol.iterator](){const e=this.toArray();for(;e.length;)yield e.shift()}static resolve(e){if("number"==typeof e&&e>=0)return e;if(e instanceof n)return e.bitfield;if(e instanceof Array)return e.map(e=>this.resolve(e)).reduce((e,t)=>e|t,0);if("string"==typeof e)return this.FLAGS[e];throw new i("PERMISSIONS_INVALID")}}n.FLAGS={CREATE_INSTANT_INVITE:1,KICK_MEMBERS:2,BAN_MEMBERS:4,ADMINISTRATOR:8,MANAGE_CHANNELS:16,MANAGE_GUILD:32,ADD_REACTIONS:64,VIEW_AUDIT_LOG:128,VIEW_CHANNEL:1024,SEND_MESSAGES:2048,SEND_TTS_MESSAGES:4096,MANAGE_MESSAGES:8192,EMBED_LINKS:16384,ATTACH_FILES:32768,READ_MESSAGE_HISTORY:65536,MENTION_EVERYONE:1<<17,USE_EXTERNAL_EMOJIS:1<<18,CONNECT:1<<20,SPEAK:1<<21,MUTE_MEMBERS:1<<22,DEAFEN_MEMBERS:1<<23,MOVE_MEMBERS:1<<24,USE_VAD:1<<25,CHANGE_NICKNAME:1<<26,MANAGE_NICKNAMES:1<<27,MANAGE_ROLES:1<<28,MANAGE_WEBHOOKS:1<<29,MANAGE_EMOJIS:1<<30},n.ALL=Object.values(n.FLAGS).reduce((e,t)=>e|t,0),n.DEFAULT=104324097,e.exports=n},function(e,t,s){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var s=t.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(var i in s)n(s,i)&&(e[i]=s[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,s,i,n){if(t.subarray&&e.subarray)e.set(t.subarray(s,s+i),n);else for(var r=0;r<i;r++)e[n+r]=t[s+r]},flattenChunks:function(e){var t,s,i,n,r,a;for(i=0,t=0,s=e.length;t<s;t++)i+=e[t].length;for(a=new Uint8Array(i),n=0,t=0,s=e.length;t<s;t++)r=e[t],a.set(r,n),n+=r.length;return a}},a={arraySet:function(e,t,s,i,n){for(var r=0;r<i;r++)e[n+r]=t[s+r]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(i)},function(e,t,s){const i=s(6),{ActivityTypes:n,ActivityFlags:r}=s(0);class a{constructor(e,t){Object.defineProperty(this,"presence",{value:e}),this.name=t.name,this.type=n[t.type],this.url=t.url||null,this.details=t.details||null,this.state=t.state||null,this.applicationID=t.application_id||null,this.timestamps=t.timestamps?{start:t.timestamps.start?new Date(Number(t.timestamps.start)):null,end:t.timestamps.end?new Date(Number(t.timestamps.end)):null}:null,this.party=t.party||null,this.assets=t.assets?new o(this,t.assets):null,this.syncID=t.sync_id,this._flags=t.flags}get flags(){const e=[];for(const[t,s]of Object.entries(r))(this._flags&s)===s&&e.push(t);return e}equals(e){return this===e||e&&this.name===e.name&&this.type===e.type&&this.url===e.url}toString(){return this.name}_clone(){return Object.assign(Object.create(this),this)}}class o{constructor(e,t){Object.defineProperty(this,"activity",{value:e}),this.largeText=t.large_text||null,this.smallText=t.small_text||null,this.largeImage=t.large_image||null,this.smallImage=t.small_image||null}smallImageURL({format:e,size:t}={}){return this.smallImage?this.activity.presence.client.rest.cdn.AppAsset(this.activity.applicationID,this.smallImage,{format:e,size:t}):null}largeImageURL({format:e,size:t}={}){return this.largeImage?/^spotify:/.test(this.largeImage)?`https://i.scdn.co/image/${this.largeImage.slice(8)}`:this.activity.presence.client.rest.cdn.AppAsset(this.activity.applicationID,this.largeImage,{format:e,size:t}):null}}t.Presence=class{constructor(e,t={}){Object.defineProperty(this,"client",{value:e}),this.patch(t)}patch(e){this.status=e.status||this.status||"offline";const t=e.game||e.activity;return this.activity=t?new a(this,t):null,this}_clone(){const e=Object.assign(Object.create(this),this);return this.activity&&(e.activity=this.activity._clone()),e}equals(e){return this===e||(e&&this.status===e.status&&this.activity?this.activity.equals(e.activity):!e.activity)}toJSON(){return i.flatten(this)}},t.Activity=a,t.RichPresenceAssets=o},function(e,t,s){const i=s(22),n=s(19),r=s(11),a=s(71),o=s(9),{Presence:l}=s(13),{Error:h}=s(5);class c extends o{constructor(e,t,s){super(e),this.guild=s,this.user={},this.roles=new a(this),t&&this._patch(t),this.lastMessageID=null,this.lastMessageChannelID=null}_patch(e){void 0===this.speaking&&(this.speaking=!1),void 0!==e.nick&&(this.nickname=e.nick),e.joined_at&&(this.joinedTimestamp=new Date(e.joined_at).getTime()),this.user=this.guild.client.users.add(e.user),e.roles&&this.roles._patch(e.roles)}_clone(){const e=super._clone();return e.roles=this.roles.clone(),e}get lastMessage(){const e=this.guild.channels.get(this.lastMessageChannelID);return e&&e.messages.get(this.lastMessageID)||null}get voiceState(){return this._frozenVoiceState||this.guild.voiceStates.get(this.id)||{}}get serverDeaf(){return this.voiceState.deaf}get serverMute(){return this.voiceState.mute}get selfMute(){return this.voiceState.self_mute}get selfDeaf(){return this.voiceState.self_deaf}get voiceSessionID(){return this.voiceState.session_id}get voiceChannelID(){return this.voiceState.channel_id}get joinedAt(){return new Date(this.joinedTimestamp)}get presence(){return this.frozenPresence||this.guild.presences.get(this.id)||new l(this.client)}get displayColor(){const e=this.roles.color;return e&&e.color||0}get displayHexColor(){const e=this.roles.color;return e&&e.hexColor||"#000000"}get mute(){return this.selfMute||this.serverMute}get deaf(){return this.selfDeaf||this.serverDeaf}get voiceChannel(){return this.guild.channels.get(this.voiceChannelID)||null}get id(){return this.user.id}get displayName(){return this.nickname||this.user.username}get permissions(){return this.user.id===this.guild.ownerID?new r(r.ALL).freeze():new r(this.roles.map(e=>e.permissions)).freeze()}get manageable(){return this.user.id!==this.guild.ownerID&&this.user.id!==this.client.user.id&&this.guild.me.roles.highest.comparePositionTo(this.roles.highest)>0}get kickable(){return this.manageable&&this.guild.me.permissions.has(r.FLAGS.KICK_MEMBERS)}get bannable(){return this.manageable&&this.guild.me.permissions.has(r.FLAGS.BAN_MEMBERS)}permissionsIn(e){if(!(e=this.guild.channels.resolve(e)))throw new h("GUILD_CHANNEL_RESOLVE");return e.memberPermissions(this)}hasPermission(e,{checkAdmin:t=!0,checkOwner:s=!0}={}){return!(!s||this.user.id!==this.guild.ownerID)||this.roles.some(s=>s.permissions.has(e,t))}missingPermissions(e,t=!1){return this.permissions.missing(e,t)}edit(e,t){e.channel&&(e.channel_id=this.client.channels.resolve(e.channel).id,e.channel=null),e.roles&&(e.roles=e.roles.map(e=>e instanceof n?e.id:e));let s=this.client.api.guilds(this.guild.id);if(this.user.id===this.client.user.id){const t=Object.keys(e);s=1===t.length&&"nick"===t[0]?s.members("@me").nick:s.members(this.id)}else s=s.members(this.id);return s.patch({data:e,reason:t}).then(()=>{const t=this._clone();return e.user=this.user,t._patch(e),t._frozenVoiceState={},Object.assign(t._frozenVoiceState,this.voiceState),void 0!==e.mute&&(t._frozenVoiceState.mute=e.mute),void 0!==e.deaf&&(t._frozenVoiceState.mute=e.deaf),void 0!==e.channel_id&&(t._frozenVoiceState.channel_id=e.channel_id),t})}setMute(e,t){return this.edit({mute:e},t)}setDeaf(e,t){return this.edit({deaf:e},t)}setVoiceChannel(e){return this.edit({channel:e})}setNickname(e,t){return this.edit({nick:e},t)}createDM(){return this.user.createDM()}deleteDM(){return this.user.deleteDM()}kick(e){return this.client.api.guilds(this.guild.id).members(this.user.id).delete({reason:e}).then(()=>this)}ban(e){return this.guild.members.ban(this,e)}toString(){return`<@${this.nickname?"!":""}${this.user.id}>`}toJSON(){return super.toJSON({guild:"guildID",user:"userID",displayName:!0,speaking:!1,lastMessage:!1,lastMessageID:!1})}send(){}}i.applyToClass(c),e.exports=c},function(e,t,s){const i=s(8),{createMessage:n}=s(28);class r{constructor(e,t){Object.defineProperty(this,"client",{value:e}),t&&this._patch(t)}_patch(e){this.name=e.name,this.token=e.token,this.avatar=e.avatar,this.id=e.id,this.guildID=e.guild_id,this.channelID=e.channel_id,e.user?this.owner=this.client.users?this.client.users.get(e.user.id):e.user:this.owner=null}async send(e,t){t||"object"!=typeof e||e instanceof Array?t||(t={}):(t=e,e=null),t.content||(t.content=e);const{data:s,files:i}=await n(this,t);if(s.content instanceof Array){const e=[];for(let t=0;t<s.content.length;t++){const n=t===s.content.length-1?{embeds:s.embeds,files:i}:{};Object.assign(n,{avatarURL:s.avatar_url,content:s.content[t],username:s.username});const r=await this.send(s.content[t],n);e.push(r)}return e}return this.client.api.webhooks(this.id,this.token).post({data:s,files:i,query:{wait:!0},auth:!1}).then(e=>this.client.channels?this.client.channels.get(e.channel_id).messages.add(e,!1):e)}sendSlackMessage(e){return this.client.api.webhooks(this.id,this.token).slack.post({query:{wait:!0},auth:!1,data:e}).then(e=>this.client.channels?this.client.channels.get(e.channel_id).messages.add(e,!1):e)}edit({name:e=this.name,avatar:t,channel:s},n){return t&&"string"==typeof t&&!t.startsWith("data:")?i.resolveImage(t).then(t=>this.edit({name:e,avatar:t},n)):(s&&(s=this.client.channels.resolveID(s)),this.client.api.webhooks(this.id,s?void 0:this.token).patch({data:{name:e,avatar:t,channel_id:s},reason:n}).then(e=>(this.name=e.name,this.avatar=e.avatar,this.channelID=e.channel_id,this)))}delete(e){return this.client.api.webhooks(this.id,this.token).delete({reason:e})}static applyToClass(e){for(const t of["send","sendSlackMessage","edit","delete"])Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(r.prototype,t))}}e.exports=r},function(e,t,s){const i=s(10),n=s(9),{ChannelTypes:r}=s(0);e.exports=class extends n{constructor(e,t){super(e);const s=Object.keys(r)[t.type];this.type=s?s.toLowerCase():"unknown",t&&this._patch(t)}_patch(e){this.id=e.id}get createdTimestamp(){return i.deconstruct(this.id).timestamp}get createdAt(){return new Date(this.createdTimestamp)}toString(){return`<#${this.id}>`}delete(){return this.client.api.channels(this.id).delete().then(()=>this)}static create(e,t,i){const n=s(29);let a;if(t.type===r.DM)a=new(n.get("DMChannel"))(e,t);else if(t.type===r.GROUP)a=new(n.get("GroupDMChannel"))(e,t);else if(i=i||e.guilds.get(t.guild_id)){switch(t.type){case r.TEXT:a=new(n.get("TextChannel"))(i,t);break;case r.VOICE:a=new(n.get("VoiceChannel"))(i,t);break;case r.CATEGORY:a=new(n.get("CategoryChannel"))(i,t);break;default:a=new(n.get("GuildChannel"))(i,t)}i.channels.set(a.id,a)}return a}toJSON(...e){return super.toJSON({createdTimestamp:!0},...e)}}},function(e,t,s){const i=s(22),{Presence:n}=s(13),r=s(163),a=s(10),o=s(9),{Error:l}=s(5);class h extends o{constructor(e,t){super(e),this.id=t.id,this.bot=Boolean(t.bot),this._patch(t)}_patch(e){e.username&&(this.username=e.username),e.discriminator&&(this.discriminator=e.discriminator),void 0!==e.avatar&&(this.avatar=e.avatar),this.lastMessageID=null,this.lastMessageChannelID=null}get createdTimestamp(){return a.deconstruct(this.id).timestamp}get createdAt(){return new Date(this.createdTimestamp)}get lastMessage(){const e=this.client.channels.get(this.lastMessageChannelID);return e&&e.messages.get(this.lastMessageID)||null}get presence(){if(this.client.presences.has(this.id))return this.client.presences.get(this.id);for(const e of this.client.guilds.values())if(e.presences.has(this.id))return e.presences.get(this.id);return new n(this.client)}avatarURL({format:e,size:t}={}){return this.avatar?this.client.rest.cdn.Avatar(this.id,this.avatar,e,t):null}get defaultAvatarURL(){return this.client.rest.cdn.DefaultAvatar(this.discriminator%5)}displayAvatarURL(e){return this.avatarURL(e)||this.defaultAvatarURL}get tag(){return`${this.username}#${this.discriminator}`}get note(){return this.client.user.notes.get(this.id)||null}typingIn(e){return(e=this.client.channels.resolve(e))._typing.has(this.id)}typingSinceIn(e){return(e=this.client.channels.resolve(e))._typing.has(this.id)?new Date(e._typing.get(this.id).since):null}typingDurationIn(e){return(e=this.client.channels.resolve(e))._typing.has(this.id)?e._typing.get(this.id).elapsedTime:-1}get dmChannel(){return this.client.channels.filter(e=>"dm"===e.type).find(e=>e.recipient.id===this.id)||null}createDM(){return this.dmChannel?Promise.resolve(this.dmChannel):this.client.api.users(this.client.user.id).channels.post({data:{recipient_id:this.id}}).then(e=>this.client.actions.ChannelCreate.handle(e).channel)}deleteDM(){return this.dmChannel?this.client.api.channels(this.dmChannel.id).delete().then(e=>this.client.actions.ChannelDelete.handle(e).channel):Promise.reject(new l("USER_NO_DMCHANNEL"))}fetchProfile(){return this.client.api.users(this.id).profile.get().then(e=>new r(this,e))}setNote(e){return this.client.api.users("@me").notes(this.id).put({data:{note:e}}).then(()=>this)}equals(e){return e&&this.id===e.id&&this.username===e.username&&this.discriminator===e.discriminator&&this.avatar===e.avatar}toString(){return`<@${this.id}>`}toJSON(...e){const t=super.toJSON({createdTimestamp:!0,defaultAvatarURL:!0,tag:!0,lastMessage:!1,lastMessageID:!1},...e);return t.avatarURL=this.avatarURL(),t.displayAvatarURL=this.displayAvatarURL(),t}send(){}}i.applyToClass(h),e.exports=h},function(e,t,s){const i=s(16),n=s(19),r=s(27),a=s(68),o=s(67),l=s(6),h=s(11),c=s(3),{MessageNotificationTypes:d}=s(0),{Error:u,TypeError:p}=s(5);e.exports=class extends i{constructor(e,t){super(e.client,t),this.guild=e}_patch(e){if(super._patch(e),this.name=e.name,this.rawPosition=e.position,this.parentID=e.parent_id,this.permissionOverwrites=new c,e.permission_overwrites)for(const t of e.permission_overwrites)this.permissionOverwrites.set(t.id,new o(this,t))}get parent(){return this.guild.channels.get(this.parentID)||null}get permissionsLocked(){return this.parent?this.permissionOverwrites.size===this.parent.permissionOverwrites.size&&!this.permissionOverwrites.find((e,t)=>{const s=this.parent.permissionOverwrites.get(t);return void 0===s||s.denied.bitfield!==e.denied.bitfield||s.allowed.bitfield!==e.allowed.bitfield}):null}get position(){const e=this.guild._sortedChannels(this);return e.array().indexOf(e.get(this.id))}permissionsFor(e){const t=this.guild.members.resolve(e);if(t)return this.memberPermissions(t);const s=this.guild.roles.resolve(e);return s?this.rolePermissions(s):null}overwritesFor(e,t=!1,s=null){if(t||(e=this.guild.members.resolve(e)),!e)return[];s=s||e.roles;const i=[];let n,r;for(const t of this.permissionOverwrites.values())t.id===this.guild.id?r=t:s.has(t.id)?i.push(t):t.id===e.id&&(n=t);return{everyone:r,roles:i,member:n}}memberPermissions(e){if(e.id===this.guild.ownerID)return new h(h.ALL).freeze();const t=e.roles,s=new h(t.map(e=>e.permissions));if(s.has(h.FLAGS.ADMINISTRATOR))return new h(h.ALL).freeze();const i=this.overwritesFor(e,!0,t);return s.remove(i.everyone?i.everyone.denied:0).add(i.everyone?i.everyone.allowed:0).remove(i.roles.length>0?i.roles.map(e=>e.denied):0).add(i.roles.length>0?i.roles.map(e=>e.allowed):0).remove(i.member?i.member.denied:0).add(i.member?i.member.allowed:0).freeze()}rolePermissions(e){if(e.permissions.has(h.FLAGS.ADMINISTRATOR))return new h(h.ALL).freeze();const t=this.permissionOverwrites.get(this.guild.id),s=this.permissionOverwrites.get(e.id);return e.permissions.remove(t?t.denied:0).add(t?t.allowed:0).remove(s?s.denied:0).add(s?s.allowed:0).freeze()}overwritePermissions({overwrites:e,reason:t}={}){return this.edit({permissionOverwrites:a.call(this,e),reason:t}).then(()=>this)}updateOverwrite(e,t,s){const i=new h(0),r=new h(0);let a;const o=this.guild.roles.get(e);if(o||e instanceof n)e=o||e,a="role";else if(a="member",!(e=this.client.users.resolve(e)))return Promise.reject(new p("INVALID_TYPE","parameter","User nor a Role",!0));const l=this.permissionOverwrites.get(e.id);l&&(i.add(l.allowed),r.add(l.denied));for(const e in t)!0===t[e]?(i.add(h.FLAGS[e]||0),r.remove(h.FLAGS[e]||0)):!1===t[e]?(i.remove(h.FLAGS[e]||0),r.add(h.FLAGS[e]||0)):null===t[e]&&(i.remove(h.FLAGS[e]||0),r.remove(h.FLAGS[e]||0));return this.client.api.channels(this.id).permissions[e.id].put({data:{id:e.id,type:a,allow:i.bitfield,deny:r.bitfield},reason:s}).then(()=>this)}lockPermissions(){if(!this.parent)return Promise.reject(new u("GUILD_CHANNEL_ORPHAN"));const e=this.parent.permissionOverwrites.map(e=>({deny:e.denied.bitfield,allow:e.allowed.bitfield,id:e.id,type:e.type}));return this.edit({permissionOverwrites:e})}get members(){const e=new c;for(const t of this.guild.members.values())this.permissionsFor(t).has("VIEW_CHANNEL")&&e.set(t.id,t);return e}async edit(e,t){return void 0!==e.position&&await l.setPosition(this,e.position,!1,this.guild._sortedChannels(this),this.client.api.guilds(this.guild.id).channels,t).then(e=>{this.client.actions.GuildChannelsPositionUpdate.handle({guild_id:this.guild.id,channels:e})}),this.client.api.channels(this.id).patch({data:{name:(e.name||this.name).trim(),topic:e.topic,nsfw:e.nsfw,bitrate:e.bitrate||this.bitrate,user_limit:void 0!==e.userLimit?e.userLimit:this.userLimit,parent_id:e.parentID,lock_permissions:e.lockPermissions,permission_overwrites:e.permissionOverwrites},reason:t}).then(e=>{const t=this._clone();return t._patch(e),t})}setName(e,t){return this.edit({name:e},t)}setParent(e,{lockPermissions:t=!0,reason:s}={}){return this.edit({parentID:null!==e?e.id?e.id:e:null,lockPermissions:t},s)}setTopic(e,t){return this.edit({topic:e},t)}setPosition(e,{relative:t,reason:s}={}){return l.setPosition(this,e,t,this.guild._sortedChannels(this),this.client.api.guilds(this.guild.id).channels,s).then(e=>(this.client.actions.GuildChannelsPositionUpdate.handle({guild_id:this.guild.id,channels:e}),this))}createInvite({temporary:e=!1,maxAge:t=86400,maxUses:s=0,unique:i,reason:n}={}){return this.client.api.channels(this.id).invites.post({data:{temporary:e,max_age:t,max_uses:s,unique:i},reason:n}).then(e=>new r(this.client,e))}async fetchInvites(){const e=await this.client.api.channels(this.id).invites.get(),t=new c;for(const s of e){const e=new r(this.client,s);t.set(e.code,e)}return t}clone(e={}){return void 0===e.withPermissions&&(e.withPermissions=!0),l.mergeDefault({name:this.name,overwrites:e.withPermissions?this.permissionOverwrites:[],withTopic:!0,nsfw:this.nsfw,parent:this.parent,bitrate:this.bitrate,userLimit:this.userLimit,reason:null},e),e.type=this.type,this.guild.channels.create(e.name,e).then(t=>e.withTopic?t.setTopic(this.topic):t)}equals(e){let t=e&&this.id===e.id&&this.type===e.type&&this.topic===e.topic&&this.position===e.position&&this.name===e.name;return t&&(t=this.permissionOverwrites&&e.permissionOverwrites?this.permissionOverwrites.equals(e.permissionOverwrites):!this.permissionOverwrites&&!e.permissionOverwrites),t}get deletable(){return this.permissionsFor(this.client.user).has(h.FLAGS.MANAGE_CHANNELS)}get manageable(){if(this.client.user.id===this.guild.ownerID)return!0;const e=this.permissionsFor(this.client.user);return!!e&&e.has([h.FLAGS.MANAGE_CHANNELS,h.FLAGS.VIEW_CHANNEL])}delete(e){return this.client.api.channels(this.id).delete({reason:e}).then(()=>this)}get muted(){if(this.client.user.bot)return null;try{return this.client.user.guildSettings.get(this.guild.id).channelOverrides.get(this.id).muted}catch(e){return!1}}get messageNotifications(){if(this.client.user.bot)return null;try{return this.client.user.guildSettings.get(this.guild.id).channelOverrides.get(this.id).messageNotifications}catch(e){return d[3]}}}},function(e,t,s){const i=s(10),n=s(11),r=s(6),a=s(9),{Error:o,TypeError:l}=s(5);e.exports=class extends a{constructor(e,t,s){super(e),this.guild=s,t&&this._patch(t)}_patch(e){this.id=e.id,this.name=e.name,this.color=e.color,this.hoist=e.hoist,this.rawPosition=e.position,this.permissions=new n(e.permissions).freeze(),this.managed=e.managed,this.mentionable=e.mentionable}get createdTimestamp(){return i.deconstruct(this.id).timestamp}get createdAt(){return new Date(this.createdTimestamp)}get hexColor(){return`#${this.color.toString(16).padStart(6,"0")}`}get members(){return this.guild.members.filter(e=>e.roles.has(this.id))}get editable(){if(this.managed)return!1;const e=this.guild.member(this.client.user);return!!e.permissions.has(n.FLAGS.MANAGE_ROLES)&&e.roles.highest.comparePositionTo(this)>0}get position(){const e=this.guild._sortedRoles();return e.array().indexOf(e.get(this.id))}comparePositionTo(e){return(e=this.guild.roles.resolve(e))?this.constructor.comparePositions(this,e):Promise.reject(new l("INVALID_TYPE","role","Role nor a Snowflake"))}async edit(e,t){return e.permissions?e.permissions=n.resolve(e.permissions):e.permissions=this.permissions.bitfield,void 0!==e.position&&await r.setPosition(this,e.position,!1,this.guild._sortedRoles(),this.client.api.guilds(this.guild.id).roles,t).then(e=>{this.client.actions.GuildRolesPositionUpdate.handle({guild_id:this.guild.id,roles:e})}),this.client.api.guilds[this.guild.id].roles[this.id].patch({data:{name:e.name||this.name,color:null!==e.color?r.resolveColor(e.color||this.color):null,hoist:void 0!==e.hoist?e.hoist:this.hoist,permissions:e.permissions,mentionable:void 0!==e.mentionable?e.mentionable:this.mentionable},reason:t}).then(e=>{const t=this._clone();return t._patch(e),t})}permissionsIn(e){if(!(e=this.guild.channels.resolve(e)))throw new o("GUILD_CHANNEL_RESOLVE");return e.rolePermissions(this)}setName(e,t){return this.edit({name:e},t)}setColor(e,t){return this.edit({color:e},t)}setHoist(e,t){return this.edit({hoist:e},t)}setPermissions(e,t){return this.edit({permissions:e},t)}setMentionable(e,t){return this.edit({mentionable:e},t)}setPosition(e,{relative:t,reason:s}={}){return r.setPosition(this,e,t,this.guild._sortedRoles(),this.client.api.guilds(this.guild.id).roles,s).then(e=>(this.client.actions.GuildRolesPositionUpdate.handle({guild_id:this.guild.id,roles:e}),this))}delete(e){return this.client.api.guilds[this.guild.id].roles[this.id].delete({reason:e}).then(()=>(this.client.actions.GuildRoleDelete.handle({guild_id:this.guild.id,role_id:this.id}),this))}equals(e){return e&&this.id===e.id&&this.name===e.name&&this.color===e.color&&this.hoist===e.hoist&&this.position===e.position&&this.permissions.bitfield===e.permissions.bitfield&&this.managed===e.managed}toString(){return this.id===this.guild.id?"@everyone":`<@&${this.id}>`}toJSON(){return super.toJSON({createdTimestamp:!0})}static comparePositions(e,t){return e.position===t.position?t.id-e.id:e.position-t.position}}},function(e,t,s){const i=s(7),n=s(3),r=s(24),{Error:a}=s(5);e.exports=class extends i{constructor(e,t){super(e.client,t,r),this.channel=e}add(e,t){return super.add(e,t,{extras:[this.channel]})}set(e,t){const s=this.client.options.messageCacheMaxSize;0!==s&&(this.size>=s&&s>0&&this.delete(this.firstKey()),super.set(e,t))}fetch(e){return"string"==typeof e?this._fetchId(e):this._fetchMany(e)}fetchPinned(){return this.client.api.channels[this.channel.id].pins.get().then(e=>{const t=new n;for(const s of e)t.set(s.id,this.add(s));return t})}async _fetchId(e){if(!this.client.user.bot){const t=(await this._fetchMany({limit:1,around:e})).get(e);if(!t)throw new a("MESSAGE_MISSING");return t}const t=await this.client.api.channels[this.channel.id].messages[e].get();return this.add(t)}async _fetchMany(e={}){const t=await this.client.api.channels[this.channel.id].messages.get({query:e}),s=new n;for(const e of t)s.set(e.id,this.add(e));return s}}},function(e,t,s){const i=s(27),n=s(74),r=s(15),a=s(38),{ChannelTypes:o,Events:l,browser:h}=s(0),c=s(3),d=s(6),u=s(8),p=s(10),f=s(28),m=s(72),_=s(70),g=s(37),E=s(69),b=s(35),v=s(9),{Error:w,TypeError:y}=s(5);e.exports=class extends v{constructor(e,t){super(e),this.members=new m(this),this.channels=new E(this),this.roles=new _(this),this.presences=new b(this.client),t&&(t.unavailable?(this.available=!1,this.id=t.id):(this._patch(t),t.channels||(this.available=!1)))}_patch(e){if(this.name=e.name,this.icon=e.icon,this.splash=e.splash,this.region=e.region,this.memberCount=e.member_count||this.memberCount,this.large=Boolean("large"in e?e.large:this.large),this.features=e.features,this.applicationID=e.application_id,this.afkTimeout=e.afk_timeout,this.afkChannelID=e.afk_channel_id,this.systemChannelID=e.system_channel_id,this.embedEnabled=e.embed_enabled,this.verificationLevel=e.verification_level,this.explicitContentFilter=e.explicit_content_filter,this.mfaLevel=e.mfa_level,this.joinedTimestamp=e.joined_at?new Date(e.joined_at).getTime():this.joinedTimestamp,this.id=e.id,this.available=!e.unavailable,this.features=e.features||this.features||[],e.channels){this.channels.clear();for(const t of e.channels)this.client.channels.add(t,this)}if(e.roles){this.roles.clear();for(const t of e.roles)this.roles.add(t)}if(e.members){this.members.clear();for(const t of e.members)this.members.add(t)}if(e.owner_id&&(this.ownerID=e.owner_id),e.presences)for(const t of e.presences)this.presences.add(t);if(this.voiceStates||(this.voiceStates=new class extends c{constructor(e){super(),this.guild=e}set(e,t){const s=this.guild.members.get(e);if(s){s.voiceChannel&&s.voiceChannel.id!==t.channel_id&&s.voiceChannel.members.delete(s.id),t.channel_id||(s.speaking=null);const e=this.guild.channels.get(t.channel_id);e&&e.members.set(s.user.id,s)}super.set(e,t)}delete(e){const t=this.get(e);if(t&&t.channel_id){const s=this.guild.channels.get(t.channel_id);s&&s.members.delete(e)}return super.delete(e)}}(this)),e.voice_states)for(const t of e.voice_states)this.voiceStates.set(t.user_id,t);if(this.emojis)this.client.actions.GuildEmojisUpdate.handle({guild_id:this.id,emojis:e.emojis});else if(this.emojis=new g(this),e.emojis)for(const t of e.emojis)this.emojis.add(t)}get createdTimestamp(){return p.deconstruct(this.id).timestamp}get createdAt(){return new Date(this.createdTimestamp)}get joinedAt(){return new Date(this.joinedTimestamp)}get verified(){return this.features.includes("VERIFIED")}iconURL({format:e,size:t}={}){return this.icon?this.client.rest.cdn.Icon(this.id,this.icon,e,t):null}get nameAcronym(){return this.name.replace(/\w+/g,e=>e[0]).replace(/\s/g,"")}splashURL({format:e,size:t}={}){return this.splash?this.client.rest.cdn.Splash(this.id,this.splash,e,t):null}get owner(){return this.members.get(this.ownerID)||null}get afkChannel(){return this.client.channels.get(this.afkChannelID)||null}get systemChannel(){return this.client.channels.get(this.systemChannelID)||null}get voiceConnection(){return h?null:this.client.voice.connections.get(this.id)||null}get position(){return this.client.user.bot?null:this.client.user.settings.guildPositions?this.client.user.settings.guildPositions.indexOf(this.id):null}get muted(){if(this.client.user.bot)return null;try{return this.client.user.guildSettings.get(this.id).muted}catch(e){return!1}}get messageNotifications(){if(this.client.user.bot)return null;try{return this.client.user.guildSettings.get(this.id).messageNotifications}catch(e){return null}}get mobilePush(){if(this.client.user.bot)return null;try{return this.client.user.guildSettings.get(this.id).mobilePush}catch(e){return!1}}get suppressEveryone(){if(this.client.user.bot)return null;try{return this.client.user.guildSettings.get(this.id).suppressEveryone}catch(e){return null}}get defaultRole(){return this.roles.get(this.id)||null}get me(){return this.members.get(this.client.user.id)||null}member(e){return this.members.resolve(e)}fetchBans(){return this.client.api.guilds(this.id).bans.get().then(e=>e.reduce((e,t)=>(e.set(t.user.id,{reason:t.reason,user:this.client.users.add(t.user)}),e),new c))}fetchInvites(){return this.client.api.guilds(this.id).invites.get().then(e=>{const t=new c;for(const s of e){const e=new i(this.client,s);t.set(e.code,e)}return t})}fetchWebhooks(){return this.client.api.guilds(this.id).webhooks.get().then(e=>{const t=new c;for(const s of e)t.set(s.id,new r(this.client,s));return t})}fetchVoiceRegions(){return this.client.api.guilds(this.id).regions.get().then(e=>{const t=new c;for(const s of e)t.set(s.id,new a(s));return t})}fetchAuditLogs(e={}){return e.before&&e.before instanceof n.Entry&&(e.before=e.before.id),e.after&&e.after instanceof n.Entry&&(e.after=e.after.id),"string"==typeof e.type&&(e.type=n.Actions[e.type]),this.client.api.guilds(this.id)["audit-logs"].get({query:{before:e.before,after:e.after,limit:e.limit,user_id:this.client.users.resolveID(e.user),action_type:e.type}}).then(e=>n.build(this,e))}addMember(e,t){if(!(e=this.client.users.resolveID(e)))return Promise.reject(new y("INVALID_TYPE","user","UserResolvable"));if(this.members.has(e))return Promise.resolve(this.members.get(e));if(t.access_token=t.accessToken,t.roles){const e=[];for(let s of t.roles instanceof c?t.roles.values():t.roles){if(!(s=this.roles.resolve(s)))return Promise.reject(new y("INVALID_TYPE","options.roles","Array or Collection of Roles or Snowflakes",!0));e.push(s.id)}}return this.client.api.guilds(this.id).members(e).put({data:t}).then(e=>this.members.add(e))}search(e={}){return f.search(this,e)}edit(e,t){const s={};return e.name&&(s.name=e.name),e.region&&(s.region=e.region),void 0!==e.verificationLevel&&(s.verification_level=Number(e.verificationLevel)),void 0!==e.afkChannel&&(s.afk_channel_id=this.client.channels.resolveID(e.afkChannel)),void 0!==e.systemChannel&&(s.system_channel_id=this.client.channels.resolveID(e.systemChannel)),e.afkTimeout&&(s.afk_timeout=Number(e.afkTimeout)),void 0!==e.icon&&(s.icon=e.icon),e.owner&&(s.owner_id=this.client.users.resolve(e.owner).id),e.splash&&(s.splash=e.splash),void 0!==e.explicitContentFilter&&(s.explicit_content_filter=Number(e.explicitContentFilter)),this.client.api.guilds(this.id).patch({data:s,reason:t}).then(e=>this.client.actions.GuildUpdate.handle(e).updated)}setExplicitContentFilter(e,t){return this.edit({explicitContentFilter:e},t)}setName(e,t){return this.edit({name:e},t)}setRegion(e,t){return this.edit({region:e},t)}setVerificationLevel(e,t){return this.edit({verificationLevel:e},t)}setAFKChannel(e,t){return this.edit({afkChannel:e},t)}setSystemChannel(e,t){return this.edit({systemChannel:e},t)}setAFKTimeout(e,t){return this.edit({afkTimeout:e},t)}async setIcon(e,t){return this.edit({icon:await u.resolveImage(e),reason:t})}setOwner(e,t){return this.edit({owner:e},t)}async setSplash(e,t){return this.edit({splash:await u.resolveImage(e),reason:t})}setPosition(e,t){return this.client.user.bot?Promise.reject(new w("FEATURE_USER_ONLY")):this.client.user.settings.setGuildPosition(this,e,t)}acknowledge(){return this.client.api.guilds(this.id).ack.post({data:{token:this.client.rest._ackToken}}).then(e=>(e.token&&(this.client.rest._ackToken=e.token),this))}allowDMs(e){if(this.client.user.bot)return Promise.reject(new w("FEATURE_USER_ONLY"));const t=this.client.user.settings;return e?t.removeRestrictedGuild(this):t.addRestrictedGuild(this)}sync(){this.client.user.bot||this.client.syncGuilds([this])}setChannelPositions(e){const t=e.map(e=>({id:this.client.channels.resolveID(e.channel),position:e.position}));return this.client.api.guilds(this.id).channels.patch({data:t}).then(()=>this.client.actions.GuildChannelsPositionUpdate.handle({guild_id:this.id,channels:t}).guild)}leave(){return this.ownerID===this.client.user.id?Promise.reject(new w("GUILD_OWNED")):this.client.api.users("@me").guilds(this.id).delete().then(()=>this.client.actions.GuildDelete.handle({id:this.id}).guild)}delete(){return this.client.api.guilds(this.id).delete().then(()=>this.client.actions.GuildDelete.handle({id:this.id}).guild)}equals(e){let t=e&&e instanceof this.constructor&&this.id===e.id&&this.available===e.available&&this.splash===e.splash&&this.region===e.region&&this.name===e.name&&this.memberCount===e.memberCount&&this.large===e.large&&this.icon===e.icon&&d.arraysEqual(this.features,e.features)&&this.ownerID===e.ownerID&&this.verificationLevel===e.verificationLevel&&this.embedEnabled===e.embedEnabled;return t&&(this.embedChannel?e.embedChannel&&this.embedChannel.id===e.embedChannel.id||(t=!1):e.embedChannel&&(t=!1)),t}toString(){return this.name}toJSON(){const e=super.toJSON({available:!1,createdTimestamp:!0,nameAcronym:!0,presences:!1,voiceStates:!1});return e.iconURL=this.iconURL(),e.splashURL=this.splashURL(),e}_sortedRoles(){return d.discordSort(this.roles)}_sortedChannels(e){const t=e.type===o.CATEGORY;return d.discordSort(this.channels.filter(s=>s.type===e.type&&(t||s.parent===e.parent)))}_memberSpeakUpdate(e,t){const s=this.members.get(e);s&&s.speaking!==t&&(s.speaking=t,this.client.emit(l.GUILD_MEMBER_SPEAKING,s,t))}}},function(e,t,s){const i=s(75),n=s(28),r=s(10),a=s(3),{RangeError:o,TypeError:l}=s(5);class h{constructor(){this.messages=new c(this),this.lastMessageID=null}get lastMessage(){return this.messages.get(this.lastMessageID)||null}send(e,t){return t||"object"!=typeof e||e instanceof Array?t||(t={}):(t=e,e=null),t.content||(t.content=e),n.sendMessage(this,t)}search(e={}){return n.search(this,e)}startTyping(e){if(void 0!==e&&e<1)throw new o("TYPING_COUNT");if(this.client.user._typing.has(this.id)){const t=this.client.user._typing.get(this.id);return t.count=e||t.count+1,t.promise}const t={};return t.promise=new Promise((s,i)=>{const n=this.client.api.channels[this.id].typing;Object.assign(t,{count:e||1,interval:this.client.setInterval(()=>{n.post().catch(e=>{this.client.clearInterval(t.interval),this.client.user._typing.delete(this.id),i(e)})},9e3),resolve:s}),n.post().catch(e=>{this.client.clearInterval(t.interval),this.client.user._typing.delete(this.id),i(e)}),this.client.user._typing.set(this.id,t)}),t.promise}stopTyping(e=!1){if(this.client.user._typing.has(this.id)){const t=this.client.user._typing.get(this.id);t.count--,(t.count<=0||e)&&(this.client.clearInterval(t.interval),this.client.user._typing.delete(this.id),t.resolve())}}get typing(){return this.client.user._typing.has(this.id)}get typingCount(){return this.client.user._typing.has(this.id)?this.client.user._typing.get(this.id).count:0}createMessageCollector(e,t={}){return new i(this,e,t)}awaitMessages(e,t={}){return new Promise((s,i)=>{this.createMessageCollector(e,t).once("end",(e,n)=>{t.errors&&t.errors.includes(n)?i(e):s(e)})})}async bulkDelete(e,t=!1){if(e instanceof Array||e instanceof a){let s=e instanceof a?e.keyArray():e.map(e=>e.id||e);if(t&&(s=s.filter(e=>Date.now()-r.deconstruct(e).date.getTime()<12096e5)),0===s.length)return new a;if(1===s.length){await this.client.api.channels(this.id).messages(s[0]).delete();const e=this.client.actions.MessageDelete.handle({channel_id:this.id,id:s[0]}).message;return e?new a([[e.id,e]]):new a}return await this.client.api.channels[this.id].messages["bulk-delete"].post({data:{messages:s}}),this.client.actions.MessageDeleteBulk.handle({channel_id:this.id,ids:s}).messages}if(!isNaN(e)){const s=await this.messages.fetch({limit:e});return this.bulkDelete(s,t)}throw new l("MESSAGE_BULK_DELETE_TYPE")}acknowledge(){return this.lastMessageID?this.client.api.channels[this.id].messages[this.lastMessageID].ack.post({data:{token:this.client.rest._ackToken}}).then(e=>(e.token&&(this.client.rest._ackToken=e.token),this)):Promise.resolve(this)}static applyToClass(e,t=!1,s=[]){const i=["send"];t&&i.push("acknowledge","lastMessage","search","bulkDelete","startTyping","stopTyping","typing","typingCount","createMessageCollector","awaitMessages");for(const t of i)s.includes(t)||Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(h.prototype,t))}}e.exports=h;const c=s(20)},function(e,t,s){const i=s(77),n=s(10),r=s(40);class a extends r{constructor(e,t,s){super(e,t),this.guild=s,this.roles=new i(this),this._patch(t)}_patch(e){this.name=e.name,this.requiresColons=e.require_colons,this.managed=e.managed,e.roles&&this.roles._patch(e.roles)}_clone(){const e=super._clone();return e.roles=this.roles.clone(),e}get createdTimestamp(){return n.deconstruct(this.id).timestamp}get createdAt(){return new Date(this.createdTimestamp)}fetchAuthor(){return this.client.api.guilds(this.guild.id).emojis(this.id).get().then(e=>this.client.users.add(e.user))}edit(e,t){return this.client.api.guilds(this.guild.id).emojis(this.id).patch({data:{name:e.name,roles:e.roles?e.roles.map(e=>e.id?e.id:e):void 0},reason:t}).then(()=>{const t=this._clone();return t._patch(e),t})}setName(e,t){return this.edit({name:e},t)}delete(e){return this.client.api.guilds(this.guild.id).emojis(this.id).delete({reason:e}).then(()=>this)}equals(e){return e instanceof a?e.id===this.id&&e.name===this.name&&e.managed===this.managed&&e.requiresColons===this.requiresColons&&e.roles.size===this.roles.size&&e.roles.every(e=>this.roles.has(e.id)):e.id===this.id&&e.name===this.name&&e.roles.length===this.roles.size&&e.roles.every(e=>this.roles.has(e))}}e.exports=a},function(e,t,s){const i=s(63),n=s(25),r=s(26),a=s(62),o=s(34),l=s(6),h=s(3),c=s(162),{MessageTypes:d}=s(0),u=s(11),p=s(9),{Error:f,TypeError:m}=s(5),{createMessage:_}=s(28);e.exports=class extends p{constructor(e,t,s){super(e),this.channel=s,t&&this._patch(t)}_patch(e){this.id=e.id,this.type=d[e.type],this.content=e.content,this.author=this.client.users.add(e.author,!e.webhook_id),this.pinned=e.pinned,this.tts=e.tts,this.nonce=e.nonce,this.system=6===e.type,this.embeds=e.embeds.map(e=>new r(e)),this.attachments=new h;for(const t of e.attachments)this.attachments.set(t.id,new n(t.url,t.filename,t));if(this.createdTimestamp=new Date(e.timestamp).getTime(),this.editedTimestamp=e.edited_timestamp?new Date(e.edited_timestamp).getTime():null,this.reactions=new c(this),e.reactions&&e.reactions.length>0)for(const t of e.reactions)this.reactions.add(t);this.mentions=new i(this,e.mentions,e.mention_roles,e.mention_everyone),this.webhookID=e.webhook_id||null,this.application=e.application?new o(this.client,e.application):null,this.activity=e.activity?{partyID:e.activity.party_id,type:e.activity.type}:null,this.hit="boolean"==typeof e.hit?e.hit:null,this._edits=[]}patch(e){const t=this._clone();if(this._edits.unshift(t),this.editedTimestamp=new Date(e.edited_timestamp).getTime(),"content"in e&&(this.content=e.content),"pinned"in e&&(this.pinned=e.pinned),"tts"in e&&(this.tts=e.tts),this.embeds="embeds"in e?e.embeds.map(e=>new r(e)):this.embeds.slice(),"attachments"in e){this.attachments=new h;for(const t of e.attachments)this.attachments.set(t.id,new n(t.url,t.filename,t))}else this.attachments=new h(this.attachments);this.mentions=new i(this,"mentions"in e?e.mentions:this.mentions.users,"mentions_roles"in e?e.mentions_roles:this.mentions.roles,"mention_everyone"in e?e.mention_everyone:this.mentions.everyone)}get member(){return this.guild&&this.guild.member(this.author)||null}get createdAt(){return new Date(this.createdTimestamp)}get editedAt(){return this.editedTimestamp?new Date(this.editedTimestamp):null}get guild(){return this.channel.guild||null}get cleanContent(){return this.content.replace(/@(everyone|here)/g,"@â€‹$1").replace(/<@!?[0-9]+>/g,e=>{const t=e.replace(/<|!|>|@/g,"");if("dm"===this.channel.type||"group"===this.channel.type)return this.client.users.has(t)?`@${this.client.users.get(t).username}`:e;const s=this.channel.guild.members.get(t);if(s)return s.nickname?`@${s.nickname}`:`@${s.user.username}`;{const s=this.client.users.get(t);return s?`@${s.username}`:e}}).replace(/<#[0-9]+>/g,e=>{const t=this.client.channels.get(e.replace(/<|#|>/g,""));return t?`#${t.name}`:e}).replace(/<@&[0-9]+>/g,e=>{if("dm"===this.channel.type||"group"===this.channel.type)return e;const t=this.guild.roles.get(e.replace(/<|@|>|&/g,""));return t?`@${t.name}`:e})}createReactionCollector(e,t={}){return new a(this,e,t)}awaitReactions(e,t={}){return new Promise((s,i)=>{this.createReactionCollector(e,t).once("end",(e,n)=>{t.errors&&t.errors.includes(n)?i(e):s(e)})})}get edits(){const e=this._edits.slice();return e.unshift(this),e}get editable(){return this.author.id===this.client.user.id}get deletable(){return this.author.id===this.client.user.id||this.guild&&this.channel.permissionsFor(this.client.user).has(u.FLAGS.MANAGE_MESSAGES)}get pinnable(){return!this.guild||this.channel.permissionsFor(this.client.user).has(u.FLAGS.MANAGE_MESSAGES)}async edit(e,t){t||"object"!=typeof e||e instanceof Array?t||(t={}):(t=e,e=null),t.content||(t.content=e);const{data:s}=await _(this,t);return this.client.api.channels[this.channel.id].messages[this.id].patch({data:s}).then(e=>{const t=this._clone();return t._patch(e),t})}pin(){return this.client.api.channels(this.channel.id).pins(this.id).put().then(()=>this)}unpin(){return this.client.api.channels(this.channel.id).pins(this.id).delete().then(()=>this)}react(e){if(!(e=this.client.emojis.resolveIdentifier(e)))throw new m("EMOJI_TYPE");return this.client.api.channels(this.channel.id).messages(this.id).reactions(e,"@me").put().then(()=>this.client.actions.MessageReactionAdd.handle({user:this.client.user,channel:this.channel,message:this,emoji:l.parseEmoji(e)}).reaction)}delete({timeout:e=0,reason:t}={}){return e<=0?this.client.api.channels(this.channel.id).messages(this.id).delete({reason:t}).then(()=>this.client.actions.MessageDelete.handle({id:this.id,channel_id:this.channel.id}).message):new Promise(s=>{this.client.setTimeout(()=>{s(this.delete({reason:t}))},e)})}reply(e,t){return t||"object"!=typeof e||e instanceof Array?t||(t={}):(t=e,e=""),this.channel.send(e,Object.assign(t,{reply:this.member||this.author}))}acknowledge(){return this.client.api.channels(this.channel.id).messages(this.id).ack.post({data:{token:this.client.rest._ackToken}}).then(e=>(e.token&&(this.client.rest._ackToken=e.token),this))}fetchWebhook(){return this.webhookID?this.client.fetchWebhook(this.webhookID):Promise.reject(new f("WEBHOOK_MESSAGE"))}equals(e,t){if(!e)return!1;if(!e.author&&!e.attachments)return this.id===e.id&&this.embeds.length===e.embeds.length;let s=this.id===e.id&&this.author.id===e.author.id&&this.content===e.content&&this.tts===e.tts&&this.nonce===e.nonce&&this.embeds.length===e.embeds.length&&this.attachments.length===e.attachments.length;return s&&t&&(s=this.mentions.everyone===e.mentions.everyone&&this.createdTimestamp===new Date(t.timestamp).getTime()&&this.editedTimestamp===new Date(t.edited_timestamp).getTime()),s}toString(){return this.content}toJSON(){return super.toJSON({channel:"channelID",author:"authorID",application:"applicationID",guild:"guildID",cleanContent:!0,member:!1,reactions:!1})}}},function(e,t,s){const i=s(6);e.exports=class{constructor(e,t,s){this.file=null,s&&this._patch(s),t?this.setAttachment(e,t):this._attach(e)}get name(){return this.file.name}get attachment(){return this.file.attachment}setAttachment(e,t){return this.file={attachment:e,name:t},this}setFile(e){return this.file={attachment:e},this}setName(e){return this.file.name=e,this}_attach(e,t){"string"==typeof e?this.file=e:this.setAttachment(e,t)}_patch(e){this.id=e.id,this.size=e.size,this.url=e.url,this.proxyURL=e.proxy_url,this.height=e.height,this.width=e.width}toJSON(){return i.flatten(this)}}},function(e,t,s){const i=s(25),n=s(6),{RangeError:r}=s(5);e.exports=class{constructor(e={}){this.setup(e)}setup(e){this.type=e.type,this.title=e.title,this.description=e.description,this.url=e.url,this.color=e.color,this.timestamp=e.timestamp?new Date(e.timestamp).getTime():null,this.fields=e.fields?e.fields.map(n.cloneObject):[],this.thumbnail=e.thumbnail?{url:e.thumbnail.url,proxyURL:e.thumbnail.proxy_url,height:e.thumbnail.height,width:e.thumbnail.width}:null,this.image=e.image?{url:e.image.url,proxyURL:e.image.proxy_url,height:e.image.height,width:e.image.width}:null,this.video=e.video,this.author=e.author?{name:e.author.name,url:e.author.url,iconURL:e.author.iconURL||e.author.icon_url,proxyIconURL:e.author.proxyIconUrl||e.author.proxy_icon_url}:null,this.provider=e.provider,this.footer=e.footer?{text:e.footer.text,iconURL:e.footer.iconURL||e.footer.icon_url,proxyIconURL:e.footer.proxyIconURL||e.footer.proxy_icon_url}:null,e.files&&(this.files=e.files.map(e=>e instanceof i?"string"==typeof e.file?e.file:n.cloneObject(e.file):e))}get createdAt(){return this.timestamp?new Date(this.timestamp):null}get hexColor(){return this.color?`#${this.color.toString(16).padStart(6,"0")}`:null}addField(e,t,s=!1){if(this.fields.length>=25)throw new r("EMBED_FIELD_COUNT");if(e=n.resolveString(e),!String(e))throw new r("EMBED_FIELD_NAME");if(t=n.resolveString(t),!String(t))throw new r("EMBED_FIELD_VALUE");return this.fields.push({name:e,value:t,inline:s}),this}addBlankField(e=!1){return this.addField("â€‹","â€‹",e)}attachFiles(e){this.files?this.files=this.files.concat(e):this.files=e;for(let t of e)t instanceof i&&(t=t.file);return this}setAuthor(e,t,s){return this.author={name:n.resolveString(e),iconURL:t,url:s},this}setColor(e){return this.color=n.resolveColor(e),this}setDescription(e){return e=n.resolveString(e),this.description=e,this}setFooter(e,t){return e=n.resolveString(e),this.footer={text:e,iconURL:t},this}setImage(e){return this.image={url:e},this}setThumbnail(e){return this.thumbnail={url:e},this}setTimestamp(e=new Date){return this.timestamp=e.getTime(),this}setTitle(e){return e=n.resolveString(e),this.title=e,this}setURL(e){return this.url=e,this}toJSON(){return n.flatten(this,{hexColor:!0})}_apiTransform(){return{title:this.title,type:"rich",description:this.description,url:this.url,timestamp:this.timestamp?new Date(this.timestamp):null,color:this.color,fields:this.fields,thumbnail:this.thumbnail,image:this.image,author:this.author?{name:this.author.name,url:this.author.url,icon_url:this.author.iconURL}:null,footer:this.footer?{text:this.footer.text,icon_url:this.footer.iconURL}:null}}}},function(e,t,s){const{Endpoints:i}=s(0),n=s(9);e.exports=class extends n{constructor(e,t){super(e),this._patch(t)}_patch(e){this.guild=this.client.guilds.add(e.guild,!1),this.code=e.code,this.presenceCount=e.approximate_presence_count,this.memberCount=e.approximate_member_count,this.textChannelCount=e.guild.text_channel_count,this.voiceChannelCount=e.guild.voice_channel_count,this.temporary=e.temporary,this.maxAge=e.max_age,this.uses=e.uses,this.maxUses=e.max_uses,e.inviter&&(this.inviter=this.client.users.add(e.inviter)),this.channel=this.client.channels.add(e.channel,this.guild,!1),this.createdTimestamp=new Date(e.created_at).getTime()}get createdAt(){return new Date(this.createdTimestamp)}get expiresTimestamp(){return this.createdTimestamp+1e3*this.maxAge}get expiresAt(){return new Date(this.expiresTimestamp)}get url(){return i.invite(this.client.options.http.invite,this.code)}delete(e){return this.client.api.invites[this.code].delete({reason:e}).then(()=>this)}toString(){return this.url}toJSON(){return super.toJSON({url:!0,expiresTimestamp:!0,presenceCount:!1,memberCount:!1,textChannelCount:!1,voiceChannelCount:!1,uses:!1,channel:"channelID",inviter:"inviterID",guild:"guildID"})}}},function(e,t,s){e.exports={search:s(165),sendMessage:s(164),createMessage:s(66)}},function(e,t,s){const i={GuildEmoji:s(23),DMChannel:s(76),GroupDMChannel:s(60),TextChannel:s(59),VoiceChannel:s(58),CategoryChannel:s(57),GuildChannel:s(18),GuildMember:s(14),Guild:s(21),Message:s(24),MessageReaction:s(33),Presence:s(13).Presence,Role:s(19),User:s(17)};e.exports=class{constructor(){throw new Error(`The ${this.constructor.name} class may not be instantiated.`)}static get(e){if("string"==typeof e)return i[e];throw new TypeError(`"structure" argument must be a string (received ${typeof e})`)}static extend(e,t){if(!i[e])throw new RangeError(`"${e}" is not a valid extensible structure.`);if("function"!=typeof t){const e=`(received ${typeof t})`;throw new TypeError(`"extender" argument must be a function that returns the extended structure class/prototype ${e}`)}const s=t(i[e]);if("function"!=typeof s)throw new TypeError("The extender function must return the extended structure class/prototype.");if(Object.getPrototypeOf(s)!==i[e])throw new Error("The class/prototype returned from the extender function must extend the existing structure class/prototype.");return i[e]=s,s}}},function(e,t){function s(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function n(e){return"object"==typeof e&&null!==e}function r(e){return void 0===e}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},s.prototype.emit=function(e){var t,s,a,o,l,h;if(this._events||(this._events={}),"error"===e&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(r(s=this._events[e]))return!1;if(i(s))switch(arguments.length){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),s.apply(this,o)}else if(n(s))for(o=Array.prototype.slice.call(arguments,1),a=(h=s.slice()).length,l=0;l<a;l++)h[l].apply(this,o);return!0},s.prototype.addListener=function(e,t){var a;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?n(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,n(this._events[e])&&!this._events[e].warned&&(a=r(this._maxListeners)?s.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var s=!1;function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},s.prototype.removeListener=function(e,t){var s,r,a,o;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(s=this._events[e]).length,r=-1,s===t||i(s.listener)&&s.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(n(s)){for(o=a;o-- >0;)if(s[o]===t||s[o].listener&&s[o].listener===t){r=o;break}if(r<0)return this;1===s.length?(s.length=0,delete this._events[e]):s.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},s.prototype.removeAllListeners=function(e){var t,s;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(s=this._events[e]))this.removeListener(e,s);else if(s)for(;s.length;)this.removeListener(e,s[s.length-1]);return delete this._events[e],this},s.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},s.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},s.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,s){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,s){const{UserGuildSettingsMap:i}=s(0),n=s(3),r=s(55);e.exports=class{constructor(e,t){Object.defineProperty(this,"client",{value:e}),this.guildID=t.guild_id,this.channelOverrides=new n,this.patch(t)}patch(e){for(const[t,s]of Object.entries(i))if(e.hasOwnProperty(t))if("channel_overrides"===t)for(const s of e[t]){const e=this.channelOverrides.get(s.channel_id);e?e.patch(s):this.channelOverrides.set(s.channel_id,new r(s))}else"function"==typeof s?this[s.name]=s(e[t]):this[s]=e[t]}update(e,t){return this.client.api.users("@me").guilds(this.guildID).settings.patch({data:{[e]:t}})}}},function(e,t,s){const i=s(23),n=s(6),r=s(36),a=s(61);e.exports=class{constructor(e,t,s){this.message=s,this.me=t.me,this.count=t.count||0,this.users=new a(e,void 0,this),this._emoji=new r(this,t.emoji)}get emoji(){if(this._emoji instanceof i)return this._emoji;if(this._emoji.id){const e=this.message.client.emojis;if(e.has(this._emoji.id)){const t=e.get(this._emoji.id);return this._emoji=t,t}}return this._emoji}toJSON(){return n.flatten(this,{emoji:"emojiID",message:"messageID"})}_add(e){this.users.set(e.id,e),this.me&&e.id===this.message.client.user.id&&0!==this.count||this.count++,this.me||(this.me=e.id===this.message.client.user.id)}_remove(e){this.users.delete(e.id),this.me&&e.id===this.message.client.user.id||this.count--,e.id===this.message.client.user.id&&(this.me=!1),this.count<=0&&this.message.reactions.remove(this.emoji.id||this.emoji.name)}}},function(e,t,s){const i=s(10),{ClientApplicationAssetTypes:n,Endpoints:r}=s(0),a=s(8),o=s(9);class l extends o{constructor(e,t){super(e),this._patch(t)}_patch(e){this.id=e.id,this.name=e.name,this.description=e.description,this.icon=e.icon,this.cover=e.cover_image,this.rpcOrigins=e.rpc_origins,this.redirectURIs=e.redirect_uris,this.botRequireCodeGrant=e.bot_require_code_grant,this.botPublic=e.bot_public,this.rpcApplicationState=e.rpc_application_state,this.bot=e.bot,this.flags=e.flags,this.secret=e.secret,e.owner&&(this.owner=this.client.users.add(e.owner))}get createdTimestamp(){return i.deconstruct(this.id).timestamp}get createdAt(){return new Date(this.createdTimestamp)}iconURL({format:e,size:t}={}){return this.icon?this.client.rest.cdn.AppIcon(this.id,this.icon,{format:e,size:t}):null}coverImage({format:e,size:t}={}){return this.cover?r.CDN(this.client.options.http.cdn).AppIcon(this.id,this.cover,{format:e,size:t}):null}fetchAssets(){const e=Object.keys(n);return this.client.api.oauth2.applications(this.id).assets.get().then(t=>t.map(t=>({id:t.id,name:t.name,type:e[t.type-1]})))}async createAsset(e,t,s){return this.client.api.oauth2.applications(this.id).assets.post({data:{name:e,type:n[s.toUpperCase()],image:await a.resolveImage(t)}})}resetSecret(){return this.client.api.oauth2.applications[this.id].reset.post().then(e=>new l(this.client,e))}resetToken(){return this.client.api.oauth2.applications[this.id].bot.reset.post().then(e=>new l(this.client,Object.assign({},this,{bot:e})))}toString(){return this.name}toJSON(){return super.toJSON({createdTimestamp:!0})}}e.exports=l},function(e,t,s){const i=s(7),{Presence:n}=s(13);e.exports=class extends i{constructor(e,t){super(e,t,n)}add(e,t){const s=this.get(e.user.id);return s?s.patch(e):super.add(e,t,{id:e.user.id})}resolve(e){const t=super.resolve(e);if(t)return t;const s=this.client.users.resolveID(e);return super.resolve(s)||null}resolveID(e){const t=super.resolveID(e);if(t)return t;const s=this.client.users.resolveID(e);return this.has(s)?s:null}}},function(e,t,s){const i=s(6),n=s(40);e.exports=class extends n{constructor(e,t){super(e.message.client,t),this.reaction=e}toJSON(){return i.flatten(this,{identifier:!0})}valueOf(){return this.id}}},function(e,t,s){const i=s(3),n=s(7),r=s(23),a=s(36),o=s(8),{TypeError:l}=s(5);e.exports=class extends n{constructor(e,t){super(e.client,t,r),this.guild=e}add(e,t){return super.add(e,t,{extras:[this.guild]})}create(e,t,{roles:s,reason:n}={}){if("string"==typeof e&&e.startsWith("data:")){const r={image:e,name:t};if(s){r.roles=[];for(let e of s instanceof i?s.values():s){if(!(e=this.guild.roles.resolve(e)))return Promise.reject(new l("INVALID_TYPE","options.roles","Array or Collection of Roles or Snowflakes",!0));r.roles.push(e.id)}}return this.client.api.guilds(this.guild.id).emojis.post({data:r,reason:n}).then(e=>this.client.actions.GuildEmojiCreate.handle(this.guild,e).emoji)}return o.resolveImage(e).then(e=>this.create(e,t,{roles:s,reason:n}))}resolve(e){return e instanceof a?super.resolve(e.id):super.resolve(e)}resolveID(e){return e instanceof a?e.id:super.resolveID(e)}resolveIdentifier(e){const t=this.resolve(e);return t?t.identifier:e instanceof a?e.identifier:"string"==typeof e?e.includes("%")?e:encodeURIComponent(e):null}}},function(e,t,s){const i=s(6);e.exports=class{constructor(e){this.id=e.id,this.name=e.name,this.vip=e.vip,this.deprecated=e.deprecated,this.optimal=e.optimal,this.custom=e.custom,this.sampleHostname=e.sample_hostname}toJSON(){return i.flatten(this)}}},function(e,t,s){const i=s(3),n=s(6),r=s(30);e.exports=class extends r{constructor(e,t,s={}){super(),Object.defineProperty(this,"client",{value:e}),this.filter=t,this.options=s,this.collected=new i,this.ended=!1,this._timeout=null,this.handleCollect=this.handleCollect.bind(this),this.handleDispose=this.handleDispose.bind(this),s.time&&(this._timeout=this.client.setTimeout(()=>this.stop("time"),s.time))}handleCollect(...e){const t=this.collect(...e);t&&this.filter(...e,this.collected)&&(this.collected.set(t,e[0]),this.emit("collect",...e)),this.checkEnd()}handleDispose(...e){if(!this.options.dispose)return;const t=this.dispose(...e);t&&this.filter(...e)&&this.collected.has(t)&&(this.collected.delete(t),this.emit("dispose",...e),this.checkEnd())}get next(){return new Promise((e,t)=>{if(this.ended)return void t(this.collected);const s=()=>{this.removeListener("collect",i),this.removeListener("end",n)},i=t=>{s(),e(t)},n=()=>{s(),t(this.collected)};this.on("collect",i),this.on("end",n)})}stop(e="user"){this.ended||(this._timeout&&this.client.clearTimeout(this._timeout),this.ended=!0,this.emit("end",this.collected,e))}checkEnd(){const e=this.endReason();e&&this.stop(e)}toJSON(){return n.flatten(this)}collect(){}dispose(){}endReason(){}}},function(e,t,s){const i=s(9);e.exports=class extends i{constructor(e,t){super(e),this.animated=t.animated,this.name=t.name,this.id=t.id}get identifier(){return this.id?`${this.animated?"a:":""}${this.name}:${this.id}`:encodeURIComponent(this.name)}get url(){return this.id?this.client.rest.cdn.Emoji(this.id,this.animated?"gif":"png"):null}toString(){return this.id?`<${this.animated?"a":""}:${this.name}:${this.id}>`:this.name}toJSON(){return super.toJSON({guild:"guildID",createdTimestamp:!0,url:!0,identifier:!0})}}},function(e,t,s){const i=s(30),n=s(180),r=s(6),{DefaultOptions:a}=s(0);e.exports=class extends i{constructor(e={}){super(),this.options=r.mergeDefault(a,e),this.rest=new n(this,e._tokenType),this._timeouts=new Set,this._intervals=new Set}get api(){return this.rest.api}destroy(){for(const e of this._timeouts)clearTimeout(e);for(const e of this._intervals)clearInterval(e);this._timeouts.clear(),this._intervals.clear()}setTimeout(e,t,...s){const i=setTimeout(()=>{e(...s),this._timeouts.delete(i)},t);return this._timeouts.add(i),i}clearTimeout(e){clearTimeout(e),this._timeouts.delete(e)}setInterval(e,t,...s){const i=setInterval(e,t,...s);return this._intervals.add(i),i}clearInterval(e){clearInterval(e),this._intervals.delete(e)}toJSON(...e){return r.flatten(this,{domain:!1},...e)}}},function(e,t,s){"use strict";t.decode=t.parse=s(185),t.encode=t.stringify=s(184)},function(e,t,s){"use strict";s.r(t),s.d(t,"version",function(){return n}),s.d(t,"METHODS",function(){return r}),s.d(t,"acl",function(){return a}),s.d(t,"bind",function(){return o}),s.d(t,"checkout",function(){return l}),s.d(t,"connect",function(){return h}),s.d(t,"copy",function(){return c}),s.d(t,"delete",function(){return d}),s.d(t,"get",function(){return u}),s.d(t,"head",function(){return p}),s.d(t,"link",function(){return f}),s.d(t,"lock",function(){return m}),s.d(t,"merge",function(){return _}),s.d(t,"mkactivity",function(){return g}),s.d(t,"mkcalendar",function(){return E}),s.d(t,"mkcol",function(){return b}),s.d(t,"move",function(){return v}),s.d(t,"notify",function(){return w}),s.d(t,"options",function(){return y}),s.d(t,"patch",function(){return A}),s.d(t,"post",function(){return I}),s.d(t,"propfind",function(){return T}),s.d(t,"proppatch",function(){return S}),s.d(t,"purge",function(){return D}),s.d(t,"put",function(){return N}),s.d(t,"rebind",function(){return C}),s.d(t,"report",function(){return O}),s.d(t,"search",function(){return k}),s.d(t,"subscribe",function(){return R}),s.d(t,"trace",function(){return L}),s.d(t,"unbind",function(){return x}),s.d(t,"unlink",function(){return M}),s.d(t,"unlock",function(){return U}),s.d(t,"unsubscribe",function(){return P}),s.d(t,"brew",function(){return G});var i=s(2);t.default=i;const n=i.version,r=i.METHODS,a=i.acl,o=i.bind,l=i.checkout,h=i.connect,c=i.copy,d=i.delete,u=i.get,p=i.head,f=i.link,m=i.lock,_=i.merge,g=i.mkactivity,E=i.mkcalendar,b=i.mkcol,v=i.move,w=i.notify,y=i.options,A=i.patch,I=i.post,T=i.propfind,S=i.proppatch,D=i.purge,N=i.put,C=i.rebind,O=i.report,k=i.search,R=i.subscribe,L=i.trace,x=i.unbind,M=i.unlink,U=i.unlock,P=i.unsubscribe,G=i.brew},function(e,t,s){const i=s(35),n=s(3),{ActivityTypes:r,OPCodes:a}=s(0),{Presence:o}=s(13),{TypeError:l}=s(5);e.exports=class extends i{constructor(...e){super(...e),this.clientPresence=new o(this.client,{status:"online",afk:!1,since:null,activity:null})}async setClientPresence(e){const t=await this._parse(e);return this.clientPresence.patch(t),this.client.ws.send({op:a.STATUS_UPDATE,d:t}),this.clientPresence}async _parse({status:e,since:t,afk:s,activity:i}){const a=i&&(i.application?i.application.id||i.application:null);let o=new n;if(i){if("string"!=typeof i.name)throw new l("INVALID_TYPE","name","string");if(i.type||(i.type=0),i.assets&&a)try{const t=await this.client.api.oauth2.applications(a).assets.get();for(const e of t)o.set(e.name,e.id)}catch(e){}}const h={afk:null!=s&&s,since:null!=t?t:null,status:e||this.clientPresence.status,game:i?{type:i.type,name:i.name,url:i.url,details:i.details||void 0,state:i.state||void 0,assets:i.assets?{large_text:i.assets.largeText||void 0,small_text:i.assets.smallText||void 0,large_image:o.get(i.assets.largeImage)||i.assets.largeImage,small_image:o.get(i.assets.smallImage)||i.assets.smallImage}:void 0,timestamps:i.timestamps||void 0,party:i.party||void 0,application_id:a||void 0,secrets:i.secrets||void 0,instance:i.instance||void 0}:null};return(e||s||t)&&!i&&(h.game=this.clientPresence.activity),h.game&&(h.game.type="number"==typeof h.game.type?h.game.type:r.indexOf(h.game.type)),h}}},function(e,t,s){const i=s(7),n=s(8),{Events:r}=s(0),a=s(21);e.exports=class extends i{constructor(e,t){super(e,t,a)}create(e,{region:t,icon:s=null}={}){return!s||"string"==typeof s&&s.startsWith("data:")?new Promise((i,n)=>this.client.api.guilds.post({data:{name:e,region:t,icon:s}}).then(e=>{if(this.client.guilds.has(e.id))return i(this.client.guilds.get(e.id));const t=n=>{n.id===e.id&&(this.client.removeListener(r.GUILD_CREATE,t),this.client.clearTimeout(s),i(n))};this.client.on(r.GUILD_CREATE,t);const s=this.client.setTimeout(()=>{this.client.removeListener(r.GUILD_CREATE,t),i(this.client.guilds.add(e))},1e4)},n)):n.resolveImage(s).then(s=>this.create(e,{region:t,icon:s||null}))}}},function(e,t,s){const i=s(7),n=s(16),{Events:r}=s(0),a=Symbol("LRU"),o=["group","dm"];e.exports=class extends i{constructor(e,t={},s){if(s||"function"==typeof t[Symbol.iterator]||(s=t,t=void 0),super(e,t,n),s.lru){const e=this[a]=[];e.add=(t=>{for(e.remove(t),e.unshift(t);e.length>s.lru;)this.remove(e[e.length-1])}),e.remove=(t=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)})}}get(e,t=!1){const s=super.get(e);return s&&o.includes(s.type)?(!t&&this[a]&&this[a].add(e),s):s}set(e,t){return this[a]&&o.includes(t.type)&&this[a].add(e),super.set(e,t)}delete(e){const t=this.get(e,!0);return!!t&&(this[a]&&o.includes(t.type)&&this[a].remove(e),super.delete(e))}add(e,t,s=!0){const i=this.get(e.id);if(i)return i;const a=n.create(this.client,e,t);return a?(s&&this.set(a.id,a),a):(this.client.emit(r.DEBUG,`Failed to find guild for channel ${e.id} ${e.type}`),null)}remove(e){const t=this.get(e);t.guild&&t.guild.channels.remove(e),super.remove(e)}}},function(e,t,s){const i=s(7),n=s(17),r=s(14),a=s(24);e.exports=class extends i{constructor(e,t){super(e,t,n)}resolve(e){return e instanceof r?e.user:e instanceof a?e.author:super.resolve(e)}resolveID(e){return e instanceof r?e.user.id:e instanceof a?e.author.id:super.resolveID(e)}fetch(e,t=!0){const s=this.get(e);return s?Promise.resolve(s):this.client.api.users(e).get().then(e=>this.add(e,t))}}},function(e,t,s){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,s){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,s){"use strict";var i=s(12),n=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){r=!1}for(var a=new i.Buf8(256),o=0;o<256;o++)a[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(e,t){if(t<65537&&(e.subarray&&r||!e.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var s="",a=0;a<t;a++)s+=String.fromCharCode(e[a]);return s}a[254]=a[254]=1,t.string2buf=function(e){var t,s,n,r,a,o=e.length,l=0;for(r=0;r<o;r++)55296==(64512&(s=e.charCodeAt(r)))&&r+1<o&&56320==(64512&(n=e.charCodeAt(r+1)))&&(s=65536+(s-55296<<10)+(n-56320),r++),l+=s<128?1:s<2048?2:s<65536?3:4;for(t=new i.Buf8(l),a=0,r=0;a<l;r++)55296==(64512&(s=e.charCodeAt(r)))&&r+1<o&&56320==(64512&(n=e.charCodeAt(r+1)))&&(s=65536+(s-55296<<10)+(n-56320),r++),s<128?t[a++]=s:s<2048?(t[a++]=192|s>>>6,t[a++]=128|63&s):s<65536?(t[a++]=224|s>>>12,t[a++]=128|s>>>6&63,t[a++]=128|63&s):(t[a++]=240|s>>>18,t[a++]=128|s>>>12&63,t[a++]=128|s>>>6&63,t[a++]=128|63&s);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),s=0,n=t.length;s<n;s++)t[s]=e.charCodeAt(s);return t},t.buf2string=function(e,t){var s,i,n,r,o=t||e.length,h=new Array(2*o);for(i=0,s=0;s<o;)if((n=e[s++])<128)h[i++]=n;else if((r=a[n])>4)h[i++]=65533,s+=r-1;else{for(n&=2===r?31:3===r?15:7;r>1&&s<o;)n=n<<6|63&e[s++],r--;r>1?h[i++]=65533:n<65536?h[i++]=n:(n-=65536,h[i++]=55296|n>>10&1023,h[i++]=56320|1023&n)}return l(h,i)},t.utf8border=function(e,t){var s;for((t=t||e.length)>e.length&&(t=e.length),s=t-1;s>=0&&128==(192&e[s]);)s--;return s<0?t:0===s?t:s+a[e[s]]>t?s:t}},function(e,t,s){"use strict";var i=function(){for(var e,t=[],s=0;s<256;s++){e=s;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[s]=e}return t}();e.exports=function(e,t,s,n){var r=i,a=n+s;e^=-1;for(var o=n;o<a;o++)e=e>>>8^r[255&(e^t[o])];return-1^e}},function(e,t,s){"use strict";e.exports=function(e,t,s,i){for(var n=65535&e|0,r=e>>>16&65535|0,a=0;0!==s;){s-=a=s>2e3?2e3:s;do{r=r+(n=n+t[i++]|0)|0}while(--a);n%=65521,r%=65521}return n|r<<16|0}},function(e,t,s){"use strict";var i={};(0,s(12).assign)(i,s(121),s(118),s(48)),e.exports=i},function(e,t,s){const{browser:i}=s(0),n=s(42);try{var r=s(125);r.pack||(r=null)}catch(e){}if(i)t.WebSocket=window.WebSocket;else try{t.WebSocket=s(124)}catch(e){t.WebSocket=s(123)}t.encoding=r?"etf":"json",t.pack=r?r.pack:JSON.stringify,t.unpack=(e=>r&&"{"!==e[0]?(e instanceof Buffer||(e=Buffer.from(new Uint8Array(e))),r.unpack(e)):JSON.parse(e)),t.create=((e,s={},...r)=>{const[a,o]=e.split("?");s.encoding=t.encoding,o&&(s=Object.assign(n.parse(o),s));const l=new t.WebSocket(`${a}?${n.stringify(s)}`,...r);return i&&(l.binaryType="arraybuffer"),l});for(const e of["CONNECTING","OPEN","CLOSING","CLOSED"])t[e]=t.WebSocket[e]},function(e,t,s){const{UserChannelOverrideMap:i}=s(0);e.exports=class{constructor(e){this.patch(e)}patch(e){for(const[t,s]of Object.entries(i))e.hasOwnProperty(t)&&("function"==typeof s?this[s.name]=s(e[t]):this[s]=e[t])}}},function(e,t,s){const{UserSettingsMap:i}=s(0),n=s(6),{Error:r}=s(5);e.exports=class{constructor(e,t){this.user=e,this.patch(t)}patch(e){for(const[t,s]of Object.entries(i))e.hasOwnProperty(t)&&("function"==typeof s?this[s.name]=s(e[t]):this[s]=e[t])}update(e,t){return this.user.client.api.users["@me"].settings.patch({data:{[e]:t}})}setGuildPosition(e,t,s){const i=Object.assign([],this.guildPositions);return n.moveElementInArray(i,e.id,t,s),this.update("guild_positions",i).then(()=>e)}addRestrictedGuild(e){const t=Object.assign([],this.restrictedGuilds);return t.includes(e.id)?Promise.reject(new r("GUILD_RESTRICTED",!0)):(t.push(e.id),this.update("restricted_guilds",t).then(()=>e))}removeRestrictedGuild(e){const t=Object.assign([],this.restrictedGuilds),s=t.indexOf(e.id);return s<0?Promise.reject(new r("GUILD_RESTRICTED")):(t.splice(s,1),this.update("restricted_guilds",t).then(()=>e))}}},function(e,t,s){const i=s(18);e.exports=class extends i{get children(){return this.guild.channels.filter(e=>e.parentID===this.id)}}},function(e,t,s){const i=s(18),n=s(3),{browser:r}=s(0),{Error:a}=s(5);e.exports=class extends i{constructor(e,t){super(e,t),Object.defineProperty(this,"members",{value:new n})}_patch(e){super._patch(e),this.bitrate=e.bitrate,this.userLimit=e.user_limit}get connection(){const e=this.guild.voiceConnection;return e&&e.channel.id===this.id?e:null}get full(){return this.userLimit>0&&this.members.size>=this.userLimit}get joinable(){return!(r||!this.permissionsFor(this.client.user).has("CONNECT")||this.full&&!this.permissionsFor(this.client.user).has("MOVE_MEMBERS"))}get speakable(){return this.permissionsFor(this.client.user).has("SPEAK")}setBitrate(e,t){return this.edit({bitrate:e},t)}setUserLimit(e,t){return this.edit({userLimit:e},t)}join(){return r?Promise.reject(new a("VOICE_NO_BROWSER")):this.client.voice.joinChannel(this)}leave(){if(r)return;const e=this.client.voice.connections.get(this.guild.id);e&&e.channel.id===this.id&&e.disconnect()}}},function(e,t,s){const i=s(18),n=s(15),r=s(22),a=s(3),o=s(8),l=s(20);class h extends i{constructor(e,t){super(e,t),this.messages=new l(this),this._typing=new Map}_patch(e){if(super._patch(e),this.topic=e.topic,this.nsfw=Boolean(e.nsfw),this.lastMessageID=e.last_message_id,e.messages)for(const t of e.messages)this.messages.add(t)}setNSFW(e,t){return this.edit({nsfw:e},t)}fetchWebhooks(){return this.client.api.channels[this.id].webhooks.get().then(e=>{const t=new a;for(const s of e)t.set(s.id,new n(this.client,s));return t})}async createWebhook(e,{avatar:t,reason:s}={}){return"string"!=typeof t||t.startsWith("data:")||(t=await o.resolveImage(t)),this.client.api.channels[this.id].webhooks.post({data:{name:e,avatar:t},reason:s}).then(e=>new n(this.client,e))}get lastMessage(){}send(){}search(){}startTyping(){}stopTyping(){}get typing(){}get typingCount(){}createMessageCollector(){}awaitMessages(){}bulkDelete(){}acknowledge(){}_cacheMessage(){}}r.applyToClass(h,!0),e.exports=h},function(e,t,s){const i=s(16),n=s(22),r=s(3),a=s(8),o=s(20);class l extends i{constructor(e,t){super(e,t),this.messages=new o(this),this._typing=new Map}_patch(e){if(super._patch(e),this.name=e.name,this.icon=e.icon,this.ownerID=e.owner_id,this.managed=e.managed,this.applicationID=e.application_id,e.nicks&&(this.nicks=new r(e.nicks.map(e=>[e.id,e.nick]))),this.recipients||(this.recipients=new r),e.recipients)for(const t of e.recipients){const e=this.client.users.add(t);this.recipients.set(e.id,e)}this.lastMessageID=e.last_message_id}get owner(){return this.client.users.get(this.ownerID)||null}iconURL({format:e,size:t}={}){return this.icon?this.client.rest.cdn.GDMIcon(this.id,this.icon,e,t):null}equals(e){const t=e&&this.id===e.id&&this.name===e.name&&this.icon===e.icon&&this.ownerID===e.ownerID;return t?this.recipients.equals(e.recipients):t}edit(e,t){return this.client.api.channels[this.id].patch({data:{icon:e.icon,name:null===e.name?null:e.name||this.name},reason:t}).then(()=>this)}async setIcon(e){return this.edit({icon:await a.resolveImage(e)})}setName(e){return this.edit({name:e})}addUser({user:e,accessToken:t,nick:s}){const i=this.client.users.resolveID(e),n=this.client.user.bot?{nick:s,access_token:t}:{recipient:i};return this.client.api.channels[this.id].recipients[i].put({data:n}).then(()=>this)}removeUser(e){const t=this.client.users.resolveID(e);return this.client.api.channels[this.id].recipients[t].delete().then(()=>this)}toString(){return this.name}get lastMessage(){}send(){}search(){}startTyping(){}stopTyping(){}get typing(){}get typingCount(){}createMessageCollector(){}awaitMessages(){}acknowledge(){}_cacheMessage(){}}n.applyToClass(l,!0,["bulkDelete"]),e.exports=l},function(e,t,s){const i=s(7),{Error:n}=s(5);e.exports=class extends i{constructor(e,t,i){super(e,t,s(17)),this.reaction=i}async fetch({limit:e=100,after:t,before:s}={}){const i=this.reaction.message,n=await this.client.api.channels[i.channel.id].messages[i.id].reactions[this.reaction.emoji.identifier].get({query:{limit:e,before:s,after:t}});for(const e of n){const t=this.client.users.add(e);this.set(t.id,t)}return this}remove(e=this.reaction.message.client.user){const t=this.reaction.message,s=t.client.users.resolveID(e);return s?t.client.api.channels[t.channel.id].messages[t.id].reactions[this.reaction.emoji.identifier][s===t.client.user.id?"@me":s].delete().then(()=>t.client.actions.MessageReactionRemove.handle({user_id:s,message_id:t.id,emoji:this.reaction.emoji,channel_id:t.channel.id}).reaction):Promise.reject(new n("REACTION_RESOLVE_USER"))}}},function(e,t,s){const i=s(39),n=s(3),{Events:r}=s(0);class a extends i{constructor(e,t,s={}){super(e.client,t,s),this.message=e,this.users=new n,this.total=0,this.empty=this.empty.bind(this),this.client.on(r.MESSAGE_REACTION_ADD,this.handleCollect),this.client.on(r.MESSAGE_REACTION_REMOVE,this.handleDispose),this.client.on(r.MESSAGE_REACTION_REMOVE_ALL,this.empty),this.once("end",()=>{this.client.removeListener(r.MESSAGE_REACTION_ADD,this.handleCollect),this.client.removeListener(r.MESSAGE_REACTION_REMOVE,this.handleDispose),this.client.removeListener(r.MESSAGE_REACTION_REMOVE_ALL,this.empty)}),this.on("collect",(e,t)=>{this.total++,this.users.set(t.id,t)}),this.on("remove",(e,t)=>{this.total--,this.collected.some(e=>e.users.has(t.id))||this.users.delete(t.id)})}collect(e){return e.message.id!==this.message.id?null:a.key(e)}dispose(e,t){return e.message.id!==this.message.id?null:(this.collected.has(a.key(e))&&this.emit("remove",e,t),e.count?null:a.key(e))}empty(){this.total=0,this.collected.clear(),this.users.clear(),this.checkEnd()}endReason(){return this.options.max&&this.total>=this.options.max?"limit":this.options.maxEmojis&&this.collected.size>=this.options.maxEmojis?"emojiLimit":this.options.maxUsers&&this.users.size>=this.options.maxUsers?"userLimit":null}static key(e){return e.emoji.id||e.emoji.name}}e.exports=a},function(e,t,s){const i=s(3),n=s(6),r=s(14);class a{constructor(e,t,s,n){if(this.everyone=Boolean(n),t)if(t instanceof i)this.users=new i(t);else{this.users=new i;for(const s of t){let t=e.client.users.add(s);this.users.set(t.id,t)}}else this.users=new i;if(s)if(s instanceof i)this.roles=new i(s);else{this.roles=new i;for(const t of s){const s=e.channel.guild.roles.get(t);s&&this.roles.set(s.id,s)}}else this.roles=new i;this._content=e.content,this._client=e.client,this._guild=e.channel.guild,this._members=null,this._channels=null}get members(){return this._members?this._members:this._guild?(this._members=new i,this.users.forEach(e=>{const t=this._guild.member(e);t&&this._members.set(t.user.id,t)}),this._members):null}get channels(){if(this._channels)return this._channels;let e;for(this._channels=new i;null!==(e=this.constructor.CHANNELS_PATTERN.exec(this._content));){const t=this._client.channels.get(e[1]);t&&this._channels.set(t.id,t)}return this._channels}has(e,{ignoreDirect:t=!1,ignoreRoles:s=!1,ignoreEveryone:i=!1}={}){if(!i&&this.everyone)return!0;if(!s&&e instanceof r)for(const t of this.roles.values())if(e.roles.has(t.id))return!0;if(!t){const t=e.id||e;return this.users.has(t)||this.channels.has(t)||this.roles.has(t)}return!1}toJSON(){return n.flatten(this,{members:!0,channels:!0})}}a.EVERYONE_PATTERN=/@(everyone|here)/g,a.USERS_PATTERN=/<@!?(1|\d{17,19})>/g,a.ROLES_PATTERN=/<@&(\d{17,19})>/g,a.CHANNELS_PATTERN=/<#(\d{17,19})>/g,e.exports=a},function(e,t,s){const i=s(15),n=s(41);class r extends n{constructor(e,t,s){super(s),Object.defineProperty(this,"client",{value:this}),this.id=e,this.token=t}}i.applyToClass(r),e.exports=r},function(e,t,s){const i=s(6);e.exports=class{constructor(e,t){this.user=e,this._patch(t)}_patch(e){this.type=e.type,this.name=e.name,this.id=e.id,this.revoked=e.revoked,this.integrations=e.integrations}toJSON(){return i.flatten(this)}}},function(e,t,s){const i=s(26),n=s(8),r=s(26),a=s(25),{browser:o}=s(0),l=s(6),{RangeError:h}=s(5);e.exports=async function(e,t){const c=s(17),d=s(14),u=s(15),p=s(64),f=e instanceof u||e instanceof p;if(void 0!==t.nonce&&(t.nonce=parseInt(t.nonce),isNaN(t.nonce)||t.nonce<0))throw new h("MESSAGE_NONCE_TYPE");let m,{content:_}=t;if(t instanceof r&&(t=f?{embeds:[t]}:{embed:t}),t instanceof a&&(t={files:[t.file]}),_ instanceof Array||t instanceof Array){const e=_ instanceof Array?_:t,s=e.filter(e=>e instanceof a),i=e.filter(e=>e instanceof r);s.length&&(t={files:s}),i.length&&(t={embeds:i}),(i.length||s.length)&&_ instanceof Array&&(_=null,t.content="")}if(t.reply&&!(e instanceof c||e instanceof d)&&"dm"!==e.type){const s=e.client.users.resolveID(t.reply),i=`<@${t.reply instanceof d&&t.reply.nickname?"!":""}${s}>`;t.split&&(t.split.prepend=`${i}, ${t.split.prepend||""}`),_=`${i}${void 0!==t.content?`, ${t.content}`:""}`}if(_&&(t.content=l.resolveString(_),t.split&&"object"!=typeof t.split&&(t.split={}),void 0===t.code||"boolean"==typeof t.code&&!0!==t.code||(t.content=l.escapeMarkdown(t.content,!0),t.content=`\`\`\`${"boolean"!=typeof t.code&&t.code||""}\n${t.content}\n\`\`\``,t.split&&(t.split.prepend=`\`\`\`${"boolean"!=typeof t.code&&t.code||""}\n`,t.split.append="\n```")),(t.disableEveryone||void 0===t.disableEveryone&&e.client.options.disableEveryone)&&(t.content=t.content.replace(/@(everyone|here)/g,"@â€‹$1")),t.split&&(t.content=l.splitMessage(t.content,t.split))),t.embed&&t.embed.files&&(t.files?t.files=t.files.concat(t.embed.files):t.files=t.embed.files),t.embed&&f?t.embeds=[new i(t.embed)._apiTransform()]:t.embed?t.embed=new i(t.embed)._apiTransform():t.embeds&&(t.embeds=t.embeds.map(e=>new i(e)._apiTransform())),t.files){for(let e=0;e<t.files.length;e++){let s=t.files[e];("string"==typeof s||!o&&Buffer.isBuffer(s))&&(s={attachment:s}),s.name?s instanceof a&&(s=s.file):"string"==typeof s.attachment?s.name=l.basename(s.attachment):s.attachment&&s.attachment.path?s.name=l.basename(s.attachment.path):s instanceof a?s={attachment:s.file,name:l.basename(s.file)||"file.jpg"}:s.name="file.jpg",t.files[e]=s}m=await Promise.all(t.files.map(e=>n.resolveFile(e.attachment).then(t=>(e.file=t,e))))}return f&&(t.username||(t.username=this.name),t.avatarURL&&(t.avatar_url=t.avatarURL)),{data:{content:t.content,tts:t.tts,nonce:t.nonce,embed:t.embed,embeds:t.embeds,username:t.username,avatar_url:t.avatar_url},files:m}}},function(e,t,s){const i=s(11),n=s(6);e.exports=class{constructor(e,t){Object.defineProperty(this,"channel",{value:e}),t&&this._patch(t)}_patch(e){this.id=e.id,this.type=e.type,this.denied=new i(e.deny).freeze(),this.allowed=new i(e.allow).freeze()}delete(e){return this.channel.client.api.channels[this.channel.id].permissions[this.id].delete({reason:e}).then(()=>this)}toJSON(){return n.flatten(this)}}},function(e,t,s){const i=s(11),n=s(3);e.exports=function(e){return(e instanceof n||e instanceof Array)&&(e=e.map(e=>{const t=this.guild.roles.resolve(e.id);return t?(e.id=t.id,e.type="role"):(e.id=this.client.users.resolveID(e.id),e.type="member"),{allow:i.resolve(e.allowed||0),deny:i.resolve(e.denied||0),type:e.type,id:e.id}})),e}},function(e,t,s){const i=s(16),{ChannelTypes:n}=s(0),r=s(7),a=s(18),o=s(68);e.exports=class extends r{constructor(e,t){super(e.client,t,a),this.guild=e}add(e){return this.get(e.id)||i.create(this.client,e,this.guild)}create(e,{type:t,nsfw:s,bitrate:i,userLimit:r,parent:a,overwrites:l,reason:h}={}){return a&&(a=this.client.channels.resolveID(a)),this.client.api.guilds(this.guild.id).channels.post({data:{name:e,type:t?n[t.toUpperCase()]:"text",nsfw:s,bitrate:i,user_limit:r,parent_id:a,permission_overwrites:o.call(this,l)},reason:h}).then(e=>this.client.actions.ChannelCreate.handle(e).channel)}}},function(e,t,s){const i=s(7),n=s(19),{resolveColor:r}=s(6),a=s(11);e.exports=class extends i{constructor(e,t){super(e.client,t,n),this.guild=e}add(e,t){return super.add(e,t,{extras:[this.guild]})}create({data:e={},reason:t}={}){return e.color&&(e.color=r(e.color)),e.permissions&&(e.permissions=a.resolve(e.permissions)),this.guild.client.api.guilds(this.guild.id).roles.post({data:e,reason:t}).then(s=>{const{role:i}=this.client.actions.GuildRoleCreate.handle({guild_id:this.guild.id,role:s});return e.position?i.setPosition(e.position,t):i})}get highest(){return this.reduce((e,t)=>t.comparePositionTo(e)>0?t:e,this.first())}}},function(e,t,s){const i=s(7),n=s(19),r=s(3),{TypeError:a}=s(5);e.exports=class extends i{constructor(e){super(e.client,null,n),this.member=e,this.guild=e.guild}add(e,t){if(e instanceof r)return this.add(e.keyArray(),t);if(!(e instanceof Array))return this.add([e],t);if((e=e.map(e=>this.guild.roles.resolve(e))).includes(null))return Promise.reject(new a("INVALID_TYPE","roles","Array or Collection of Roles or Snowflakes",!0));const s=[...new Set(e.concat(this.array()))];return this.set(s,t)}set(e,t){return this.member.edit({roles:e},t)}remove(e,t){if(e instanceof r)return this.remove(e.keyArray(),t);if(!(e instanceof Array))return this.remove([e],t);if((e=e.map(e=>this.guild.roles.resolveID(e))).includes(null))return Promise.reject(new a("INVALID_TYPE","roles","Array or Collection of Roles or Snowflakes",!0));const s=this.keyArray().filter(t=>!e.includes(t));return this.set(s,t)}get hoist(){const e=this.filter(e=>e.hoist);return e.size?e.reduce((e,t)=>!e||t.comparePositionTo(e)>0?t:e):null}get color(){const e=this.filter(e=>e.color);return e.size?e.reduce((e,t)=>!e||t.comparePositionTo(e)>0?t:e):null}get highest(){return this.reduce((e,t)=>t.comparePositionTo(e)>0?t:e,this.first())}_patch(e){this.clear();const t=this.guild.roles.get(this.guild.id);if(t&&super.set(t.id,t),e)for(const t of e){const e=this.guild.roles.resolve(t);e&&super.set(e.id,e)}}clone(){const e=new this.constructor(this.member);return e._patch(this.keyArray()),e}}},function(e,t,s){const i=s(7),n=s(14),{Events:r,OPCodes:a}=s(0),o=s(3),{Error:l,TypeError:h}=s(5);e.exports=class extends i{constructor(e,t){super(e.client,t,n),this.guild=e}add(e,t){return super.add(e,t,{extras:[this.guild]})}resolve(e){const t=super.resolve(e);if(t)return t;const s=this.client.users.resolveID(e);return s?super.resolve(s):null}resolveID(e){const t=super.resolveID(e);if(t)return t;const s=this.client.users.resolveID(e);return this.has(s)?s:null}fetch(e){if(!e)return this._fetchMany();const t=this.client.users.resolveID(e);return t?this._fetchSingle({user:t,cache:!0}):e.user&&(e.user=this.client.users.resolveID(e.user),e.user)?this._fetchSingle(e):this._fetchMany(e)}prune({days:e=7,dry:t=!1,reason:s}={}){if("number"!=typeof e)throw new h("PRUNE_DAYS_TYPE");return this.client.api.guilds(this.guild.id).prune[t?"get":"post"]({query:{days:e},reason:s}).then(e=>e.pruned)}ban(e,t={days:0}){t.days&&(t["delete-message-days"]=t.days);const s=this.client.users.resolveID(e);return s?this.client.api.guilds(this.guild.id).bans[s].put({query:t}).then(()=>{if(e instanceof n)return e;const t=this.client.users.resolve(s);return t?this.resolve(t)||t:s}):Promise.reject(new l("BAN_RESOLVE_ID",!0))}unban(e,t){const s=this.client.users.resolveID(e);if(!s)throw new l("BAN_RESOLVE_ID");return this.client.api.guilds(this.guild.id).bans[s].delete({reason:t}).then(()=>this.client.users.resolve(e))}_fetchSingle({user:e,cache:t}){const s=this.get(e);return s?Promise.resolve(s):this.client.api.guilds(this.guild.id).members(e).get().then(e=>this.add(e,t))}_fetchMany({query:e="",limit:t=0}={}){return new Promise((s,i)=>{if(this.guild.memberCount===this.size)return void s(e||t?new o:this);this.guild.client.ws.send({op:a.REQUEST_GUILD_MEMBERS,d:{guild_id:this.guild.id,query:e,limit:t}});const n=new o,h=(i,a)=>{if(a.id===this.guild.id){for(const s of i.values())(e||t)&&n.set(s.id,s);(this.guild.memberCount<=this.size||(e||t)&&i.size<1e3||t&&n.size>=t)&&(this.guild.client.removeListener(r.GUILD_MEMBERS_CHUNK,h),s(e||t?n:this))}};this.guild.client.on(r.GUILD_MEMBERS_CHUNK,h),this.guild.client.setTimeout(()=>{this.guild.client.removeListener(r.GUILD_MEMBERS_CHUNK,h),i(new l("GUILD_MEMBERS_TIMEOUT"))},12e4)})}}},function(e,t){},function(e,t,s){const i=s(3),n=s(10),r=s(15),a=s(6),o={ALL:"ALL",GUILD:"GUILD",CHANNEL:"CHANNEL",USER:"USER",ROLE:"ROLE",INVITE:"INVITE",WEBHOOK:"WEBHOOK",EMOJI:"EMOJI",MESSAGE:"MESSAGE",UNKNOWN:"UNKNOWN"},l={ALL:null,GUILD_UPDATE:1,CHANNEL_CREATE:10,CHANNEL_UPDATE:11,CHANNEL_DELETE:12,CHANNEL_OVERWRITE_CREATE:13,CHANNEL_OVERWRITE_UPDATE:14,CHANNEL_OVERWRITE_DELETE:15,MEMBER_KICK:20,MEMBER_PRUNE:21,MEMBER_BAN_ADD:22,MEMBER_BAN_REMOVE:23,MEMBER_UPDATE:24,MEMBER_ROLE_UPDATE:25,ROLE_CREATE:30,ROLE_UPDATE:31,ROLE_DELETE:32,INVITE_CREATE:40,INVITE_UPDATE:41,INVITE_DELETE:42,WEBHOOK_CREATE:50,WEBHOOK_UPDATE:51,WEBHOOK_DELETE:52,EMOJI_CREATE:60,EMOJI_UPDATE:61,EMOJI_DELETE:62,MESSAGE_DELETE:72};class h{constructor(e,t){if(t.users)for(const s of t.users)e.client.users.add(s);if(this.webhooks=new i,t.webhooks)for(const s of t.webhooks)this.webhooks.set(s.id,new r(e.client,s));this.entries=new i;for(const s of t.audit_log_entries){const t=new c(this,e,s);this.entries.set(t.id,t)}}static build(...e){const t=new h(...e);return Promise.all(t.entries.map(e=>e.target)).then(()=>t)}static targetType(e){return e<10?o.GUILD:e<20?o.CHANNEL:e<30?o.USER:e<40?o.ROLE:e<50?o.INVITE:e<60?o.WEBHOOK:e<70?o.EMOJI:e<80?o.MESSAGE:o.UNKNOWN}static actionType(e){return[l.CHANNEL_CREATE,l.CHANNEL_OVERWRITE_CREATE,l.MEMBER_BAN_REMOVE,l.ROLE_CREATE,l.INVITE_CREATE,l.WEBHOOK_CREATE,l.EMOJI_CREATE].includes(e)?"CREATE":[l.CHANNEL_DELETE,l.CHANNEL_OVERWRITE_DELETE,l.MEMBER_KICK,l.MEMBER_PRUNE,l.MEMBER_BAN_ADD,l.ROLE_DELETE,l.INVITE_DELETE,l.WEBHOOK_DELETE,l.EMOJI_DELETE,l.MESSAGE_DELETE].includes(e)?"DELETE":[l.GUILD_UPDATE,l.CHANNEL_UPDATE,l.CHANNEL_OVERWRITE_UPDATE,l.MEMBER_UPDATE,l.MEMBER_ROLE_UPDATE,l.ROLE_UPDATE,l.INVITE_UPDATE,l.WEBHOOK_UPDATE,l.EMOJI_UPDATE].includes(e)?"UPDATE":"ALL"}toJSON(){return a.flatten(this)}}class c{constructor(e,t,s){const i=h.targetType(s.action_type);if(this.targetType=i,this.actionType=h.actionType(s.action_type),this.action=Object.keys(l).find(e=>l[e]===s.action_type),this.reason=s.reason||null,this.executor=t.client.users.get(s.user_id),this.changes=s.changes?s.changes.map(e=>({key:e.key,old:e.old_value,new:e.new_value})):null,this.id=s.id,this.extra=null,s.options)if(s.action_type===l.MEMBER_PRUNE)this.extra={removed:s.options.members_removed,days:s.options.delete_member_days};else if(s.action_type===l.MESSAGE_DELETE)this.extra={count:s.options.count,channel:t.channels.get(s.options.channel_id)};else switch(s.options.type){case"member":this.extra=t.members.get(s.options.id),this.extra||(this.extra={id:s.options.id});break;case"role":this.extra=t.roles.get(s.options.id),this.extra||(this.extra={id:s.options.id,name:s.options.role_name})}if(i===o.UNKNOWN)this.target=this.changes.reduce((e,t)=>(e[t.key]=t.new||t.old,e),{}),this.target.id=s.target_id;else if([o.USER,o.GUILD].includes(i))this.target=t.client[`${i.toLowerCase()}s`].get(s.target_id);else if(i===o.WEBHOOK)this.target=e.webhooks.get(s.target_id)||new r(t.client,this.changes.reduce((e,t)=>(e[t.key]=t.new||t.old,e),{id:s.target_id,guild_id:t.id}));else if(i===o.INVITE)if(t.me.permissions.has("MANAGE_GUILD")){const e=this.changes.find(e=>"code"===e.key);this.target=t.fetchInvites().then(t=>(this.target=t.find(t=>t.code===(e.new||e.old)),this.target))}else this.target=this.changes.reduce((e,t)=>(e[t.key]=t.new||t.old,e),{});else i===o.MESSAGE?this.target=t.client.users.get(s.target_id):this.target=t[`${i.toLowerCase()}s`].get(s.target_id)}get createdTimestamp(){return n.deconstruct(this.id).timestamp}get createdAt(){return new Date(this.createdTimestamp)}toJSON(){return a.flatten(this,{createdTimestamp:!0})}}h.Actions=l,h.Targets=o,h.Entry=c,e.exports=h},function(e,t,s){const i=s(39),{Events:n}=s(0);e.exports=class extends i{constructor(e,t,s={}){super(e.client,t,s),this.channel=e,this.received=0;const i=(e=>{for(const t of e.values())this.handleDispose(t)}).bind(this);this.client.on(n.MESSAGE_CREATE,this.handleCollect),this.client.on(n.MESSAGE_DELETE,this.handleDispose),this.client.on(n.MESSAGE_BULK_DELETE,i),this.once("end",()=>{this.client.removeListener(n.MESSAGE_CREATE,this.handleCollect),this.client.removeListener(n.MESSAGE_DELETE,this.handleDispose),this.client.removeListener(n.MESSAGE_BULK_DELETE,i)})}collect(e){return e.channel.id!==this.channel.id?null:(this.received++,e.id)}dispose(e){return e.channel.id===this.channel.id?e.id:null}endReason(){return this.options.max&&this.collected.size>=this.options.max?"limit":this.options.maxProcessed&&this.received===this.options.maxProcessed?"processedLimit":null}}},function(e,t,s){const i=s(16),n=s(22),r=s(20);class a extends i{constructor(e,t){super(e,t),this.messages=new r(this),this._typing=new Map}_patch(e){super._patch(e),this.recipient=this.client.users.add(e.recipients[0]),this.lastMessageID=e.last_message_id}toString(){return this.recipient.toString()}get lastMessage(){}send(){}search(){}startTyping(){}stopTyping(){}get typing(){}get typingCount(){}createMessageCollector(){}awaitMessages(){}acknowledge(){}_cacheMessage(){}}n.applyToClass(a,!0,["bulkDelete"]),e.exports=a},function(e,t,s){const i=s(7),n=s(3),{TypeError:r}=s(5);e.exports=class extends i{constructor(e){super(e.client,null,s(23)),this.emoji=e,this.guild=e.guild}add(e){if(e instanceof n)return this.add(e.keyArray());if(!(e instanceof Array))return this.add([e]);if((e=e.map(e=>this.guild.roles.resolve(e))).includes(null))return Promise.reject(new r("INVALID_TYPE","roles","Array or Collection of Roles or Snowflakes",!0));const t=[...new Set(e.concat(this.array()))];return this.set(t)}remove(e){if(e instanceof n)return this.remove(e.keyArray());if(!(e instanceof Array))return this.remove([e]);if((e=e.map(e=>this.guild.roles.resolveID(e))).includes(null))return Promise.reject(new r("INVALID_TYPE","roles","Array or Collection of Roles or Snowflakes",!0));const t=this.keyArray().filter(t=>!e.includes(t));return this.set(t)}set(e){return this.emoji.edit({roles:e})}clone(){const e=new this.constructor(this.emoji);return e._patch(this.keyArray()),e}_patch(e){this.clear();for(let t of e)(t=this.guild.roles.resolve(t))&&super.set(t.id,t)}}},function(e,t,s){const i=s(29),n=s(3),r=s(56),a=s(32),o=s(6),l=s(8),h=s(21);e.exports=class extends(i.get("User")){_patch(e){if(super._patch(e),this.verified=e.verified,this.email=e.email,this._typing=new Map,this.friends=new n,this.blocked=new n,this.notes=new n,this.premium="boolean"==typeof e.premium?e.premium:null,this.mfaEnabled="boolean"==typeof e.mfa_enabled?e.mfa_enabled:null,this.mobile="boolean"==typeof e.mobile?e.mobile:null,this.settings=e.user_settings?new r(this,e.user_settings):null,this.guildSettings=new n,e.user_guild_settings)for(const t of e.user_guild_settings)this.guildSettings.set(t.guild_id,new a(this.client,t));e.token&&(this.client.token=e.token)}get presence(){return this.client.presences.clientPresence}edit(e,t){return this.bot||("object"!=typeof t?e.password=t:(e.code=t.mfaCode,e.password=t.password)),this.client.api.users("@me").patch({data:e}).then(e=>(this.client.token=e.token,this.client.actions.UserUpdate.handle(e).updated))}setUsername(e,t){return this.edit({username:e},t)}setEmail(e,t){return this.edit({email:e},t)}setPassword(e,t){return this.edit({new_password:e},{password:t.oldPassword,mfaCode:t.mfaCode})}async setAvatar(e){return this.edit({avatar:await l.resolveImage(e)})}setPresence(e){return this.client.presences.setClientPresence(e)}setStatus(e){return this.setPresence({status:e})}setActivity(e,{url:t,type:s}={}){return e?this.setPresence({activity:{name:e,type:s,url:t}}):this.setPresence({activity:null})}setAFK(e){return this.setPresence({afk:e})}fetchMentions(e={}){return e.guild instanceof h&&(e.guild=e.guild.id),o.mergeDefault({limit:25,roles:!0,everyone:!0,guild:null},e),this.client.api.users("@me").mentions.get({query:e}).then(e=>e.map(e=>this.client.channels.get(e.channel_id).messages.add(e,!1)))}createGroupDM(e){const t=this.bot?{access_tokens:e.map(e=>e.accessToken),nicks:e.reduce((e,t)=>(t.nick&&(e[t.user?t.user.id:t.id]=t.nick),e),{})}:{recipients:e.map(e=>this.client.users.resolveID(e.user||e.id))};return this.client.api.users("@me").channels.post({data:t}).then(e=>this.client.channels.add(e))}toJSON(){return super.toJSON({friends:!1,blocked:!1,notes:!1,settings:!1,guildSettings:!1})}}},function(e,t){e.exports=class extends Error{constructor(e,t){super();const s=this.constructor.flattenErrors(t.errors||t).join("\n");this.name="DiscordAPIError",this.message=t.message&&s?`${t.message}\n${s}`:t.message||s,this.path=e,this.code=t.code}static flattenErrors(e,t=""){let s=[];for(const[i,n]of Object.entries(e)){if("message"===i)continue;const e=t?isNaN(i)?`${t}.${i}`:`${t}[${i}]`:i;n._errors?s.push(`${e}: ${n._errors.map(e=>e.message).join(" ")}`):n.code||n.message?s.push(`${n.code?`${n.code}: `:""}${n.message}`.trim()):"string"==typeof n?s.push(n):s=s.concat(this.flattenErrors(n,e))}return s}}},function(e,t){const s=Symbol("code"),i=new Map;function n(e){return class t extends e{constructor(e,...n){super(function(e,t){if("string"!=typeof e)throw new Error("Error message key must be a string");const s=i.get(e);if(!s)throw new Error(`An invalid error message key was used: ${e}.`);return"function"==typeof s?s(...t):void 0===t||0===t.length?s:(t.unshift(s),String(...t))}(e,n)),this[s]=e,Error.captureStackTrace&&Error.captureStackTrace(this,t)}get name(){return`${super.name} [${this[s]}]`}get code(){return this[s]}}}e.exports={register:function(e,t){i.set(e,"function"==typeof t?t:String(t))},Error:n(Error),TypeError:n(TypeError),RangeError:n(RangeError)}},function(e,t){e.exports={version:"12.0.0-dev",homepage:"https://github.com/discordjs/discord.js#readme"}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,s){const i=s(4);e.exports=class extends i{handle(e){const t=this.client.guilds.get(e.guild_id);if(t)for(const s of e.channels){const e=t.channels.get(s.id);e&&(e.rawPosition=s.position)}return{guild:t}}}},function(e,t,s){const i=s(4);e.exports=class extends i{handle(e){const t=this.client.guilds.get(e.guild_id);if(t)for(const s of e.roles){const e=t.roles.get(s.id);e&&(e.rawPosition=s.position)}return{guild:t}}}},function(e,t,s){const i=s(4);e.exports=class extends i{handle(e){const t=this.client.guilds.get(e.guild_id);if(!t||!t.emojis)return;const s=new Map(t.emojis);for(const i of e.emojis){const e=t.emojis.get(i.id);e?(s.delete(i.id),e.equals(i)||this.client.actions.GuildEmojiUpdate.handle(e,i)):this.client.actions.GuildEmojiCreate.handle(t,i)}for(const e of s.values())this.client.actions.GuildEmojiDelete.handle(e)}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e,t){const s=e._update(t);return this.client.emit(n.GUILD_EMOJI_UPDATE,s,e),{emoji:e}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){return e.guild.emojis.remove(e.id),this.client.emit(n.GUILD_EMOJI_DELETE,e),{emoji:e}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e,t){const s=e.emojis.add(t);return this.client.emit(n.GUILD_EMOJI_CREATE,s),{emoji:s}}}},function(e,t,s){const i=s(4);e.exports=class extends i{handle(e){const t=this.client.guilds.get(e.id);if(t){if(e.presences)for(const s of e.presences)t.presences.add(s);if(e.members)for(const s of e.members){const e=t.members.get(s.user.id);e?e._patch(s):t.members.add(s,!1)}"large"in e&&(t.large=e.large)}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.user.notes.get(e.id),i=e.note.length?e.note:null;return t.user.notes.set(e.id,i),t.emit(n.USER_NOTE_UPDATE,e.id,s,i),{old:s,updated:i}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client;if(t.user){if(t.user.equals(e))return{old:t.user,updated:t.user};const s=t.user._update(e);return t.emit(n.USER_UPDATE,s,t.user),{old:s,updated:t.user}}return{old:null,updated:null}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.guilds.get(e.guild_id);if(s){let i=null;const r=s.roles.get(e.role.id);return r&&(i=r._update(e.role),t.emit(n.GUILD_ROLE_UPDATE,i,r)),{old:i,updated:r}}return{old:null,updated:null}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.guilds.get(e.guild_id);let i;return s&&(i=s.roles.get(e.role_id))&&(s.roles.remove(e.role_id),t.emit(n.GUILD_ROLE_DELETE,i)),{role:i}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.guilds.get(e.guild_id);let i;if(s){const r=s.roles.has(e.role.id);i=s.roles.add(e.role),r||t.emit(n.GUILD_ROLE_CREATE,i)}return{role:i}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.guilds.get(e.guild_id),i=t.users.add(e.user);s&&i&&t.emit(n.GUILD_BAN_REMOVE,s,i)}}},function(e,t,s){const i=s(4),{Events:n,Status:r}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.guilds.get(e.guild_id);let i=null;return s&&(i=s.members.get(e.user.id),s.memberCount--,i&&(s.voiceStates.delete(i.id),s.members.remove(i.id),t.status===r.READY&&t.emit(n.GUILD_MEMBER_REMOVE,i))),{guild:s,member:i}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.guilds.get(e.id);if(s){const i=s._update(e);return t.emit(n.GUILD_UPDATE,i,s),{old:i,updated:s}}return{old:null,updated:null}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{constructor(e){super(e),this.deleted=new Map}handle(e){const t=this.client;let s=t.guilds.get(e.id);if(s){for(const e of s.channels.values())"text"===e.type&&e.stopTyping(!0);if(s.available&&e.unavailable)return s.available=!1,t.emit(n.GUILD_UNAVAILABLE,s),{guild:null};for(const e of s.channels.values())this.client.channels.remove(e.id);s.voiceConnection&&s.voiceConnection.disconnect(),t.guilds.remove(s.id),t.emit(n.GUILD_DELETE,s),this.deleted.set(s.id,s),this.scheduleForDeletion(s.id)}else s=this.deleted.get(e.id)||null;return{guild:s}}scheduleForDeletion(e){this.client.setTimeout(()=>this.deleted.delete(e),this.client.options.restWsBridgeTimeout)}}},function(e,t,s){const i=s(4);e.exports=class extends i{handle(e){const t=this.client.channels.get(e.id);return t?{old:t._update(e),updated:t}:{}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{constructor(e){super(e),this.deleted=new Map}handle(e){const t=this.client;let s=t.channels.get(e.id);return s&&(t.channels.remove(s.id),t.emit(n.CHANNEL_DELETE,s)),{channel:s}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.channels.has(e.id),i=t.channels.add(e);return!s&&i&&t.emit(n.CHANNEL_CREATE,i),{channel:i}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client.channels.get(e.channel_id);if(!t||"voice"===t.type)return!1;const s=t.messages.get(e.message_id);return!!s&&(s.reactions.clear(),this.client.emit(n.MESSAGE_REACTION_REMOVE_ALL,s),{message:s})}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client.users.get(e.user_id);if(!t)return!1;const s=this.client.channels.get(e.channel_id);if(!s||"voice"===s.type)return!1;const i=s.messages.get(e.message_id);if(!i)return!1;if(!e.emoji)return!1;const r=e.emoji.id||decodeURIComponent(e.emoji.name),a=i.reactions.get(r);return!!a&&(a._remove(t),this.client.emit(n.MESSAGE_REACTION_REMOVE,a,t),{message:i,reaction:a,user:t})}}},function(e,t,s){const i=s(4);e.exports=class extends i{handle(e){const t=e.user||this.client.users.get(e.user_id);if(!t)return!1;const s=e.channel||this.client.channels.get(e.channel_id);if(!s||"voice"===s.type)return!1;const i=e.message||s.messages.get(e.message_id);if(!i)return!1;if(!e.emoji)return!1;const n=i.reactions.add({emoji:e.emoji,count:0,me:t.id===this.client.user.id});return n._add(t),{message:i,reaction:n,user:t}}}},function(e,t,s){const i=s(4);e.exports=class extends i{handle(e){const t=this.client.channels.get(e.channel_id);if(t){const s=t.messages.get(e.id);if(s)return s.patch(e),{old:s._edits[0],updated:s}}return{}}}},function(e,t,s){const i=s(4),n=s(3),{Events:r}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.channels.get(e.channel_id);if(s){const i=e.ids,a=new n;for(const e of i){const t=s.messages.get(e);t&&(a.set(t.id,t),s.messages.delete(e))}return a.size>0&&t.emit(r.MESSAGE_BULK_DELETE,a),{messages:a}}return{}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.channels.get(e.channel_id);let i;return s&&(i=s.messages.get(e.id))&&(s.messages.delete(i.id),t.emit(n.MESSAGE_DELETE,i)),{message:i}}}},function(e,t,s){const i=s(4),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.client,s=t.channels.get(e.channel_id);if(s){const i=s.messages.get(e.id);if(i)return{message:i};const r=s.messages.add(e),a=r.author,o=s.guild?s.guild.member(a):null;return s.lastMessageID=e.id,a&&(a.lastMessageID=e.id,a.lastMessageChannelID=s.id),o&&(o.lastMessageID=e.id,o.lastMessageChannelID=s.id),t.emit(n.MESSAGE_CREATE,r),{message:r}}return{}}}},function(e,t,s){e.exports=class{constructor(e){this.client=e,this.register(s(112)),this.register(s(111)),this.register(s(110)),this.register(s(109)),this.register(s(108)),this.register(s(107)),this.register(s(106)),this.register(s(105)),this.register(s(104)),this.register(s(103)),this.register(s(102)),this.register(s(101)),this.register(s(100)),this.register(s(99)),this.register(s(98)),this.register(s(97)),this.register(s(96)),this.register(s(95)),this.register(s(94)),this.register(s(93)),this.register(s(92)),this.register(s(91)),this.register(s(90)),this.register(s(89)),this.register(s(88)),this.register(s(87))}register(e){this[e.name.replace(/Action$/,"")]=new e(this.client)}}},function(e,t,s){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,s){"use strict";var i=s(12),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,s,l,h,c,d,u){var p,f,m,_,g,E,b,v,w,y=u.bits,A=0,I=0,T=0,S=0,D=0,N=0,C=0,O=0,k=0,R=0,L=null,x=0,M=new i.Buf16(16),U=new i.Buf16(16),P=null,G=0;for(A=0;A<=15;A++)M[A]=0;for(I=0;I<l;I++)M[t[s+I]]++;for(D=y,S=15;S>=1&&0===M[S];S--);if(D>S&&(D=S),0===S)return h[c++]=20971520,h[c++]=20971520,u.bits=1,0;for(T=1;T<S&&0===M[T];T++);for(D<T&&(D=T),O=1,A=1;A<=15;A++)if(O<<=1,(O-=M[A])<0)return-1;if(O>0&&(0===e||1!==S))return-1;for(U[1]=0,A=1;A<15;A++)U[A+1]=U[A]+M[A];for(I=0;I<l;I++)0!==t[s+I]&&(d[U[t[s+I]]++]=I);if(0===e?(L=P=d,E=19):1===e?(L=n,x-=257,P=r,G-=257,E=256):(L=a,P=o,E=-1),R=0,I=0,A=T,g=c,N=D,C=0,m=-1,_=(k=1<<D)-1,1===e&&k>852||2===e&&k>592)return 1;for(;;){b=A-C,d[I]<E?(v=0,w=d[I]):d[I]>E?(v=P[G+d[I]],w=L[x+d[I]]):(v=96,w=0),p=1<<A-C,T=f=1<<N;do{h[g+(R>>C)+(f-=p)]=b<<24|v<<16|w|0}while(0!==f);for(p=1<<A-1;R&p;)p>>=1;if(0!==p?(R&=p-1,R+=p):R=0,I++,0==--M[A]){if(A===S)break;A=t[s+d[I]]}if(A>D&&(R&_)!==m){for(0===C&&(C=D),g+=T,O=1<<(N=A-C);N+C<S&&!((O-=M[N+C])<=0);)N++,O<<=1;if(k+=1<<N,1===e&&k>852||2===e&&k>592)return 1;h[m=R&_]=D<<24|N<<16|g-c|0}}return 0!==R&&(h[g+R]=A-C<<24|64<<16|0),u.bits=D,0}},function(e,t,s){"use strict";e.exports=function(e,t){var s,i,n,r,a,o,l,h,c,d,u,p,f,m,_,g,E,b,v,w,y,A,I,T,S;s=e.state,i=e.next_in,T=e.input,n=i+(e.avail_in-5),r=e.next_out,S=e.output,a=r-(t-e.avail_out),o=r+(e.avail_out-257),l=s.dmax,h=s.wsize,c=s.whave,d=s.wnext,u=s.window,p=s.hold,f=s.bits,m=s.lencode,_=s.distcode,g=(1<<s.lenbits)-1,E=(1<<s.distbits)-1;e:do{f<15&&(p+=T[i++]<<f,f+=8,p+=T[i++]<<f,f+=8),b=m[p&g];t:for(;;){if(p>>>=v=b>>>24,f-=v,0==(v=b>>>16&255))S[r++]=65535&b;else{if(!(16&v)){if(0==(64&v)){b=m[(65535&b)+(p&(1<<v)-1)];continue t}if(32&v){s.mode=12;break e}e.msg="invalid literal/length code",s.mode=30;break e}w=65535&b,(v&=15)&&(f<v&&(p+=T[i++]<<f,f+=8),w+=p&(1<<v)-1,p>>>=v,f-=v),f<15&&(p+=T[i++]<<f,f+=8,p+=T[i++]<<f,f+=8),b=_[p&E];s:for(;;){if(p>>>=v=b>>>24,f-=v,!(16&(v=b>>>16&255))){if(0==(64&v)){b=_[(65535&b)+(p&(1<<v)-1)];continue s}e.msg="invalid distance code",s.mode=30;break e}if(y=65535&b,f<(v&=15)&&(p+=T[i++]<<f,(f+=8)<v&&(p+=T[i++]<<f,f+=8)),(y+=p&(1<<v)-1)>l){e.msg="invalid distance too far back",s.mode=30;break e}if(p>>>=v,f-=v,y>(v=r-a)){if((v=y-v)>c&&s.sane){e.msg="invalid distance too far back",s.mode=30;break e}if(A=0,I=u,0===d){if(A+=h-v,v<w){w-=v;do{S[r++]=u[A++]}while(--v);A=r-y,I=S}}else if(d<v){if(A+=h+d-v,(v-=d)<w){w-=v;do{S[r++]=u[A++]}while(--v);if(A=0,d<w){w-=v=d;do{S[r++]=u[A++]}while(--v);A=r-y,I=S}}}else if(A+=d-v,v<w){w-=v;do{S[r++]=u[A++]}while(--v);A=r-y,I=S}for(;w>2;)S[r++]=I[A++],S[r++]=I[A++],S[r++]=I[A++],w-=3;w&&(S[r++]=I[A++],w>1&&(S[r++]=I[A++]))}else{A=r-y;do{S[r++]=S[A++],S[r++]=S[A++],S[r++]=S[A++],w-=3}while(w>2);w&&(S[r++]=S[A++],w>1&&(S[r++]=S[A++]))}break}}break}}while(i<n&&r<o);i-=w=f>>3,p&=(1<<(f-=w<<3))-1,e.next_in=i,e.next_out=r,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=r<o?o-r+257:257-(r-o),s.hold=p,s.bits=f}},function(e,t,s){"use strict";var i=s(12),n=s(52),r=s(51),a=s(116),o=s(115),l=1,h=2,c=0,d=-2,u=1,p=12,f=30,m=852,_=592;function g(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function E(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=u,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(m),t.distcode=t.distdyn=new i.Buf32(_),t.sane=1,t.back=-1,c):d}function b(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,E(e)):d}function v(e,t){var s,i;return e&&e.state?(i=e.state,t<0?(s=0,t=-t):(s=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?d:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=s,i.wbits=t,b(e))):d}function w(e,t){var s,n;return e?(n=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},e.state=n,n.window=null,(s=v(e,t))!==c&&(e.state=null),s):d}var y,A,I=!0;function T(e){if(I){var t;for(y=new i.Buf32(512),A=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(l,e.lens,0,288,y,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(h,e.lens,0,32,A,0,e.work,{bits:5}),I=!1}e.lencode=y,e.lenbits=9,e.distcode=A,e.distbits=5}function S(e,t,s,n){var r,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new i.Buf8(a.wsize)),n>=a.wsize?(i.arraySet(a.window,t,s-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((r=a.wsize-a.wnext)>n&&(r=n),i.arraySet(a.window,t,s-n,r,a.wnext),(n-=r)?(i.arraySet(a.window,t,s-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}t.inflateReset=b,t.inflateReset2=v,t.inflateResetKeep=E,t.inflateInit=function(e){return w(e,15)},t.inflateInit2=w,t.inflate=function(e,t){var s,m,_,E,b,v,w,y,A,I,D,N,C,O,k,R,L,x,M,U,P,G,B,j,z=0,H=new i.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return d;(s=e.state).mode===p&&(s.mode=13),b=e.next_out,_=e.output,w=e.avail_out,E=e.next_in,m=e.input,v=e.avail_in,y=s.hold,A=s.bits,I=v,D=w,G=c;e:for(;;)switch(s.mode){case u:if(0===s.wrap){s.mode=13;break}for(;A<16;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if(2&s.wrap&&35615===y){s.check=0,H[0]=255&y,H[1]=y>>>8&255,s.check=r(s.check,H,2,0),y=0,A=0,s.mode=2;break}if(s.flags=0,s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",s.mode=f;break}if(8!=(15&y)){e.msg="unknown compression method",s.mode=f;break}if(A-=4,P=8+(15&(y>>>=4)),0===s.wbits)s.wbits=P;else if(P>s.wbits){e.msg="invalid window size",s.mode=f;break}s.dmax=1<<P,e.adler=s.check=1,s.mode=512&y?10:p,y=0,A=0;break;case 2:for(;A<16;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if(s.flags=y,8!=(255&s.flags)){e.msg="unknown compression method",s.mode=f;break}if(57344&s.flags){e.msg="unknown header flags set",s.mode=f;break}s.head&&(s.head.text=y>>8&1),512&s.flags&&(H[0]=255&y,H[1]=y>>>8&255,s.check=r(s.check,H,2,0)),y=0,A=0,s.mode=3;case 3:for(;A<32;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}s.head&&(s.head.time=y),512&s.flags&&(H[0]=255&y,H[1]=y>>>8&255,H[2]=y>>>16&255,H[3]=y>>>24&255,s.check=r(s.check,H,4,0)),y=0,A=0,s.mode=4;case 4:for(;A<16;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}s.head&&(s.head.xflags=255&y,s.head.os=y>>8),512&s.flags&&(H[0]=255&y,H[1]=y>>>8&255,s.check=r(s.check,H,2,0)),y=0,A=0,s.mode=5;case 5:if(1024&s.flags){for(;A<16;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}s.length=y,s.head&&(s.head.extra_len=y),512&s.flags&&(H[0]=255&y,H[1]=y>>>8&255,s.check=r(s.check,H,2,0)),y=0,A=0}else s.head&&(s.head.extra=null);s.mode=6;case 6:if(1024&s.flags&&((N=s.length)>v&&(N=v),N&&(s.head&&(P=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Array(s.head.extra_len)),i.arraySet(s.head.extra,m,E,N,P)),512&s.flags&&(s.check=r(s.check,m,N,E)),v-=N,E+=N,s.length-=N),s.length))break e;s.length=0,s.mode=7;case 7:if(2048&s.flags){if(0===v)break e;N=0;do{P=m[E+N++],s.head&&P&&s.length<65536&&(s.head.name+=String.fromCharCode(P))}while(P&&N<v);if(512&s.flags&&(s.check=r(s.check,m,N,E)),v-=N,E+=N,P)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=8;case 8:if(4096&s.flags){if(0===v)break e;N=0;do{P=m[E+N++],s.head&&P&&s.length<65536&&(s.head.comment+=String.fromCharCode(P))}while(P&&N<v);if(512&s.flags&&(s.check=r(s.check,m,N,E)),v-=N,E+=N,P)break e}else s.head&&(s.head.comment=null);s.mode=9;case 9:if(512&s.flags){for(;A<16;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if(y!==(65535&s.check)){e.msg="header crc mismatch",s.mode=f;break}y=0,A=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),e.adler=s.check=0,s.mode=p;break;case 10:for(;A<32;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}e.adler=s.check=g(y),y=0,A=0,s.mode=11;case 11:if(0===s.havedict)return e.next_out=b,e.avail_out=w,e.next_in=E,e.avail_in=v,s.hold=y,s.bits=A,2;e.adler=s.check=1,s.mode=p;case p:if(5===t||6===t)break e;case 13:if(s.last){y>>>=7&A,A-=7&A,s.mode=27;break}for(;A<3;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}switch(s.last=1&y,A-=1,3&(y>>>=1)){case 0:s.mode=14;break;case 1:if(T(s),s.mode=20,6===t){y>>>=2,A-=2;break e}break;case 2:s.mode=17;break;case 3:e.msg="invalid block type",s.mode=f}y>>>=2,A-=2;break;case 14:for(y>>>=7&A,A-=7&A;A<32;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",s.mode=f;break}if(s.length=65535&y,y=0,A=0,s.mode=15,6===t)break e;case 15:s.mode=16;case 16:if(N=s.length){if(N>v&&(N=v),N>w&&(N=w),0===N)break e;i.arraySet(_,m,E,N,b),v-=N,E+=N,w-=N,b+=N,s.length-=N;break}s.mode=p;break;case 17:for(;A<14;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if(s.nlen=257+(31&y),y>>>=5,A-=5,s.ndist=1+(31&y),y>>>=5,A-=5,s.ncode=4+(15&y),y>>>=4,A-=4,s.nlen>286||s.ndist>30){e.msg="too many length or distance symbols",s.mode=f;break}s.have=0,s.mode=18;case 18:for(;s.have<s.ncode;){for(;A<3;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}s.lens[V[s.have++]]=7&y,y>>>=3,A-=3}for(;s.have<19;)s.lens[V[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,B={bits:s.lenbits},G=o(0,s.lens,0,19,s.lencode,0,s.work,B),s.lenbits=B.bits,G){e.msg="invalid code lengths set",s.mode=f;break}s.have=0,s.mode=19;case 19:for(;s.have<s.nlen+s.ndist;){for(;R=(z=s.lencode[y&(1<<s.lenbits)-1])>>>16&255,L=65535&z,!((k=z>>>24)<=A);){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if(L<16)y>>>=k,A-=k,s.lens[s.have++]=L;else{if(16===L){for(j=k+2;A<j;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if(y>>>=k,A-=k,0===s.have){e.msg="invalid bit length repeat",s.mode=f;break}P=s.lens[s.have-1],N=3+(3&y),y>>>=2,A-=2}else if(17===L){for(j=k+3;A<j;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}A-=k,P=0,N=3+(7&(y>>>=k)),y>>>=3,A-=3}else{for(j=k+7;A<j;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}A-=k,P=0,N=11+(127&(y>>>=k)),y>>>=7,A-=7}if(s.have+N>s.nlen+s.ndist){e.msg="invalid bit length repeat",s.mode=f;break}for(;N--;)s.lens[s.have++]=P}}if(s.mode===f)break;if(0===s.lens[256]){e.msg="invalid code -- missing end-of-block",s.mode=f;break}if(s.lenbits=9,B={bits:s.lenbits},G=o(l,s.lens,0,s.nlen,s.lencode,0,s.work,B),s.lenbits=B.bits,G){e.msg="invalid literal/lengths set",s.mode=f;break}if(s.distbits=6,s.distcode=s.distdyn,B={bits:s.distbits},G=o(h,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,B),s.distbits=B.bits,G){e.msg="invalid distances set",s.mode=f;break}if(s.mode=20,6===t)break e;case 20:s.mode=21;case 21:if(v>=6&&w>=258){e.next_out=b,e.avail_out=w,e.next_in=E,e.avail_in=v,s.hold=y,s.bits=A,a(e,D),b=e.next_out,_=e.output,w=e.avail_out,E=e.next_in,m=e.input,v=e.avail_in,y=s.hold,A=s.bits,s.mode===p&&(s.back=-1);break}for(s.back=0;R=(z=s.lencode[y&(1<<s.lenbits)-1])>>>16&255,L=65535&z,!((k=z>>>24)<=A);){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if(R&&0==(240&R)){for(x=k,M=R,U=L;R=(z=s.lencode[U+((y&(1<<x+M)-1)>>x)])>>>16&255,L=65535&z,!(x+(k=z>>>24)<=A);){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}y>>>=x,A-=x,s.back+=x}if(y>>>=k,A-=k,s.back+=k,s.length=L,0===R){s.mode=26;break}if(32&R){s.back=-1,s.mode=p;break}if(64&R){e.msg="invalid literal/length code",s.mode=f;break}s.extra=15&R,s.mode=22;case 22:if(s.extra){for(j=s.extra;A<j;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}s.length+=y&(1<<s.extra)-1,y>>>=s.extra,A-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=23;case 23:for(;R=(z=s.distcode[y&(1<<s.distbits)-1])>>>16&255,L=65535&z,!((k=z>>>24)<=A);){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if(0==(240&R)){for(x=k,M=R,U=L;R=(z=s.distcode[U+((y&(1<<x+M)-1)>>x)])>>>16&255,L=65535&z,!(x+(k=z>>>24)<=A);){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}y>>>=x,A-=x,s.back+=x}if(y>>>=k,A-=k,s.back+=k,64&R){e.msg="invalid distance code",s.mode=f;break}s.offset=L,s.extra=15&R,s.mode=24;case 24:if(s.extra){for(j=s.extra;A<j;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}s.offset+=y&(1<<s.extra)-1,y>>>=s.extra,A-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){e.msg="invalid distance too far back",s.mode=f;break}s.mode=25;case 25:if(0===w)break e;if(N=D-w,s.offset>N){if((N=s.offset-N)>s.whave&&s.sane){e.msg="invalid distance too far back",s.mode=f;break}N>s.wnext?(N-=s.wnext,C=s.wsize-N):C=s.wnext-N,N>s.length&&(N=s.length),O=s.window}else O=_,C=b-s.offset,N=s.length;N>w&&(N=w),w-=N,s.length-=N;do{_[b++]=O[C++]}while(--N);0===s.length&&(s.mode=21);break;case 26:if(0===w)break e;_[b++]=s.length,w--,s.mode=21;break;case 27:if(s.wrap){for(;A<32;){if(0===v)break e;v--,y|=m[E++]<<A,A+=8}if(D-=w,e.total_out+=D,s.total+=D,D&&(e.adler=s.check=s.flags?r(s.check,_,D,b-D):n(s.check,_,D,b-D)),D=w,(s.flags?y:g(y))!==s.check){e.msg="incorrect data check",s.mode=f;break}y=0,A=0}s.mode=28;case 28:if(s.wrap&&s.flags){for(;A<32;){if(0===v)break e;v--,y+=m[E++]<<A,A+=8}if(y!==(4294967295&s.total)){e.msg="incorrect length check",s.mode=f;break}y=0,A=0}s.mode=29;case 29:G=1;break e;case f:G=-3;break e;case 31:return-4;case 32:default:return d}return e.next_out=b,e.avail_out=w,e.next_in=E,e.avail_in=v,s.hold=y,s.bits=A,(s.wsize||D!==e.avail_out&&s.mode<f&&(s.mode<27||4!==t))&&S(e,e.output,e.next_out,D-e.avail_out)?(s.mode=31,-4):(I-=e.avail_in,D-=e.avail_out,e.total_in+=I,e.total_out+=D,s.total+=D,s.wrap&&D&&(e.adler=s.check=s.flags?r(s.check,_,D,e.next_out-D):n(s.check,_,D,e.next_out-D)),e.data_type=s.bits+(s.last?64:0)+(s.mode===p?128:0)+(20===s.mode||15===s.mode?256:0),(0===I&&0===D||4===t)&&G===c&&(G=-5),G)},t.inflateEnd=function(e){if(!e||!e.state)return d;var t=e.state;return t.window&&(t.window=null),e.state=null,c},t.inflateGetHeader=function(e,t){var s;return e&&e.state?0==(2&(s=e.state).wrap)?d:(s.head=t,t.done=!1,c):d},t.inflateSetDictionary=function(e,t){var s,i=t.length;return e&&e.state?0!==(s=e.state).wrap&&11!==s.mode?d:11===s.mode&&n(1,t,i,0)!==s.check?-3:S(e,t,i,i)?(s.mode=31,-4):(s.havedict=1,c):d},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,s){"use strict";var i=s(117),n=s(12),r=s(50),a=s(48),o=s(31),l=s(49),h=s(114),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var s=i.inflateInit2(this.strm,t.windowBits);if(s!==a.Z_OK)throw new Error(o[s]);this.header=new h,i.inflateGetHeader(this.strm,this.header)}function u(e,t){var s=new d(t);if(s.push(e,!0),s.err)throw s.msg||o[s.err];return s.result}d.prototype.push=function(e,t){var s,o,l,h,d,u,p=this.strm,f=this.options.chunkSize,m=this.options.dictionary,_=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?p.input=r.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new n.Buf8(f),p.next_out=0,p.avail_out=f),(s=i.inflate(p,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&m&&(u="string"==typeof m?r.string2buf(m):"[object ArrayBuffer]"===c.call(m)?new Uint8Array(m):m,s=i.inflateSetDictionary(this.strm,u)),s===a.Z_BUF_ERROR&&!0===_&&(s=a.Z_OK,_=!1),s!==a.Z_STREAM_END&&s!==a.Z_OK)return this.onEnd(s),this.ended=!0,!1;p.next_out&&(0!==p.avail_out&&s!==a.Z_STREAM_END&&(0!==p.avail_in||o!==a.Z_FINISH&&o!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=r.utf8border(p.output,p.next_out),h=p.next_out-l,d=r.buf2string(p.output,l),p.next_out=h,p.avail_out=f-h,h&&n.arraySet(p.output,p.output,l,h,0),this.onData(d)):this.onData(n.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(_=!0)}while((p.avail_in>0||0===p.avail_out)&&s!==a.Z_STREAM_END);return s===a.Z_STREAM_END&&(o=a.Z_FINISH),o===a.Z_FINISH?(s=i.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===a.Z_OK):o!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),p.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=d,t.inflate=u,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},t.ungzip=u},function(e,t,s){"use strict";var i=s(12);function n(e){for(var t=e.length;--t>=0;)e[t]=0}var r=0,a=256,o=a+1+29,l=30,h=19,c=2*o+1,d=15,u=16,p=256,f=16,m=17,_=18,g=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],v=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],w=new Array(2*(o+2));n(w);var y=new Array(2*l);n(y);var A=new Array(512);n(A);var I=new Array(256);n(I);var T=new Array(29);n(T);var S,D,N,C=new Array(l);function O(e,t,s,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=s,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}function k(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function R(e){return e<256?A[e]:A[256+(e>>>7)]}function L(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function x(e,t,s){e.bi_valid>u-s?(e.bi_buf|=t<<e.bi_valid&65535,L(e,e.bi_buf),e.bi_buf=t>>u-e.bi_valid,e.bi_valid+=s-u):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=s)}function M(e,t,s){x(e,s[2*t],s[2*t+1])}function U(e,t){var s=0;do{s|=1&e,e>>>=1,s<<=1}while(--t>0);return s>>>1}function P(e,t,s){var i,n,r=new Array(d+1),a=0;for(i=1;i<=d;i++)r[i]=a=a+s[i-1]<<1;for(n=0;n<=t;n++){var o=e[2*n+1];0!==o&&(e[2*n]=U(r[o]++,o))}}function G(e){var t;for(t=0;t<o;t++)e.dyn_ltree[2*t]=0;for(t=0;t<l;t++)e.dyn_dtree[2*t]=0;for(t=0;t<h;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*p]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function B(e){e.bi_valid>8?L(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function j(e,t,s,i){var n=2*t,r=2*s;return e[n]<e[r]||e[n]===e[r]&&i[t]<=i[s]}function z(e,t,s){for(var i=e.heap[s],n=s<<1;n<=e.heap_len&&(n<e.heap_len&&j(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!j(t,i,e.heap[n],e.depth));)e.heap[s]=e.heap[n],s=n,n<<=1;e.heap[s]=i}function H(e,t,s){var i,n,r,o,l=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],n=e.pending_buf[e.l_buf+l],l++,0===i?M(e,n,t):(M(e,(r=I[n])+a+1,t),0!==(o=g[r])&&x(e,n-=T[r],o),M(e,r=R(--i),s),0!==(o=E[r])&&x(e,i-=C[r],o))}while(l<e.last_lit);M(e,p,t)}function V(e,t){var s,i,n,r=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=c,s=0;s<l;s++)0!==r[2*s]?(e.heap[++e.heap_len]=h=s,e.depth[s]=0):r[2*s+1]=0;for(;e.heap_len<2;)r[2*(n=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[n]=0,e.opt_len--,o&&(e.static_len-=a[2*n+1]);for(t.max_code=h,s=e.heap_len>>1;s>=1;s--)z(e,r,s);n=l;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],z(e,r,1),i=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=i,r[2*n]=r[2*s]+r[2*i],e.depth[n]=(e.depth[s]>=e.depth[i]?e.depth[s]:e.depth[i])+1,r[2*s+1]=r[2*i+1]=n,e.heap[1]=n++,z(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var s,i,n,r,a,o,l=t.dyn_tree,h=t.max_code,u=t.stat_desc.static_tree,p=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,_=t.stat_desc.max_length,g=0;for(r=0;r<=d;r++)e.bl_count[r]=0;for(l[2*e.heap[e.heap_max]+1]=0,s=e.heap_max+1;s<c;s++)(r=l[2*l[2*(i=e.heap[s])+1]+1]+1)>_&&(r=_,g++),l[2*i+1]=r,i>h||(e.bl_count[r]++,a=0,i>=m&&(a=f[i-m]),o=l[2*i],e.opt_len+=o*(r+a),p&&(e.static_len+=o*(u[2*i+1]+a)));if(0!==g){do{for(r=_-1;0===e.bl_count[r];)r--;e.bl_count[r]--,e.bl_count[r+1]+=2,e.bl_count[_]--,g-=2}while(g>0);for(r=_;0!==r;r--)for(i=e.bl_count[r];0!==i;)(n=e.heap[--s])>h||(l[2*n+1]!==r&&(e.opt_len+=(r-l[2*n+1])*l[2*n],l[2*n+1]=r),i--)}}(e,t),P(r,h,e.bl_count)}function $(e,t,s){var i,n,r=-1,a=t[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),t[2*(s+1)+1]=65535,i=0;i<=s;i++)n=a,a=t[2*(i+1)+1],++o<l&&n===a||(o<h?e.bl_tree[2*n]+=o:0!==n?(n!==r&&e.bl_tree[2*n]++,e.bl_tree[2*f]++):o<=10?e.bl_tree[2*m]++:e.bl_tree[2*_]++,o=0,r=n,0===a?(l=138,h=3):n===a?(l=6,h=3):(l=7,h=4))}function q(e,t,s){var i,n,r=-1,a=t[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),i=0;i<=s;i++)if(n=a,a=t[2*(i+1)+1],!(++o<l&&n===a)){if(o<h)do{M(e,n,e.bl_tree)}while(0!=--o);else 0!==n?(n!==r&&(M(e,n,e.bl_tree),o--),M(e,f,e.bl_tree),x(e,o-3,2)):o<=10?(M(e,m,e.bl_tree),x(e,o-3,3)):(M(e,_,e.bl_tree),x(e,o-11,7));o=0,r=n,0===a?(l=138,h=3):n===a?(l=6,h=3):(l=7,h=4)}}n(C);var F=!1;function K(e,t,s,n){x(e,(r<<1)+(n?1:0),3),function(e,t,s,n){B(e),L(e,s),L(e,~s),i.arraySet(e.pending_buf,e.window,t,s,e.pending),e.pending+=s}(e,t,s)}t._tr_init=function(e){F||(function(){var e,t,s,i,n,r=new Array(d+1);for(s=0,i=0;i<28;i++)for(T[i]=s,e=0;e<1<<g[i];e++)I[s++]=i;for(I[s-1]=i,n=0,i=0;i<16;i++)for(C[i]=n,e=0;e<1<<E[i];e++)A[n++]=i;for(n>>=7;i<l;i++)for(C[i]=n<<7,e=0;e<1<<E[i]-7;e++)A[256+n++]=i;for(t=0;t<=d;t++)r[t]=0;for(e=0;e<=143;)w[2*e+1]=8,e++,r[8]++;for(;e<=255;)w[2*e+1]=9,e++,r[9]++;for(;e<=279;)w[2*e+1]=7,e++,r[7]++;for(;e<=287;)w[2*e+1]=8,e++,r[8]++;for(P(w,o+1,r),e=0;e<l;e++)y[2*e+1]=5,y[2*e]=U(e,5);S=new O(w,g,a+1,o,d),D=new O(y,E,0,l,d),N=new O(new Array(0),b,0,h,7)}(),F=!0),e.l_desc=new k(e.dyn_ltree,S),e.d_desc=new k(e.dyn_dtree,D),e.bl_desc=new k(e.bl_tree,N),e.bi_buf=0,e.bi_valid=0,G(e)},t._tr_stored_block=K,t._tr_flush_block=function(e,t,s,i){var n,r,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,s=4093624447;for(t=0;t<=31;t++,s>>>=1)if(1&s&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),V(e,e.l_desc),V(e,e.d_desc),o=function(e){var t;for($(e,e.dyn_ltree,e.l_desc.max_code),$(e,e.dyn_dtree,e.d_desc.max_code),V(e,e.bl_desc),t=h-1;t>=3&&0===e.bl_tree[2*v[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(r=e.static_len+3+7>>>3)<=n&&(n=r)):n=r=s+5,s+4<=n&&-1!==t?K(e,t,s,i):4===e.strategy||r===n?(x(e,2+(i?1:0),3),H(e,w,y)):(x(e,4+(i?1:0),3),function(e,t,s,i){var n;for(x(e,t-257,5),x(e,s-1,5),x(e,i-4,4),n=0;n<i;n++)x(e,e.bl_tree[2*v[n]+1],3);q(e,e.dyn_ltree,t-1),q(e,e.dyn_dtree,s-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),H(e,e.dyn_ltree,e.dyn_dtree)),G(e),i&&B(e)},t._tr_tally=function(e,t,s){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&s,e.last_lit++,0===t?e.dyn_ltree[2*s]++:(e.matches++,t--,e.dyn_ltree[2*(I[s]+a+1)]++,e.dyn_dtree[2*R(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){x(e,2,3),M(e,p,w),function(e){16===e.bi_valid?(L(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,s){"use strict";var i,n=s(12),r=s(119),a=s(52),o=s(51),l=s(31),h=0,c=4,d=0,u=-2,p=-1,f=1,m=4,_=2,g=8,E=9,b=286,v=30,w=19,y=2*b+1,A=15,I=3,T=258,S=T+I+1,D=42,N=103,C=113,O=666,k=1,R=2,L=3,x=4;function M(e,t){return e.msg=l[t],t}function U(e){return(e<<1)-(e>4?9:0)}function P(e){for(var t=e.length;--t>=0;)e[t]=0}function G(e){var t=e.state,s=t.pending;s>e.avail_out&&(s=e.avail_out),0!==s&&(n.arraySet(e.output,t.pending_buf,t.pending_out,s,e.next_out),e.next_out+=s,t.pending_out+=s,e.total_out+=s,e.avail_out-=s,t.pending-=s,0===t.pending&&(t.pending_out=0))}function B(e,t){r._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,G(e.strm)}function j(e,t){e.pending_buf[e.pending++]=t}function z(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function H(e,t){var s,i,n=e.max_chain_length,r=e.strstart,a=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-S?e.strstart-(e.w_size-S):0,h=e.window,c=e.w_mask,d=e.prev,u=e.strstart+T,p=h[r+a-1],f=h[r+a];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(h[(s=t)+a]===f&&h[s+a-1]===p&&h[s]===h[r]&&h[++s]===h[r+1]){r+=2,s++;do{}while(h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&r<u);if(i=T-(u-r),r=u-T,i>a){if(e.match_start=t,a=i,i>=o)break;p=h[r+a-1],f=h[r+a]}}}while((t=d[t&c])>l&&0!=--n);return a<=e.lookahead?a:e.lookahead}function V(e){var t,s,i,r,l,h,c,d,u,p,f=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-S)){n.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=s=e.hash_size;do{i=e.head[--t],e.head[t]=i>=f?i-f:0}while(--s);t=s=f;do{i=e.prev[--t],e.prev[t]=i>=f?i-f:0}while(--s);r+=f}if(0===e.strm.avail_in)break;if(h=e.strm,c=e.window,d=e.strstart+e.lookahead,u=r,p=void 0,(p=h.avail_in)>u&&(p=u),s=0===p?0:(h.avail_in-=p,n.arraySet(c,h.input,h.next_in,p,d),1===h.state.wrap?h.adler=a(h.adler,c,p,d):2===h.state.wrap&&(h.adler=o(h.adler,c,p,d)),h.next_in+=p,h.total_in+=p,p),e.lookahead+=s,e.lookahead+e.insert>=I)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+I-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<I)););}while(e.lookahead<S&&0!==e.strm.avail_in)}function $(e,t){for(var s,i;;){if(e.lookahead<S){if(V(e),e.lookahead<S&&t===h)return k;if(0===e.lookahead)break}if(s=0,e.lookahead>=I&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+I-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==s&&e.strstart-s<=e.w_size-S&&(e.match_length=H(e,s)),e.match_length>=I)if(i=r._tr_tally(e,e.strstart-e.match_start,e.match_length-I),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=I){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+I-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(B(e,!1),0===e.strm.avail_out))return k}return e.insert=e.strstart<I-1?e.strstart:I-1,t===c?(B(e,!0),0===e.strm.avail_out?L:x):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?k:R}function q(e,t){for(var s,i,n;;){if(e.lookahead<S){if(V(e),e.lookahead<S&&t===h)return k;if(0===e.lookahead)break}if(s=0,e.lookahead>=I&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+I-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=I-1,0!==s&&e.prev_length<e.max_lazy_match&&e.strstart-s<=e.w_size-S&&(e.match_length=H(e,s),e.match_length<=5&&(e.strategy===f||e.match_length===I&&e.strstart-e.match_start>4096)&&(e.match_length=I-1)),e.prev_length>=I&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-I,i=r._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-I),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+I-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=I-1,e.strstart++,i&&(B(e,!1),0===e.strm.avail_out))return k}else if(e.match_available){if((i=r._tr_tally(e,0,e.window[e.strstart-1]))&&B(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return k}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=r._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<I-1?e.strstart:I-1,t===c?(B(e,!0),0===e.strm.avail_out?L:x):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?k:R}function F(e,t,s,i,n){this.good_length=e,this.max_lazy=t,this.nice_length=s,this.max_chain=i,this.func=n}function K(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=_,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?D:C,e.adler=2===t.wrap?0:1,t.last_flush=h,r._tr_init(t),d):M(e,u)}function W(e){var t,s=K(e);return s===d&&((t=e.state).window_size=2*t.w_size,P(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=I-1,t.match_available=0,t.ins_h=0),s}function Y(e,t,s,i,r,a){if(!e)return u;var o=1;if(t===p&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>E||s!==g||i<8||i>15||t<0||t>9||a<0||a>m)return M(e,u);8===i&&(i=9);var l=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*y),this.dyn_dtree=new n.Buf16(2*(2*v+1)),this.bl_tree=new n.Buf16(2*(2*w+1)),P(this.dyn_ltree),P(this.dyn_dtree),P(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(A+1),this.heap=new n.Buf16(2*b+1),P(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*b+1),P(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return e.state=l,l.strm=e,l.wrap=o,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+I-1)/I),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=s,W(e)}i=[new F(0,0,0,0,function(e,t){var s=65535;for(s>e.pending_buf_size-5&&(s=e.pending_buf_size-5);;){if(e.lookahead<=1){if(V(e),0===e.lookahead&&t===h)return k;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+s;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,B(e,!1),0===e.strm.avail_out))return k;if(e.strstart-e.block_start>=e.w_size-S&&(B(e,!1),0===e.strm.avail_out))return k}return e.insert=0,t===c?(B(e,!0),0===e.strm.avail_out?L:x):(e.strstart>e.block_start&&(B(e,!1),e.strm.avail_out),k)}),new F(4,4,8,4,$),new F(4,5,16,8,$),new F(4,6,32,32,$),new F(4,4,16,16,q),new F(8,16,32,32,q),new F(8,16,128,128,q),new F(8,32,128,256,q),new F(32,128,258,1024,q),new F(32,258,258,4096,q)],t.deflateInit=function(e,t){return Y(e,t,g,15,8,0)},t.deflateInit2=Y,t.deflateReset=W,t.deflateResetKeep=K,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?u:(e.state.gzhead=t,d):u},t.deflate=function(e,t){var s,n,a,l;if(!e||!e.state||t>5||t<0)return e?M(e,u):u;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===O&&t!==c)return M(e,0===e.avail_out?-5:u);if(n.strm=e,s=n.last_flush,n.last_flush=t,n.status===D)if(2===n.wrap)e.adler=0,j(n,31),j(n,139),j(n,8),n.gzhead?(j(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),j(n,255&n.gzhead.time),j(n,n.gzhead.time>>8&255),j(n,n.gzhead.time>>16&255),j(n,n.gzhead.time>>24&255),j(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),j(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(j(n,255&n.gzhead.extra.length),j(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=o(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(j(n,0),j(n,0),j(n,0),j(n,0),j(n,0),j(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),j(n,3),n.status=C);else{var p=g+(n.w_bits-8<<4)<<8;p|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(p|=32),p+=31-p%31,n.status=C,z(n,p),0!==n.strstart&&(z(n,e.adler>>>16),z(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(a=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),G(e),a=n.pending,n.pending!==n.pending_buf_size));)j(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),G(e),a=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,j(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),0===l&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),G(e),a=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,j(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),0===l&&(n.status=N)}else n.status=N;if(n.status===N&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&G(e),n.pending+2<=n.pending_buf_size&&(j(n,255&e.adler),j(n,e.adler>>8&255),e.adler=0,n.status=C)):n.status=C),0!==n.pending){if(G(e),0===e.avail_out)return n.last_flush=-1,d}else if(0===e.avail_in&&U(t)<=U(s)&&t!==c)return M(e,-5);if(n.status===O&&0!==e.avail_in)return M(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==h&&n.status!==O){var f=2===n.strategy?function(e,t){for(var s;;){if(0===e.lookahead&&(V(e),0===e.lookahead)){if(t===h)return k;break}if(e.match_length=0,s=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,s&&(B(e,!1),0===e.strm.avail_out))return k}return e.insert=0,t===c?(B(e,!0),0===e.strm.avail_out?L:x):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?k:R}(n,t):3===n.strategy?function(e,t){for(var s,i,n,a,o=e.window;;){if(e.lookahead<=T){if(V(e),e.lookahead<=T&&t===h)return k;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=I&&e.strstart>0&&(i=o[n=e.strstart-1])===o[++n]&&i===o[++n]&&i===o[++n]){a=e.strstart+T;do{}while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<a);e.match_length=T-(a-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=I?(s=r._tr_tally(e,1,e.match_length-I),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(s=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),s&&(B(e,!1),0===e.strm.avail_out))return k}return e.insert=0,t===c?(B(e,!0),0===e.strm.avail_out?L:x):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?k:R}(n,t):i[n.level].func(n,t);if(f!==L&&f!==x||(n.status=O),f===k||f===L)return 0===e.avail_out&&(n.last_flush=-1),d;if(f===R&&(1===t?r._tr_align(n):5!==t&&(r._tr_stored_block(n,0,0,!1),3===t&&(P(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),G(e),0===e.avail_out))return n.last_flush=-1,d}return t!==c?d:n.wrap<=0?1:(2===n.wrap?(j(n,255&e.adler),j(n,e.adler>>8&255),j(n,e.adler>>16&255),j(n,e.adler>>24&255),j(n,255&e.total_in),j(n,e.total_in>>8&255),j(n,e.total_in>>16&255),j(n,e.total_in>>24&255)):(z(n,e.adler>>>16),z(n,65535&e.adler)),G(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?d:1)},t.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==D&&69!==t&&73!==t&&91!==t&&t!==N&&t!==C&&t!==O?M(e,u):(e.state=null,t===C?M(e,-3):d):u},t.deflateSetDictionary=function(e,t){var s,i,r,o,l,h,c,p,f=t.length;if(!e||!e.state)return u;if(2===(o=(s=e.state).wrap)||1===o&&s.status!==D||s.lookahead)return u;for(1===o&&(e.adler=a(e.adler,t,f,0)),s.wrap=0,f>=s.w_size&&(0===o&&(P(s.head),s.strstart=0,s.block_start=0,s.insert=0),p=new n.Buf8(s.w_size),n.arraySet(p,t,f-s.w_size,s.w_size,0),t=p,f=s.w_size),l=e.avail_in,h=e.next_in,c=e.input,e.avail_in=f,e.next_in=0,e.input=t,V(s);s.lookahead>=I;){i=s.strstart,r=s.lookahead-(I-1);do{s.ins_h=(s.ins_h<<s.hash_shift^s.window[i+I-1])&s.hash_mask,s.prev[i&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=i,i++}while(--r);s.strstart=i,s.lookahead=I-1,V(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=I-1,s.match_available=0,e.next_in=h,e.input=c,e.avail_in=l,s.wrap=o,d},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,s){"use strict";var i=s(120),n=s(12),r=s(50),a=s(31),o=s(49),l=Object.prototype.toString,h=0,c=-1,d=0,u=8;function p(e){if(!(this instanceof p))return new p(e);this.options=n.assign({level:c,method:u,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var s=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(s!==h)throw new Error(a[s]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var f;if(f="string"==typeof t.dictionary?r.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(s=i.deflateSetDictionary(this.strm,f))!==h)throw new Error(a[s]);this._dict_set=!0}}function f(e,t){var s=new p(t);if(s.push(e,!0),s.err)throw s.msg||a[s.err];return s.result}p.prototype.push=function(e,t){var s,a,o=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=r.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new n.Buf8(c),o.next_out=0,o.avail_out=c),1!==(s=i.deflate(o,a))&&s!==h)return this.onEnd(s),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(r.buf2binstring(n.shrinkBuf(o.output,o.next_out))):this.onData(n.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==s);return 4===a?(s=i.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===h):2!==a||(this.onEnd(h),o.avail_out=0,!0)},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=p,t.deflate=f,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,f(e,t)}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.MessageReactionRemoveAll.handle(s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.MessageReactionRemove.handle(s)}}},function(e,t,s){const i=s(1),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d,{user:i,reaction:r}=t.actions.MessageReactionAdd.handle(s);r&&t.emit(n.MESSAGE_REACTION_ADD,r,i)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;2===s.type?t.user.blocked.has(s.id)&&t.user.blocked.delete(s.id):1===s.type&&t.user.friends.has(s.id)&&t.user.friends.delete(s.id)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;1===s.type?t.users.fetch(s.id).then(e=>{t.user.friends.set(e.id,e)}):2===s.type&&t.users.fetch(s.id).then(e=>{t.user.blocked.set(e.id,e)})}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.GuildSync.handle(s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.emit("self.voiceServer",s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){this.packetManager.client.actions.MessageDeleteBulk.handle(e.d)}}},function(e,t,s){const i=s(1),{Events:n}=s(0);e.exports=class extends i{handle(e){const{old:t,updated:s}=this.packetManager.client.actions.MessageUpdate.handle(e.d);t&&s&&this.packetManager.client.emit(n.MESSAGE_UPDATE,t,s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){this.packetManager.client.actions.MessageDelete.handle(e.d)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){this.packetManager.client.actions.MessageCreate.handle(e.d)}}},function(e,t,s){const i=s(1),{Events:n}=s(0);function r(e,t){return e.client.setTimeout(()=>{e.client.emit(n.TYPING_STOP,e,t,e._typing.get(t.id)),e._typing.delete(t.id)},6e3)}e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d,i=t.channels.get(s.channel_id),a=t.users.get(s.user_id),o=new Date(1e3*s.timestamp);if(i&&a){if("voice"===i.type)return void t.emit(n.WARN,`Discord sent a typing packet to voice channel ${i.id}`);if(i._typing.has(a.id)){const e=i._typing.get(a.id);e.lastTimestamp=o,e.resetTimeout(r(i,a))}else i._typing.set(a.id,new class{constructor(e,t,s,i){this.client=e,this.since=t,this.lastTimestamp=s,this._timeout=i}resetTimeout(e){this.client.clearTimeout(this._timeout),this._timeout=e}get elapsedTime(){return Date.now()-this.since}}(t,o,o,r(i,a))),t.emit(n.TYPING_START,i,a)}}}},function(e,t,s){const i=s(1),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d,i=t.guilds.get(s.guild_id);if(i){const e=i.members.get(s.user_id);if(e){const r=e._clone();r._frozenVoiceState=r.voiceState,e.user.id===t.user.id&&s.channel_id&&t.emit("self.voiceStateUpdate",s),i.voiceStates.set(e.user.id,s),t.emit(n.VOICE_STATE_UPDATE,r,e)}}}}},function(e,t,s){const i=s(1),{Events:n}=s(0),r=s(32);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=t.user.guildSettings.get(e.d.guild_id);s?s.patch(e.d):t.user.guildSettings.set(e.d.guild_id,new r(this.client,e.d)),t.emit(n.USER_GUILD_SETTINGS_UPDATE,t.user.guildSettings.get(e.d.guild_id))}}},function(e,t,s){const i=s(1),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.packetManager.client;t.user.settings.patch(e.d),t.emit(n.USER_SETTINGS_UPDATE,t.user.settings)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.UserNoteUpdate.handle(s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.UserUpdate.handle(s)}}},function(e,t,s){const i=s(1),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;let i=t.users.get(s.user.id);const r=t.guilds.get(s.guild_id);if(!i){if(!s.user.username)return;i=t.users.add(s.user)}const a=i._update(s.user);if(i.equals(a)||t.emit(n.USER_UPDATE,a,i),r){let e=r.members.get(i.id);if(e||"offline"===s.status||(e=r.members.add({user:i,roles:s.roles,deaf:!1,mute:!1}),t.emit(n.GUILD_MEMBER_AVAILABLE,e)),e){if(0===t.listenerCount(n.PRESENCE_UPDATE))return void r.presences.add(s);const i=e._clone();e.presence&&(i.frozenPresence=e.presence._clone()),r.presences.add(s),t.emit(n.PRESENCE_UPDATE,i,e)}else r.presences.add(s)}}}},function(e,t,s){const i=s(1),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d,i=t.channels.get(s.channel_id),r=new Date(s.last_pin_timestamp);i&&r&&t.emit(n.CHANNEL_PINS_UPDATE,i,r)}}},function(e,t,s){const i=s(1),{Events:n}=s(0);e.exports=class extends i{handle(e){const{old:t,updated:s}=this.packetManager.client.actions.ChannelUpdate.handle(e.d);t&&s&&this.packetManager.client.emit(n.CHANNEL_UPDATE,t,s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){this.packetManager.client.actions.ChannelDelete.handle(e.d)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){this.packetManager.client.actions.ChannelCreate.handle(e.d)}}},function(e,t,s){const i=s(1),{Events:n}=s(0),r=s(3);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d,i=t.guilds.get(s.guild_id);if(!i)return;const a=new r;for(const e of s.members)a.set(e.user.id,i.members.add(e));t.emit(n.GUILD_MEMBERS_CHUNK,a,i),t.ws.lastHeartbeatAck=!0}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.GuildEmojisUpdate.handle(s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.GuildRoleUpdate.handle(s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.GuildRoleDelete.handle(s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.GuildRoleCreate.handle(s)}}},function(e,t,s){const i=s(1),{Events:n,Status:r}=s(0);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d,i=t.guilds.get(s.guild_id);if(i){const e=i.members.get(s.user.id);if(e){const i=e._update(s);t.ws.connection.status===r.READY&&t.emit(n.GUILD_MEMBER_UPDATE,i,e)}}}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.GuildMemberRemove.handle(s)}}},function(e,t,s){const i=s(1),{Events:n,Status:r}=s(0);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d,i=t.guilds.get(s.guild_id);if(i){i.memberCount++;const e=i.members.add(s);t.ws.connection.status===r.READY&&t.emit(n.GUILD_MEMBER_ADD,e)}}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.GuildBanRemove.handle(s)}}},function(e,t,s){const i=s(1),{Events:n}=s(0);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d,i=t.guilds.get(s.guild_id),r=t.users.get(s.user.id);i&&r&&t.emit(n.GUILD_BAN_ADD,i,r)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=e.d;t.actions.GuildUpdate.handle(s)}}},function(e,t,s){const i=s(1);e.exports=class extends i{handle(e){this.packetManager.client.actions.GuildDelete.handle(e.d)}}},function(e,t,s){const i=s(1),{Events:n,Status:r}=s(0);e.exports=class extends i{async handle(e){const t=this.packetManager.client,s=e.d;let i=t.guilds.get(s.id);i?i.available||s.unavailable||(i._patch(s),this.packetManager.ws.checkIfReady()):(i=t.guilds.add(s),t.ws.connection.status===r.READY&&(t.options.fetchAllMembers&&await i.members.fetch(),t.emit(n.GUILD_CREATE,i)))}}},function(e,t,s){const i=s(1),{Events:n,Status:r}=s(0);e.exports=class extends i{handle(e){const t=this.packetManager.client,s=t.ws.connection;s._trace=e.d._trace,s.status=r.READY,this.packetManager.handleQueue();const i=s.sequence-s.closeSequence;s.debug(`RESUMED ${s._trace.join(" -> ")} | replayed ${i} events.`),t.emit(n.RESUMED,i),s.heartbeat()}}},function(e,t,s){const i=s(7),n=s(33);e.exports=class extends i{constructor(e,t){super(e.client,t,n),this.message=e}add(e,t){return super.add(e,t,{id:e.emoji.id||e.emoji.name,extras:[this.message]})}removeAll(){return this.client.api.channels(this.message.channel.id).messages(this.message.id).reactions.delete().then(()=>this.message)}}},function(e,t,s){const i=s(3),{UserFlags:n}=s(0),r=s(65),a=s(9);e.exports=class extends a{constructor(e,t){super(e.client),this.user=e,this.mutualGuilds=new i,this.connections=new i,this._patch(t)}_patch(e){this.premium=Boolean(e.premium_since),this._flags=e.user.flags,this.premiumSince=e.premium_since?new Date(e.premium_since):null;for(const t of e.mutual_guilds)this.client.guilds.has(t.id)&&this.mutualGuilds.set(t.id,this.client.guilds.get(t.id));for(const t of e.connected_accounts)this.connections.set(t.id,new r(this.user,t))}get flags(){const e=[];for(const[t,s]of Object.entries(n))(this._flags&s)===s&&e.push(t);return e}toJSON(){return super.toJSON({flags:!0})}}},function(e,t,s){const i=s(66);e.exports=async function(e,t){const n=s(17),r=s(14);if(e instanceof n||e instanceof r)return e.createDM().then(e=>e.send(t));const{data:a,files:o}=await i(e,t);if(a.content instanceof Array){const t=[];for(let s=0;s<a.content.length;s++){const i=s===a.content.length-1?{tts:a.tts,embed:a.embed,files:o}:{tts:a.tts},n=await e.send(a.content[s],i);t.push(n)}return t}return e.client.api.channels[e.id].messages.post({data:a,files:o}).then(t=>e.client.actions.MessageCreate.handle(t).message)}},function(e,t,s){const i=s(6),{TypeError:n}=s(5);e.exports=function(e,t){if("string"==typeof t&&(t={content:t}),t.before&&(t.before instanceof Date||(t.before=new Date(t.before)),t.maxID=i.binaryToID((t.before.getTime()-14200704e5).toString(2)+"0".repeat(22))),t.after&&(t.after instanceof Date||(t.after=new Date(t.after)),t.minID=i.binaryToID((t.after.getTime()-14200704e5).toString(2)+"0".repeat(22))),t.during){t.during instanceof Date||(t.during=new Date(t.during));const e=t.during.getTime()-14200704e5;t.minID=i.binaryToID(e.toString(2)+"0".repeat(22)),t.maxID=i.binaryToID((e+864e5).toString(2)+"0".repeat(22))}t.channel&&(t.channel=e.client.channels.resolveID(t.channel)),t.author&&(t.author=e.client.users.resolveID(t.author)),t.mentions&&(t.mentions=e.client.users.resolveID(t.options.mentions)),t.sortOrder&&(t.sortOrder={ascending:"asc",descending:"desc"}[t.sortOrder]||t.sortOrder),t={content:t.content,max_id:t.maxID,min_id:t.minID,has:t.has,channel_id:t.channel,author_id:t.author,author_type:t.authorType,context_size:t.contextSize,sort_by:t.sortBy,sort_order:t.sortOrder,limit:t.limit,offset:t.offset,mentions:t.mentions,mentions_everyone:t.mentionsEveryone,link_hostname:t.linkHostname,embed_provider:t.embedProvider,embed_type:t.embedType,attachment_filename:t.attachmentFilename,attachment_extension:t.attachmentExtension,include_nsfw:t.nsfw};const r=s(16),a=s(21);if(!(e instanceof r||e instanceof a))throw new n("SEARCH_CHANNEL_TYPE");return e.client.api[e instanceof r?"channels":"guilds"](e.id).messages().search.get({query:t}).then(t=>{const s=t.messages.map(t=>t.map(t=>e.client.channels.get(t.channel_id).messages.add(t,!1)));return{total:t.total_results,results:s}})}},function(e,t,s){const i=s(1),{Events:n}=s(0);let r;e.exports=class extends i{handle(e){const t=this.packetManager.client,i=e.d;t.ws.heartbeat(),i.user.user_settings=i.user_settings,i.user.user_guild_settings=i.user_guild_settings,r||(r=s(78));const a=new r(t,i.user);t.user=a,t.readyAt=new Date,t.users.set(a.id,a);for(const e of i.guilds)t.guilds.add(e);for(const e of i.private_channels)t.channels.add(e);for(const e of i.relationships){const s=t.users.add(e.user);1===e.type?t.user.friends.set(s.id,s):2===e.type&&t.user.blocked.set(s.id,s)}for(const e of i.presences||[])t.presences.add(e);if(i.notes)for(const e in i.notes){let s=i.notes[e];s.length||(s=null),t.user.notes.set(e,s)}t.users.has("1")||t.users.add({id:"1",username:"Clyde",discriminator:"0000",avatar:"https://discordapp.com/assets/f78426a064bc9dd24847519259bc42af.png",bot:!0,status:"online",activity:null,verified:!0});const o=t.setTimeout(()=>{t.ws.connection.triggerReady()},1200*i.guilds.length);t.setMaxListeners(i.guilds.length+10),t.once("ready",()=>{t.syncGuilds(),t.setMaxListeners(10),t.clearTimeout(o)});const l=this.packetManager.ws;l.sessionID=i.session_id,l._trace=i._trace,t.emit(n.DEBUG,`READY ${l._trace.join(" -> ")} ${l.sessionID}`),l.checkIfReady()}}},function(e,t,s){const{OPCodes:i,Status:n,WSEvents:r}=s(0),a=[r.READY,r.RESUMED,r.GUILD_CREATE,r.GUILD_DELETE,r.GUILD_MEMBERS_CHUNK,r.GUILD_MEMBER_ADD,r.GUILD_MEMBER_REMOVE];e.exports=class{constructor(e){this.ws=e,this.handlers={},this.queue=[],this.register(r.READY,s(166)),this.register(r.RESUMED,s(161)),this.register(r.GUILD_CREATE,s(160)),this.register(r.GUILD_DELETE,s(159)),this.register(r.GUILD_UPDATE,s(158)),this.register(r.GUILD_BAN_ADD,s(157)),this.register(r.GUILD_BAN_REMOVE,s(156)),this.register(r.GUILD_MEMBER_ADD,s(155)),this.register(r.GUILD_MEMBER_REMOVE,s(154)),this.register(r.GUILD_MEMBER_UPDATE,s(153)),this.register(r.GUILD_ROLE_CREATE,s(152)),this.register(r.GUILD_ROLE_DELETE,s(151)),this.register(r.GUILD_ROLE_UPDATE,s(150)),this.register(r.GUILD_EMOJIS_UPDATE,s(149)),this.register(r.GUILD_MEMBERS_CHUNK,s(148)),this.register(r.CHANNEL_CREATE,s(147)),this.register(r.CHANNEL_DELETE,s(146)),this.register(r.CHANNEL_UPDATE,s(145)),this.register(r.CHANNEL_PINS_UPDATE,s(144)),this.register(r.PRESENCE_UPDATE,s(143)),this.register(r.USER_UPDATE,s(142)),this.register(r.USER_NOTE_UPDATE,s(141)),this.register(r.USER_SETTINGS_UPDATE,s(140)),this.register(r.USER_GUILD_SETTINGS_UPDATE,s(139)),this.register(r.VOICE_STATE_UPDATE,s(138)),this.register(r.TYPING_START,s(137)),this.register(r.MESSAGE_CREATE,s(136)),this.register(r.MESSAGE_DELETE,s(135)),this.register(r.MESSAGE_UPDATE,s(134)),this.register(r.MESSAGE_DELETE_BULK,s(133)),this.register(r.VOICE_SERVER_UPDATE,s(132)),this.register(r.GUILD_SYNC,s(131)),this.register(r.RELATIONSHIP_ADD,s(130)),this.register(r.RELATIONSHIP_REMOVE,s(129)),this.register(r.MESSAGE_REACTION_ADD,s(128)),this.register(r.MESSAGE_REACTION_REMOVE,s(127)),this.register(r.MESSAGE_REACTION_REMOVE_ALL,s(126))}get client(){return this.ws.client}register(e,t){this.handlers[e]=new t(this)}handleQueue(){this.queue.forEach((e,t)=>{this.handle(this.queue[t],!0),this.queue.splice(t,1)})}handle(e,t=!1){return e.op===i.HEARTBEAT_ACK?(this.ws.client._pong(this.ws.client._pingTimestamp),this.ws.lastHeartbeatAck=!0,this.ws.client.emit("debug","Heartbeat acknowledged")):e.op===i.HEARTBEAT&&(this.client.ws.send({op:i.HEARTBEAT,d:this.client.ws.sequence}),this.ws.client.emit("debug","Received gateway heartbeat")),this.ws.status===n.RECONNECTING&&(this.ws.reconnecting=!1,this.ws.checkIfReady()),this.ws.setSequence(e.s),void 0===this.ws.disabledEvents[e.t]&&(this.ws.status!==n.READY&&-1===a.indexOf(e.t)?(this.queue.push(e),!1):(!t&&this.queue.length>0&&this.handleQueue(),!!this.handlers[e.t]&&this.handlers[e.t].handle(e)))}}},function(e,t,s){const i=s(30),{Events:n,OPCodes:r,Status:a,WSCodes:o}=s(0),l=s(167),h=s(54);try{var c=s(122);c.Inflate||(c=s(53))}catch(e){c=s(53)}e.exports=class extends i{constructor(e,t){super(),this.manager=e,this.client=e.client,this.ws=null,this.sequence=-1,this.status=a.IDLE,this.packetManager=new l(this),this.lastPingTimestamp=0,this.ratelimit={queue:[],remaining:120,total:120,time:6e4,resetTimer:null},this.disabledEvents={};for(const e of this.client.options.disabledEvents)this.disabledEvents[e]=!0;this.closeSequence=0,this.expectingClose=!1,this.inflate=null,this.connect(t)}triggerReady(){this.status!==a.READY?(this.status=a.READY,this.client.emit(n.READY),this.packetManager.handleQueue()):this.debug("Tried to mark self as ready, but already ready")}checkIfReady(){if(this.status===a.READY||this.status===a.NEARLY)return!1;let e=0;for(const t of this.client.guilds.values())t.available||e++;if(0===e){if(this.status=a.NEARLY,!this.client.options.fetchAllMembers)return this.triggerReady();const e=this.client.guilds.map(e=>e.members.fetch());Promise.all(e).then(()=>this.triggerReady()).catch(e=>{this.debug(`Failed to fetch all members before ready! ${e}`),this.triggerReady()})}return!0}debug(e){return e instanceof Error&&(e=e.stack),this.manager.debug(`[connection] ${e}`)}processQueue(){if(0!==this.ratelimit.remaining&&0!==this.ratelimit.queue.length)for(this.ratelimit.remaining===this.ratelimit.total&&(this.ratelimit.resetTimer=this.client.setTimeout(()=>{this.ratelimit.remaining=this.ratelimit.total,this.processQueue()},this.ratelimit.time));this.ratelimit.remaining>0;){const e=this.ratelimit.queue.shift();if(!e)return;this._send(e),this.ratelimit.remaining--}}_send(e){this.ws&&this.ws.readyState===h.OPEN?this.ws.send(h.pack(e)):this.debug(`Tried to send packet ${e} but no WebSocket is available!`)}send(e){this.ws&&this.ws.readyState===h.OPEN?(this.ratelimit.queue.push(e),this.processQueue()):this.debug(`Tried to send packet ${e} but no WebSocket is available!`)}connect(e=this.gateway,t=0,s=!1){if(t)return this.client.setTimeout(()=>this.connect(e,0,s),t);if(this.ws&&!s)return this.debug("WebSocket connection already exists"),!1;if("string"!=typeof e)return this.debug(`Tried to connect to an invalid gateway: ${e}`),!1;this.inflate=new c.Inflate({chunkSize:65535,flush:c.Z_SYNC_FLUSH,to:"json"===h.encoding?"string":""}),this.expectingClose=!1,this.gateway=e,this.debug(`Connecting to ${e}`);const i=this.ws=h.create(e,{v:this.client.options.ws.version,compress:"zlib-stream"});return i.onmessage=this.onMessage.bind(this),i.onopen=this.onOpen.bind(this),i.onerror=this.onError.bind(this),i.onclose=this.onClose.bind(this),this.status=a.CONNECTING,!0}destroy(){const e=this.ws;return e?(this.heartbeat(-1),this.expectingClose=!0,e.close(1e3),this.packetManager.handleQueue(),this.ws=null,this.status=a.DISCONNECTED,this.ratelimit.remaining=this.ratelimit.total,!0):(this.debug("Attempted to destroy WebSocket but no connection exists!"),!1)}onMessage({data:e}){e instanceof ArrayBuffer&&(e=new Uint8Array(e));const t=e.length,s=t>=4&&0===e[t-4]&&0===e[t-3]&&255===e[t-2]&&255===e[t-1];if(this.inflate.push(e,s&&c.Z_SYNC_FLUSH),!s)return;let i;try{i=h.unpack(this.inflate.result)}catch(e){return void this.client.emit("debug",e)}this.onPacket(i),this.client.listenerCount("raw")&&this.client.emit("raw",i)}setSequence(e){this.sequence=e>this.sequence?e:this.sequence}onPacket(e){if(!e)return this.debug("Received null packet"),!1;switch(e.op){case r.HELLO:return this.heartbeat(e.d.heartbeat_interval);case r.RECONNECT:return this.reconnect();case r.INVALID_SESSION:return e.d||(this.sessionID=null),this.sequence=-1,this.debug("Session invalidated -- will identify with a new session"),this.identify(e.d?2500:0);case r.HEARTBEAT_ACK:return this.ackHeartbeat();case r.HEARTBEAT:return this.heartbeat();default:return this.packetManager.handle(e)}}onOpen(e){e&&e.target&&e.target.url&&(this.gateway=e.target.url),this.debug(`Connected to gateway ${this.gateway}`),this.identify()}reconnect(){this.debug("Attemping to reconnect in 5500ms..."),this.client.emit(n.RECONNECTING),this.connect(this.gateway,5500,!0)}onError(e){e&&"uWs client connection error"===e.message?this.reconnect():this.client.emit(n.ERROR,e)}onClose(e){if(this.debug(`${this.expectingClose?"Client":"Server"} closed the WebSocket connection: ${e.code}`),this.closeSequence=this.sequence,this.emit("close",e),this.heartbeat(-1),1e3===e.code?this.expectingClose:o[e.code])return this.expectingClose=!1,this.client.emit(n.DISCONNECT,e),this.debug(o[e.code]),void this.destroy();this.expectingClose=!1,this.reconnect()}ackHeartbeat(){this.debug(`Heartbeat acknowledged, latency of ${Date.now()-this.lastPingTimestamp}ms`),this.client._pong(this.lastPingTimestamp)}heartbeat(e){isNaN(e)?(this.debug("Sending a heartbeat"),this.lastPingTimestamp=Date.now(),this.send({op:r.HEARTBEAT,d:this.sequence})):-1===e?(this.debug("Clearing heartbeat interval"),this.client.clearInterval(this.heartbeatInterval),this.heartbeatInterval=null):(this.debug(`Setting a heartbeat interval for ${e}ms`),this.heartbeatInterval=this.client.setInterval(()=>this.heartbeat(),e))}identify(e){return e?this.client.setTimeout(this.identify.bind(this),e):this.sessionID?this.identifyResume():this.identifyNew()}identifyNew(){if(!this.client.token)return void this.debug("No token available to identify a new session with");const e=Object.assign({token:this.client.token},this.client.options.ws),{shardId:t,shardCount:s}=this.client.options;s>0&&(e.shard=[Number(t),Number(s)]),this.debug("Identifying as a new session"),this.send({op:r.IDENTIFY,d:e})}identifyResume(){if(!this.sessionID)return this.debug("Warning: wanted to resume but session ID not available; identifying as a new session instead"),this.identifyNew();this.debug(`Attempting to resume session ${this.sessionID}`);const e={token:this.client.token,session_id:this.sessionID,seq:this.sequence};return this.send({op:r.RESUME,d:e})}}},function(e,t,s){const i=s(30),{Events:n,Status:r}=s(0),a=s(168);e.exports=class extends i{constructor(e){super(),this.client=e,this.connection=null}heartbeat(){return this.connection?this.connection.heartbeat():this.debug("No connection to heartbeat")}debug(e){return this.client.emit(n.DEBUG,`[ws] ${e}`)}destroy(){return this.connection?this.connection.destroy():(this.debug("Attempted to destroy WebSocket but no connection exists!"),!1)}send(e){this.connection?this.connection.send(e):this.debug("No connection to websocket")}connect(e){if(!this.connection)return this.connection=new a(this,e),!0;switch(this.connection.status){case r.IDLE:case r.DISCONNECTED:return this.connection.connect(e,5500),!0;default:return this.debug(`Couldn't connect to ${e} as the websocket is at state ${this.connection.status}`),!1}}}},function(e,t){},function(e,t,s){const{Events:i,Status:n}=s(0),{Error:r}=s(5);e.exports=class{constructor(e){this.client=e,this.heartbeatInterval=null}get status(){return this.connection?this.connection.status:n.IDLE}connectToWebSocket(e,t,s){this.client.emit(i.DEBUG,`Authenticated using token ${e}`),this.client.token=e;const n=this.client.setTimeout(()=>s(new r("WS_CONNECTION_TIMEOUT")),3e5);this.client.api.gateway.get().then(async a=>{if(null!=this.client.options.presence){const e=await this.client.presences._parse(this.client.options.presence);this.client.options.ws.presence=e,this.client.presences.clientPresence.patch(e)}const o=`${a.url}/`;this.client.emit(i.DEBUG,`Using gateway ${o}`),this.client.ws.connect(o),this.client.ws.connection.once("error",s),this.client.ws.connection.once("close",e=>{4004===e.code&&s(new r("TOKEN_INVALID")),4010===e.code&&s(new r("SHARDING_INVALID")),4011===e.code&&s(new r("SHARDING_REQUIRED"))}),this.client.once(i.READY,()=>{t(e),this.client.clearTimeout(n)})},s)}destroy(){return this.client.ws.destroy(),this.client.user?this.client.user.bot?(this.client.token=null,Promise.resolve()):this.client.api.logout.post().then(()=>{this.client.token=null}):Promise.resolve()}}},function(module,exports,__webpack_require__){const BaseClient=__webpack_require__(41),Permissions=__webpack_require__(11),ClientManager=__webpack_require__(171),ClientVoiceManager=__webpack_require__(170),WebSocketManager=__webpack_require__(169),ActionsManager=__webpack_require__(113),Collection=__webpack_require__(3),VoiceRegion=__webpack_require__(38),Webhook=__webpack_require__(15),Invite=__webpack_require__(27),ClientApplication=__webpack_require__(34),ShardClientUtil=__webpack_require__(86),VoiceBroadcast=__webpack_require__(85),UserStore=__webpack_require__(47),ChannelStore=__webpack_require__(46),GuildStore=__webpack_require__(45),ClientPresenceStore=__webpack_require__(44),GuildEmojiStore=__webpack_require__(37),{Events:Events,browser:browser}=__webpack_require__(0),DataResolver=__webpack_require__(8),{Error:Error,TypeError:TypeError,RangeError:RangeError}=__webpack_require__(5);class Client extends BaseClient{constructor(e={}){super(Object.assign({_tokenType:"Bot"},e)),!browser&&!this.options.shardId&&"SHARD_ID"in process.env&&(this.options.shardId=Number(process.env.SHARD_ID)),!browser&&!this.options.shardCount&&"SHARD_COUNT"in process.env&&(this.options.shardCount=Number(process.env.SHARD_COUNT)),this._validateOptions(),this.manager=new ClientManager(this),this.ws=new WebSocketManager(this),this.actions=new ActionsManager(this),this.voice=browser?null:new ClientVoiceManager(this),this.shard=!browser&&process.env.SHARDING_MANAGER?ShardClientUtil.singleton(this):null,this.users=new UserStore(this),this.guilds=new GuildStore(this),this.channels=new ChannelStore(this),this.presences=new ClientPresenceStore(this),Object.defineProperty(this,"token",{writable:!0}),!browser&&!this.token&&"CLIENT_TOKEN"in process.env?this.token=process.env.CLIENT_TOKEN:this.token=null,this.user=null,this.readyAt=null,this.broadcasts=[],this.pings=[],this._timeouts=new Set,this._intervals=new Set,this.options.messageSweepInterval>0&&this.setInterval(this.sweepMessages.bind(this),1e3*this.options.messageSweepInterval)}get _pingTimestamp(){return this.ws.connection?this.ws.connection.lastPingTimestamp:0}get status(){return this.ws.connection?this.ws.connection.status:null}get uptime(){return this.readyAt?Date.now()-this.readyAt:null}get ping(){return this.pings.reduce((e,t)=>e+t,0)/this.pings.length}get voiceConnections(){return browser?new Collection:this.voice.connections}get emojis(){const e=new GuildEmojiStore({client:this});for(const t of this.guilds.values())if(t.available)for(const s of t.emojis.values())e.set(s.id,s);return e}get readyTimestamp(){return this.readyAt?this.readyAt.getTime():null}createVoiceBroadcast(){const e=new VoiceBroadcast(this);return this.broadcasts.push(e),e}login(e=this.token){return new Promise((t,s)=>{if(!e||"string"!=typeof e)throw new Error("TOKEN_INVALID");e=e.replace(/^Bot\s*/i,""),this.manager.connectToWebSocket(e,t,s)}).catch(e=>(this.destroy(),Promise.reject(e)))}destroy(){return super.destroy(),this.manager.destroy()}syncGuilds(e=this.guilds){this.user.bot||this.ws.send({op:12,d:e instanceof Collection?e.keyArray():e.map(e=>e.id)})}fetchInvite(e){const t=DataResolver.resolveInviteCode(e);return this.api.invites(t).get({query:{with_counts:!0}}).then(e=>new Invite(this,e))}fetchWebhook(e,t){return this.api.webhooks(e,t).get().then(e=>new Webhook(this,e))}fetchVoiceRegions(){return this.api.voice.regions.get().then(e=>{const t=new Collection;for(const s of e)t.set(s.id,new VoiceRegion(s));return t})}sweepMessages(e=this.options.messageCacheLifetime){if("number"!=typeof e||isNaN(e))throw new TypeError("CLIENT_INVALID_OPTION","Lifetime","a number");if(e<=0)return this.emit(Events.DEBUG,"Didn't sweep messages - lifetime is unlimited"),-1;const t=1e3*e,s=Date.now();let i=0,n=0;for(const e of this.channels.values())if(e.messages){i++;for(const i of e.messages.values())s-(i.editedTimestamp||i.createdTimestamp)>t&&(e.messages.delete(i.id),n++)}return this.emit(Events.DEBUG,`Swept ${n} messages older than ${e} seconds in ${i} text-based channels`),n}fetchApplication(e="@me"){return this.api.oauth2.applications(e).get().then(e=>new ClientApplication(this,e))}generateInvite(e){return e?e instanceof Array&&(e=Permissions.resolve(e)):e=0,this.fetchApplication().then(t=>`https://discordapp.com/oauth2/authorize?client_id=${t.id}&permissions=${e}&scope=bot`)}toJSON(){return super.toJSON({readyAt:!1,broadcasts:!1,pings:!1,presences:!1})}_pong(e){this.pings.unshift(Date.now()-e),this.pings.length>3&&(this.pings.length=3),this.ws.lastHeartbeatAck=!0}_eval(script){return eval(script)}_validateOptions(e=this.options){if("number"!=typeof e.shardCount||isNaN(e.shardCount))throw new TypeError("CLIENT_INVALID_OPTION","shardCount","a number");if("number"!=typeof e.shardId||isNaN(e.shardId))throw new TypeError("CLIENT_INVALID_OPTION","shardId","a number");if(e.shardCount<0)throw new RangeError("CLIENT_INVALID_OPTION","shardCount","at least 0");if(e.shardId<0)throw new RangeError("CLIENT_INVALID_OPTION","shardId","at least 0");if(0!==e.shardId&&e.shardId>=e.shardCount)throw new RangeError("CLIENT_INVALID_OPTION","shardId","less than shardCount");if("number"!=typeof e.messageCacheMaxSize||isNaN(e.messageCacheMaxSize))throw new TypeError("CLIENT_INVALID_OPTION","messageCacheMaxSize","a number");if("number"!=typeof e.messageCacheLifetime||isNaN(e.messageCacheLifetime))throw new TypeError("CLIENT_INVALID_OPTION","The messageCacheLifetime","a number");if("number"!=typeof e.messageSweepInterval||isNaN(e.messageSweepInterval))throw new TypeError("CLIENT_INVALID_OPTION","messageSweepInterval","a number");if("boolean"!=typeof e.fetchAllMembers)throw new TypeError("CLIENT_INVALID_OPTION","fetchAllMembers","a boolean");if("boolean"!=typeof e.disableEveryone)throw new TypeError("CLIENT_INVALID_OPTION","disableEveryone","a boolean");if("number"!=typeof e.restWsBridgeTimeout||isNaN(e.restWsBridgeTimeout))throw new TypeError("CLIENT_INVALID_OPTION","restWsBridgeTimeout","a number");if("boolean"!=typeof e.internalSharding)throw new TypeError("CLIENT_INVALID_OPTION","internalSharding","a boolean");if(!(e.disabledEvents instanceof Array))throw new TypeError("CLIENT_INVALID_OPTION","disabledEvents","an Array")}}module.exports=Client},function(e,t){const s=()=>{},i=["get","post","delete","patch","put"],n=["toString","valueOf","inspect","constructor",Symbol.toPrimitive,Symbol.for("util.inspect.custom")];e.exports=function(e){const t=[""],r={get:(a,o)=>n.includes(o)?()=>t.join("/"):i.includes(o)?s=>e.request(o,t.join("/"),Object.assign({versioned:e.versioned,route:t.map((e,s)=>/\d{16,19}/g.test(e)?/channels|guilds/.test(t[s-1])?e:":id":e).join("/")},s)):(t.push(o),new Proxy(s,r)),apply:(e,i,n)=>(t.push(...n.filter(e=>null!=e)),new Proxy(s,r))};return new Proxy(s,r)}},function(e,t){},function(e,t,s){const i=s(42),n=s(43),r=s(174),{browser:a,UserAgent:o}=s(0);if(r.Agent)var l=new r.Agent({keepAlive:!0});e.exports=class{constructor(e,t,s,n){this.rest=e,this.client=e.client,this.method=t,this.route=n.route,this.options=n;const r=(i.stringify(n.query).match(/[^=&?]+=[^=&?]+/g)||[]).join("&");this.path=`${s}${r?`?${r}`:""}`}gen(){const e=!1===this.options.versioned?this.client.options.http.api:`${this.client.options.http.api}/v${this.client.options.http.version}`,t=n[this.method](`${e}${this.path}`,{agent:l});if(!1!==this.options.auth&&t.set("Authorization",this.rest.getAuth()),this.options.reason&&t.set("X-Audit-Log-Reason",encodeURIComponent(this.options.reason)),a||t.set("User-Agent",o),this.options.headers&&t.set(this.options.headers),this.options.files){for(const e of this.options.files)e&&e.file&&t.attach(e.name,e.file,e.name);void 0!==this.options.data&&t.attach("payload_json",JSON.stringify(this.options.data))}else void 0!==this.options.data&&t.send(this.options.data);return t}}},function(e,t,s){const i=s(79),{Events:{RATE_LIMIT:n}}=s(0);e.exports=class{constructor(e,t){this.manager=e,this.client=this.manager.client,this.handle=t.bind(this),this.limit=1/0,this.resetTime=null,this.remaining=1,this.queue=[]}get limited(){return this.manager.globallyRateLimited||this.remaining<=0}set globallyLimited(e){this.manager.globallyRateLimited=e}push(e){this.queue.push(e),this.handle()}execute(e){return new Promise((t,s)=>{const r=i=>{i||this.limited?(i||(i=this.resetTime-Date.now()+this.manager.timeDifference+this.client.options.restTimeOffset),s({timeout:i}),this.client.listenerCount(n)&&this.client.emit(n,{timeout:i,limit:this.limit,timeDifference:this.manager.timeDifference,method:e.request.method,path:e.request.path,route:e.request.route})):t()};e.request.gen().end((t,s)=>{if(s&&s.headers&&(s.headers["x-ratelimit-global"]&&(this.globallyLimited=!0),this.limit=Number(s.headers["x-ratelimit-limit"]),this.resetTime=1e3*Number(s.headers["x-ratelimit-reset"]),this.remaining=Number(s.headers["x-ratelimit-remaining"]),this.manager.timeDifference=Date.now()-new Date(s.headers.date).getTime()),t)429===t.status?(this.queue.unshift(e),r(Number(s.headers["retry-after"])+this.client.options.restTimeOffset)):t.status>=500&&t.status<600?(this.queue.unshift(e),r(1e3+this.client.options.restTimeOffset)):(e.reject(t.status>=400&&t.status<500?new i(s.request.path,s.body):t),r());else{const t=s&&s.body?s.body:{};e.resolve(t),r()}})})}reset(){this.globallyLimited=!1,this.remaining=1}}},function(e,t){e.exports=function(){this.limited||0===this.queue.length||(this.execute(this.queue.shift()).then(this.handle.bind(this)).catch(({timeout:e})=>{this.client.setTimeout(()=>{this.reset(),this.handle()},e)}),this.remaining--,this.handle())}},function(e,t){e.exports=function(){this.busy||this.limited||0===this.queue.length||(this.busy=!0,this.execute(this.queue.shift()).then(()=>{this.busy=!1,this.handle()}).catch(({timeout:e})=>{this.client.setTimeout(()=>{this.reset(),this.busy=!1,this.handle()},e)}))}},function(e,t,s){e.exports={sequential:s(178),burst:s(177),RequestHandler:s(176)}},function(e,t,s){const i=s(179),n=s(175),r=s(173),{Error:a}=s(5),{Endpoints:o}=s(0);e.exports=class{constructor(e,t="Bot"){this.client=e,this.handlers={},this.rateLimitedEndpoints={},this.globallyRateLimited=!1,this.tokenPrefix=t,this.versioned=!0,this.timeDifferences=[]}get api(){return r(this)}get timeDifference(){return Math.round(this.timeDifferences.reduce((e,t)=>e+t,0)/this.timeDifferences.length)}set timeDifference(e){this.timeDifferences.unshift(e),this.timeDifferences.length>5&&(this.timeDifferences.length=5)}getAuth(){const e=this.client.token||this.client.accessToken,t=!!this.client.application||this.client.user&&this.client.user.bot;if(e&&t)return`${this.tokenPrefix} ${e}`;if(e)return e;throw new a("TOKEN_MISSING")}get cdn(){return o.CDN(this.client.options.http.cdn)}push(e,t){return new Promise((s,i)=>{e.push({request:t,resolve:s,reject:i})})}getRequestHandler(){const e=this.client.options.apiRequestMethod;if("function"==typeof e)return e;const t=i[e];if(!t)throw new a("RATELIMIT_INVALID_METHOD");return t}request(e,t,s={}){const r=new n(this,e,t,s);return this.handlers[r.route]||(this.handlers[r.route]=new i.RequestHandler(this,this.getRequestHandler())),this.push(this.handlers[r.route],r)}set endpoint(e){this.client.options.http.api=e}}},function(e,t,s){const{register:i}=s(80),n={CLIENT_INVALID_OPTION:(e,t)=>`The ${e} option must be ${t}`,TOKEN_INVALID:"An invalid token was provided.",TOKEN_MISSING:"Request to use token, but token was unavailable to the client.",FEATURE_USER_ONLY:"Only user accounts are able to make use of this feature.",WS_CONNECTION_TIMEOUT:"The connection to the gateway timed out.",WS_CONNECTION_EXISTS:"There is already an existing WebSocket connection.",WS_NOT_OPEN:(e="data")=>`Websocket not open to send ${e}`,PERMISSION_INVALID:"Invalid permission string or number.",RATELIMIT_INVALID_METHOD:"Unknown rate limiting method.",SHARDING_INVALID:"Invalid shard settings were provided.",SHARDING_REQUIRED:"This session would have handled too many guilds - Sharding is required.",SHARDING_CHILD_CONNECTION:"Failed to send message to shard's process.",SHARDING_PARENT_CONNECTION:"Failed to send message to master process.",SHARDING_NO_SHARDS:"No shards have been spawned.",SHARDING_IN_PROCESS:"Shards are still being spawned.",SHARDING_ALREADY_SPAWNED:e=>`Already spawned ${e} shards.`,SHARDING_PROCESS_EXISTS:e=>`Shard ${e} already has an active process.`,SHARDING_READY_TIMEOUT:e=>`Shard ${e}'s Client took too long to become ready.`,SHARDING_READY_DISCONNECTED:e=>`Shard ${e}'s Client disconnected before becoming ready.`,SHARDING_READY_DIED:e=>`Shard ${e}'s process exited before its Client became ready.`,COLOR_RANGE:"Color must be within the range 0 - 16777215 (0xFFFFFF).",COLOR_CONVERT:"Unable to convert color to a number.",EMBED_FIELD_COUNT:"MessageEmbeds may not exceed 25 fields.",EMBED_FIELD_NAME:"MessageEmbed field names may not be empty.",EMBED_FIELD_VALUE:"MessageEmbed field values may not be empty.",FILE_NOT_FOUND:e=>`File could not be found: ${e}`,USER_NO_DMCHANNEL:"No DM Channel exists!",VOICE_INVALID_HEARTBEAT:"Tried to set voice heartbeat but no valid interval was specified.",VOICE_USER_MISSING:"Couldn't resolve the user to create stream.",VOICE_STREAM_EXISTS:"There is already an existing stream for that user.",VOICE_JOIN_CHANNEL:(e=!1)=>`You do not have permission to join this voice channel${e?"; it is full.":"."}`,VOICE_CONNECTION_TIMEOUT:"Connection not established within 15 seconds.",VOICE_TOKEN_ABSENT:"Token not provided from voice server packet.",VOICE_SESSION_ABSENT:"Session ID not supplied.",VOICE_INVALID_ENDPOINT:"Invalid endpoint received.",VOICE_NO_BROWSER:"Voice connections are not available in browsers.",VOICE_CONNECTION_ATTEMPTS_EXCEEDED:e=>`Too many connection attempts (${e}).`,VOICE_JOIN_SOCKET_CLOSED:"Tried to send join packet, but the WebSocket is not open.",VOICE_PLAY_INTERFACE_NO_BROADCAST:"A broadcast cannot be played in this context.",VOICE_PLAY_INTERFACE_BAD_TYPE:"Unknown stream type",VOICE_PRISM_DEMUXERS_NEED_STREAM:"To play a webm/ogg stream, you need to pass a ReadableStream.",OPUS_ENGINE_MISSING:"Couldn't find an Opus engine.",UDP_SEND_FAIL:"Tried to send a UDP packet, but there is no socket available.",UDP_ADDRESS_MALFORMED:"Malformed UDP address or port.",UDP_CONNECTION_EXISTS:"There is already an existing UDP connection.",REQ_BODY_TYPE:"The response body isn't a Buffer.",REQ_RESOURCE_TYPE:"The resource must be a string, Buffer or a valid file stream.",IMAGE_FORMAT:e=>`Invalid image format: ${e}`,IMAGE_SIZE:e=>`Invalid image size: ${e}`,MESSAGE_MISSING:"Message not found",MESSAGE_BULK_DELETE_TYPE:"The messages must be an Array, Collection, or number.",MESSAGE_NONCE_TYPE:"Message nonce must fit in an unsigned 64-bit integer.",TYPING_COUNT:"Count must be at least 1",SPLIT_MAX_LEN:"Message exceeds the max length and contains no split characters.",BAN_RESOLVE_ID:(e=!1)=>`Couldn't resolve the user ID to ${e?"ban":"unban"}.`,PRUNE_DAYS_TYPE:"Days must be a number",SEARCH_CHANNEL_TYPE:"Target must be a TextChannel, DMChannel, GroupDMChannel, or Guild.",MESSAGE_SPLIT_MISSING:"Message exceeds the max length and contains no split characters.",GUILD_CHANNEL_RESOLVE:"Could not resolve channel to a guild channel.",GUILD_CHANNEL_ORPHAN:"Could not find a parent to this guild channel.",GUILD_OWNED:"Guild is owned by the client.",GUILD_RESTRICTED:(e=!1)=>`Guild is ${e?"already":"not"} restricted.`,GUILD_MEMBERS_TIMEOUT:"Members didn't arrive in time.",INVALID_TYPE:(e,t,s=!1)=>`Supplied ${e} is not a${s?"n":""} ${t}.`,WEBHOOK_MESSAGE:"The message was not sent by a webhook.",EMOJI_TYPE:"Emoji must be a string or GuildEmoji/ReactionEmoji",REACTION_RESOLVE_USER:"Couldn't resolve the user ID to remove from the reaction."};for(const[e,t]of Object.entries(n))i(e,t)},function(e,t){},function(e,t){e.exports={buildRequest:function(e,t){return{method:e,path:t,redirect:this.options.followRedirects?"follow":"manual",headers:{},setHeader(e,t){this.headers[e.toLowerCase()]=t},getHeader(e){return this.headers[e.toLowerCase()]}}},finalizeRequest:function(){return this._finalizeRequest(),this.data&&(this.request.body=this.data),window.fetch(this.request.path,this.request).then(e=>e.text().then(t=>{const s={};for(const[t,i]of e.headers.entries())s[t.toLowerCase()]=i;return{response:e,raw:t,headers:s}}))},shouldSendRaw:()=>!1,METHODS:["GET","HEAD","POST","PUT","DELETE","CONNECT","OPTIONS","PATCH"],STATUS_CODES:{},Extension:Object,FormData:window.FormData}},function(e,t,s){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,s,o){return t=t||"&",s=s||"=",null===e&&(e=void 0),"object"==typeof e?r(a(e),function(a){var o=encodeURIComponent(i(a))+s;return n(e[a])?r(e[a],function(e){return o+encodeURIComponent(i(e))}).join(t):o+encodeURIComponent(i(e[a]))}).join(t):o?encodeURIComponent(i(o))+s+encodeURIComponent(i(e)):""};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function r(e,t){if(e.map)return e.map(t);for(var s=[],i=0;i<e.length;i++)s.push(t(e[i],i));return s}var a=Object.keys||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.push(s);return t}},function(e,t,s){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,s,r){t=t||"&",s=s||"=";var a={};if("string"!=typeof e||0===e.length)return a;var o=/\+/g;e=e.split(t);var l=1e3;r&&"number"==typeof r.maxKeys&&(l=r.maxKeys);var h=e.length;l>0&&h>l&&(h=l);for(var c=0;c<h;++c){var d,u,p,f,m=e[c].replace(o,"%20"),_=m.indexOf(s);_>=0?(d=m.substr(0,_),u=m.substr(_+1)):(d=m,u=""),p=decodeURIComponent(d),f=decodeURIComponent(u),i(a,p)?n(a[p])?a[p].push(f):a[p]=[a[p],f]:a[p]=f}return a};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,s){const i="undefined"!=typeof window,n=s(42),r=s(i?183:182);class a extends r.Extension{constructor(e,t,s={}){super(),this.options=Object.assign({version:1,qs:n,followRedirects:!0},s),this.request=r.buildRequest.call(this,e,t,s),s.headers&&this.set(s.headers),s.query&&this.query(s.query),s.data&&this.send(s.data)}query(e,t){if(this.request.query||(this.request.query={}),null!==e&&"object"==typeof e)for(const[t,s]of Object.entries(e))this.query(t,s);else this.request.query[e]=t;return this}set(e,t){if(null!==e&&"object"==typeof e)for(const t of Object.keys(e))this.set(t,e[t]);else this.request.setHeader(e,t);return this}attach(...e){const t=this.data instanceof r.FormData?this.data:this.data=new r.FormData;if("object"==typeof e[0])for(const[t,s]of Object.entries(e[0]))this.attach(t,s);else t.append(...e);return this}send(e){if(e instanceof r.FormData||r.shouldSendRaw(e))this.data=e;else if(null!==e&&"object"==typeof e){const t=this.request.getHeader("content-type");let s;t?t.includes("json")?s=JSON.stringify:t.includes("urlencoded")&&(s=this.options.qs.stringify):(this.set("Content-Type","application/json"),s=JSON.stringify),this.data=s(e)}else this.data=e;return this}then(e,t){return this._response?this._response.then(e,t):this._response=r.finalizeRequest.call(this).then(({response:e,raw:t,redirect:s,headers:i})=>{if(s){let t=this.request.method;[301,302].includes(e.statusCode)?("HEAD"!==t&&(t="GET"),this.data=null):303===e.statusCode&&(t="GET");const i=this.request.getHeaders();return delete i.host,new a(t,s,{data:this.data,headers:i,version:this.options.version})}const n=e.statusCode||e.status,o=this,l={request:this.request,get body(){delete l.body;const e=this.headers["content-type"];if(e&&e.includes("application/json"))try{l.body=JSON.parse(l.text)}catch(e){l.body=l.text}else e&&e.includes("application/x-www-form-urlencoded")?l.body=o.options.qs.parse(l.text):l.body=t;return l.body},text:t.toString(),ok:n>=200&&n<400,headers:i||e.headers,status:n,statusText:e.statusText||r.STATUS_CODES[e.statusCode]};if(l.ok)return l;{const e=new Error(`${l.status} ${l.statusText}`.trim());return Object.assign(e,l),Promise.reject(e)}}).then(e,t)}catch(e){return this.then(null,e)}end(e){return this.then(t=>e?e(null,t):t,t=>e?e(t,t.status?t:null):Promise.reject(t))}_finalizeRequest(){if(this.request&&("HEAD"!==this.request.method&&this.set("Accept-Encoding","gzip, deflate"),this.data&&this.data.getBoundary&&this.set("Content-Type",`multipart/form-data; boundary=${this.data.getBoundary()}`),this.request.query)){const[e,t]=this.request.path.split("?");this.request.path=`${e}?${this.options.qs.stringify(this.request.query)}${t?`&${t}`:""}`}}}a.METHODS=r.METHODS.concat("BREW").filter(e=>"M-SEARCH"!==e);for(const e of a.METHODS)a[e.toLowerCase()]=function(t,s){return new(this.prototype instanceof a?this:a)(e,t,s)};e.exports=a},function(e,t,s){const i=s(6);e.exports={BaseClient:s(41),Client:s(172),Shard:s(84),ShardClientUtil:s(83),ShardingManager:s(82),WebhookClient:s(64),Collection:s(3),Constants:s(0),DataResolver:s(8),DataStore:s(7),DiscordAPIError:s(79),Permissions:s(11),Snowflake:s(10),SnowflakeUtil:s(10),Structures:s(29),Util:i,util:i,version:s(81).version,ChannelStore:s(46),ClientPresenceStore:s(44),GuildChannelStore:s(69),GuildEmojiStore:s(37),GuildEmojiRoleStore:s(77),GuildMemberStore:s(72),GuildMemberRoleStore:s(71),GuildStore:s(45),ReactionUserStore:s(61),MessageStore:s(20),PresenceStore:s(35),RoleStore:s(70),UserStore:s(47),discordSort:i.discordSort,escapeMarkdown:i.escapeMarkdown,fetchRecommendedShards:i.fetchRecommendedShards,resolveColor:i.resolveColor,resolveString:i.resolveString,splitMessage:i.splitMessage,Base:s(9),Activity:s(13).Activity,CategoryChannel:s(57),Channel:s(16),ClientApplication:s(34),get ClientUser(){return s(78)},ClientUserChannelOverride:s(55),ClientUserGuildSettings:s(32),ClientUserSettings:s(56),Collector:s(39),DMChannel:s(76),Emoji:s(40),GroupDMChannel:s(60),Guild:s(21),GuildAuditLogs:s(74),GuildChannel:s(18),GuildEmoji:s(23),GuildMember:s(14),Invite:s(27),Message:s(24),MessageAttachment:s(25),MessageCollector:s(75),MessageEmbed:s(26),MessageMentions:s(63),MessageReaction:s(33),PermissionOverwrites:s(67),Presence:s(13).Presence,ReactionCollector:s(62),ReactionEmoji:s(36),RichPresenceAssets:s(13).RichPresenceAssets,Role:s(19),TextChannel:s(59),User:s(17),UserConnection:s(65),VoiceChannel:s(58),VoiceRegion:s(38),Webhook:s(15),WebSocket:s(54)}}])});